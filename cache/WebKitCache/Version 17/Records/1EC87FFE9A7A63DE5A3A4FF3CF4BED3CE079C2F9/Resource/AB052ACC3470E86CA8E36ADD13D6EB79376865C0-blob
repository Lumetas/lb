"use strict";(window.webpackChunk=window.webpackChunk||[]).push([[64657],{179788:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var r=n(629133),i=n.n(r),a={},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a=i().reduce(e,(function(e,t){return e[t.id]=t,e}),t?{}:a)};const s={init:function(e){return o(e,!0)},extend:o,get:function(e){if(a[e])return a[e]},set:function(e,t){i().each(i().keys(t),(function(n){a[e][n]=t[n]}))}};var d="../build/transpiled/interface/amojo/chat_attributes";window.define(d,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([d])},428697:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var r=n(629133),i=n.n(r),a=n(161320),o=n.n(a),s={},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s=i().reduce(e,(function(e,t){return t.tags=i().filter(t.tags,(function(e){return"HUMAN_AGENT"!==e.tag||(t.human_agent=e,!(o()().format("X")>e.expire_at))})),e[t.chat_id]=t,e}),t?{}:s)};const c={init:function(e){return d(e,!0)},extend:d,get:function(e){if(s[e])return s[e]}};var l="../build/transpiled/interface/amojo/facebook_attributes";window.define(l,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([l])},990966:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var r=n(629133),i=n.n(r),a=n(345839),o=n.n(a),s=n(580326),d=o().Model.extend({set:function(e,t,n){var r=e;return i().isObject(e)?n=t:(r={})[e]=t,r.last_message_date&&(r.last_message_date+=1),o().Model.prototype.set.call(this,r,n)}});const c=o().Collection.extend({model:d,url:function(){return"/ajax/v2/talks"},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=s.AmoJoMediator.get(),r=i().keys(n);return r=i().filter(r,(function(e){return i().propertyOf(n)([String(e),"entity_type"])===APP.element_types.contacts})),t.type="POST",t.data={chats_ids:r},r.length?(this._pending||(this._pending=o().Collection.prototype.fetch.apply(this,arguments),this._pending.always((function(){e._pending=null}))),this._pending):Promise.resolve()},parse:function(e){return i().reduce(e,(function(e,t,n){return e.concat(i().map(t,(function(e){return{id:e.talk_id,chat_id:n,entity_id:e.entity_id,entity_type:e.entity_type,auto_close:e.auto_close,auto_close_at:e.time_execute,read_status:e.read_status,status:e.status,last_message_date:e.last_message_date,last_message:e.last_message,last_message_author:e.last_message_author,origin:e.origin,sourceId:e.source_id,origin_icon:e.origin_icon,category:e.category,emotion:e.emotion}})))}),[])}});var l="../build/transpiled/interface/amojo/opened_dialogs";window.define(l,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([l])},769381:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var r=n(629133),i=n.n(r),a=n(267651),o=n.n(a),s=n(926168),d=n(214558),c=n(661533);const l={getFeedFilterFromStorage:function(e){var t=(0,d.current)("settings")||{};return t.feed_filter?t.feed_filter[(0,s.convertElementType)(e,"string")]:null},getFeedSystemFromStorage:function(){var e=(0,d.current)("settings")||{};return{need_msec:e.need_msec||!1,need_open_talks_preview:!i().has(e,"need_open_talks_preview")||!!e.need_open_talks_preview}},setFeedFilterToStorage:function(e,t,n){var r=(0,s.convertElementType)(e,"string"),a=(0,d.current)("settings")||{},l={};return i().isEmpty(t)?t=i().propertyOf(a)(["feed_filter",r])||{}:(l[r]=t,a.feed_filter=i().extend(a.feed_filter||{},l)),i().isEmpty(n)?n=i().pick(a,["need_msec","need_open_talks_preview"]):(a.need_msec=i().has(n,"need_msec")?n.need_msec:a.need_msec,a.need_open_talks_preview=i().has(n,"need_open_talks_preview")?n.need_open_talks_preview:a.need_open_talks_preview),(0,d.current)("settings",a),o().publish("notes:filter:change",{element_type:e,values:t,system_props:n}),c.ajax({url:"/ajax/card/feed_filter/set/",type:"POST",data:{entity_type:e,value:JSON.stringify(t),system_props:JSON.stringify(n)}})}};var u="../build/transpiled/interface/card/mixins/notes_linked_element_types";window.define(u,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([u])},640773:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var r=n(661533),i=n.n(r),a=n(629133),o=n.n(a),s=n(345839),d=n.n(s),c=n(162262),l=n.n(c),u=n(283346),_=n(977717),f=n(643095),h=n(116028),p=n(156040),m=n(335745),g=n(323344),y=n(926168),P=n(474564),v=n(580326),b=n(428697),A=n(179788),E=n(247227),k=n(439182),C=n(365503),T=n(278385),w=n(178839),O=n(418860);function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function F(e,t,n,r,i,a,o){try{var s=e[a](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(r,i)}function M(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){F(a,r,i,o,s,"next",e)}function s(e){F(a,r,i,o,s,"throw",e)}o(void 0)}))}}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){N(e,t,n[t])}))}return e}function I(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function L(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function D(e){return e.msec_created_at&&(e.created_at=e.msec_created_at/1e3),e.msec_edited_at&&(e.edited_at=e.msec_edited_at/1e3),e}var j=d().Collection.extend({model:k.default,_page_length:100,_current_page:0,_has_url_copying_feature:!0,_has_multiple_categories:new Set,url:function(e){var t=(0,y.convertElementType)(this.element_type,"string");switch(!0){case"stats"===e&&!o().isUndefined(this.element_id):return"/ajax/v3/".concat(t,"/").concat(this.element_id,"/stats");case"prev"===e&&this.hasPrevPage():return this.links.prev;case"next"===e&&this.hasNextPage():return this.links.next;case!o().isUndefined(this.element_id):return"/ajax/v3/".concat(t,"/").concat(this.element_id,"/events_timeline");default:return""}},hasPrevPage:function(){return Boolean(this.links)&&Boolean(this.links.prev)},hasNextPage:function(){return Boolean(this.links)&&Boolean(this.links.next)},initialize:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.tasks_results=new C.default,this.element_id=n.element_id,this.element_type=n.element_type,this.element_info=n.element_info,this.is_new=!this.element_id,this.onTimelineRequestEnd=n.onTimelineRequestEnd||o().noop,this.getFilter=n.getFilter||o().noop,this._fully_loaded=!1,this._elements=[{id:n.element_id,type:n.element_type}],this._external_pending=[],this.buffer=[];var r=parseInt(window.location.pathname.split("/").pop());this.is_new||r===this.element_id||(0,p.onPageFullyLoaded)((function(){var e;console.warn(t),(0,f.sentryLogBrokenFeed)(I(x({},n),{currentEntityId:r,chats:o().keys((null===(e=t.embedded)||void 0===e?void 0:e.chats)||{})}))}))},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.direction||"prev",r="_pending_".concat(n);if(!this[r]){var i=new AbortController;this[r]=this._fetch(o().extend(t,{signal:i.signal})),this[r].abort=o().bind(i.abort,i),this[r].finally((function(){e[r].abort=null,delete e[r]}))}return this[r]},_fetch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return M((function(){var t,n,r,a,s,d,c,l,u,_,f,p,y,k,C,T,w;return L(this,(function(S){switch(S.label){case 0:if(t=this,n=!1,e.reset&&delete this.links,"next"===e.direction&&!this.hasNextPage()||"prev"===e.direction&&!this.hasPrevPage())return[2,[]];e.signal&&e.signal.addEventListener("abort",(function(){n=!0})),this._initBotsCollection(),this.pending=!0,h.default.fix("(feed) отправили запрос"),(0,m.logPerformanceMetric)({type:(0,m.getRealCardPageType)(),name:"feedTimelineStart",isSync:!0}),S.label=1;case 1:return S.trys.push([1,9,,10]),r=this.url(e.direction),a=APP.FREM.get(r),APP.first_load&&a?(APP.FREM.remove(r),[4,a]):[3,4];case 2:return[4,(a=S.sent()).json()];case 3:return s=S.sent(),d={getResponseHeader:function(e){return a.headers.get(e)}},[3,6];case 4:return c=(0,g.QStoJSON)(i().param(this.getFilter()),!0),l=c.filter,u=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(c,["filter"]),_={url:r,data:x({filter:x({},l||{},e.filter||{})},u||{})},f=i().ajax(_),d={getResponseHeader:f.getResponseHeader},[4,f];case 5:s=S.sent(),S.label=6;case 6:return!0===e.reset&&this.reset([]),n?[2,[]]:(h.default.fix("(feed) получили ответ timeline"),(0,m.logPerformanceMetric)({type:(0,m.getRealCardPageType)(),name:"feedTimelineEnd",isSync:!0}),p={},y=o().propertyOf(s),o().isEmpty(y(["_embedded","chats"]))||v.AmoJoMediator.extend(y(["_embedded","chats"]),!0),A.default.extend(y(["_embedded","chat_attributes"])||[]),b.default.extend(y(["_embedded","facebook_chat_attributes"])||[]),E.default.extend(y(["_embedded","chat_origins"])||[]),k=o().reduce(y(["_embedded","items"]),(function(e,n){var r;return o().contains([O.default.INCOMING_CHAT_MESSAGE,O.default.OUTGOING_CHAT_MESSAGE,O.default.DIRECT_ENTITY_CHAT_MESSAGE],n.type)?n.data.id&&!t.get(n.data.id)&&(n.data=o().extend(n.data,{external_author_name:n.external_author_name}),e[n.id]=D(n.data)):t.get(n.id)||(e[n.id]=((r=function(e){if(o().isObject(e)&&e.note_type){var t=e.type,n=e.object_type;Object.defineProperty(e,"type",{get:function(){return this.note_type?this.note_type:t}}),Object.defineProperty(e,"object_type",{get:function(){return this.note_type?{id:APP.element_types.notes,code:"notes"}:n}})}return e}(n)).msec_created_at&&(r._date_create=r.date_create,r.date_create=r.msec_created_at),r)),e}),{}),this._parseEmbedded(o().omit(s._embedded,"items")),this.trigger("fetched:before-add"),e.direction?(C=o().propertyOf(s._links),this.links[e.direction]=C(e.direction)):this.links=s._links||{},o().isEmpty(p)?[3,8]:[4,(0,P.fetchMessagesById)(o().keys(p)).toPromise()]);case 7:T=S.sent(),o().each(T,(function(e){var t=p[e.id];k[t]=D(e)})),S.label=8;case 8:return h.default.fix("(feed) получили ответ amojo"),(0,m.logPerformanceMetric)({type:(0,m.getRealCardPageType)(),name:"feedAmojoAnswerGot",isSync:!0}),this.pending=!1,o().isEmpty(k)&&!e.reset||(this._pushToBuffer(o().values(k).reverse()),this._fetched(e)),o().isEmpty(k)&&!e.reset&&e.direction&&this.links[e.direction]?[2,this._fetch(e)]:(this.onTimelineRequestEnd(d,{url:"".concat(window.location.origin).concat(r)}),[2,k]);case 9:return w=S.sent(),e.direction&&delete this.links[e.direction],this._onFetchError(w),[2,[]];case 10:return[2]}}))})).apply(this)},isLookingModeActive:function(){return this._find_pending},findBy:function(){var e,t,n,r=this,a=Array.prototype.slice.call(arguments)||[],s=i().Deferred(),d=s.promise(),c=(a[1]||{}).onHoldOnStarted,l=void 0===c?o().noop:c,u=(t=a,n=1,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}}(t,n)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];o().isFunction(u)||(e=parseInt(a[0]),u=function(t){return t.id===a[0]||t.id===e});var _=function(){var e=r.toJSON(),t=o().findLastIndex(e,u);return!!(t>-1)&&(s.resolve({page:r._current_page,model:r.get(e[t].id)}),!0)},f=this;return setTimeout(M((function(){return L(this,(function(e){switch(e.label){case 0:return _()?[3,2]:(f._find_pending=!0,[4,l()]);case 1:e.sent(),_()||s.reject(),e.label=2;case 2:return[2]}}))}))),d.abort=o().noop,d.always((function(){setTimeout((function(){r._find_pending=!1}))})),d},add:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o().isArray(e)||(e=[e]),n.visible&&o().each(e,(function(e){var n,r;t.get(e.id)||(n=e,(null!=(r=d().Model)&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](n):n instanceof r)?e.set("visible",!0,{silent:!0}):e.visible=!0)}),this),d().Collection.prototype.add.apply(this,arguments)},handleEntityLink:function(){this.is_new||this.fetch({reset:!0})},handleEntityUnlink:function(){this.is_new||this.fetch({reset:!0})},addExternalPromisePending:function(e){var t=this,n=o().bind((function(e){t._external_pending=o().filter(t._external_pending,(function(t){return t.promise!==e})),t._fetched()}),this,e);this._external_pending.push({promise:e,_pending:!0}),e.then(n,n)},_fetched:function(e){e=e||{},o().find(this._external_pending,(function(e){return e._pending}))||this.pending||(this.add(this.buffer,{visible:!0}),this.trigger("fetched",this.buffer,{update_scroll_delta:o().isUndefined(e.direction)||"prev"===e.direction}),this.buffer=[])},findCollection:function(){return this},getOriginCollection:function(){return this},getTalkLastMessageId:function(e){var t;return null===(t=this.last_dialogs_ids[e])||void 0===t?void 0:t.id},setLastDialogsIds:function(e){var t=e.get("dialog").id,n=e.get("created_at"),r=this.last_dialogs_ids||{},i=o().clone(r[t]&&r[t].model),a=r[t]&&n<=r[t].created_at;r[t]=a?r[t]:{id:e.id,created_at:n,model:e},this.last_dialogs_ids=r,!a&&i&&i.set("dialog",I(x({},i.get("dialog")),{is_last:!1}))},setShowSourceProperty:function(e){this._getByChatId(e).forEach((function(e){e.has("show_source")&&e.get("show_source")||e.set("show_source",!0)}))},setFullyLoaded:function(){this._fully_loaded=!0},_getByChatId:function(e){return this.filter((function(t){return t.get("chat_id")===e}))},_pushToBuffer:function(e){e&&(this.buffer=this.buffer.concat(e))},_onFetchError:function(e){console.error(e),this.pending=!1,this.links={},this._fetched()},_initBotsCollection:function(){var e=this;this.bots_collection||(this.bots_collection=new u.default),!this.business_bots_collection&&this.element_type===APP.element_types.leads&&APP.constant("account").amo_messenger.amo_id&&(this.business_bots_collection=new _.default,this.need_fetch_business_bots=!0),(0,p.onPageFullyLoaded)((function(){e.bots_collection.fetched||e.bots_collection.fetch().then((function(){e.trigger("bot:fetched")}))}))},_parseEmbedded:function(e){this.embedded=o().reduce(e,(function(e,t,n){return o().isBoolean(t)?e[n]=t:e[n]=o().extend({},e[n]||{},t||{}),e}),this.embedded||{}),this.tasks_results.add(o().values(this.embedded.tasks_results))},getStats:function(){return M((function(){var e;return L(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,i().ajax({url:this.url("stats"),type:"GET",dataType:"json"})];case 1:return e=t.sent(),[2,[{id:this.element_id,count:e.notes||0,users:o().map(e._embedded.users,(function(e){return{id:e.id,count:e.notes}})),calls:e.calls||{},letters:e.letters||0,tasks:e.tasks||{},visited_pages:e.visited_pages||{}}]];case 2:return t.sent(),[2,[]];case 3:return[2]}}))})).apply(this)},isMultipleCategories:function(e){if(this._has_multiple_categories.has(e))return!0;var t=new Set;return this.each((function(n){var r=o().propertyOf(n.get("dialog"))("category");n.get("chat_id")===e&&r&&t.add(o().propertyOf(n.get("dialog"))("category"))})),t.size>1&&(this._has_multiple_categories.add(e),!0)},setMainId:function(e){this.element_id||(this.element_id=e),o().propertyOf(this._elements)([0,"id"])&&(this._elements[0].id=e),this.trigger("collection:element-id:updated")}});l().mixin(j,T.default,w.default);const R=j;var B="../build/transpiled/interface/notes/pagerx";window.define(B,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([B])},310878:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var r=n(629133),i=n.n(r),a=n(116028),o=n(156040),s=n(49091),d=n(335745),c=n(313981),l=n(181587),u=n(323344),_=n(955026),f=n(450422),h=n(445368),p=n(214558),m=n(129578),g=n(258471),y=n(210734),P=n(26901),v=n(640773),b=n(585543),A=n(580326),E=n(271311),k=n(990966),C=n(9008),T=n(428697),w=n(179788),O=n(247227),S=n(642844),F=n(661533);function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N(e,t,n,r,i,a,o){try{var s=e[a](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(r,i)}function x(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){N(a,r,i,o,s,"next",e)}function s(e){N(a,r,i,o,s,"throw",e)}o(void 0)}))}}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){I(e,t,n[t])}))}return e}function D(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}n(168258);var j=APP.constant("account")||{};const R=l.default.extend({_classes:function(){return i().extend({},l.default.prototype._classes.apply(this,arguments),{fields:"js-card-fields",feed:"js-card-feed"})},initialize:function(){(0,o.trackStartComponentLoading)(o.components.card),(0,o.trackStartComponentLoading)(o.components.feed),this._isExternalChatTargetReady=!1,this._subscriptions=[],this._deferredTalkQueue=[],this.notes_render_def=F.Deferred(),this.card_init_def=F.Deferred(),this._subscribeChatOnAdd=i().bind(this._manageChatSubscription,this,"subscribe"),this._unsubscribeChatOnAdd=i().bind(this._manageChatSubscription,this,"unsubscribe"),this._updateOpenedDialogs=i().bind(this._updateOpenedDialogs,this),A.AmoJoMediator.on("add",this._subscribeChatOnAdd),A.AmoJoMediator.on("remove",this._unsubscribeChatOnAdd),APP.first_load&&APP.constant("load_from_server",!0),this.registerPerformance(),this.registerOldPerformanceMetrics(),l.default.prototype.initialize.apply(this,arguments)},destroy:function(){var e=this;i().each(this._subscriptions,(function(t){e._manageChatSubscription("unsubscribe",t)}),this),A.AmoJoMediator.off("add",this._subscribeChatOnAdd),A.AmoJoMediator.off("remove",this._unsubscribeChatOnAdd),A.AmoJoMediator.off("add",this._updateOpenedDialogs),i().isFunction(this._offFullChatsGetter)&&this._offFullChatsGetter(),i().isFunction(this._removeSocketReconnectListener)&&this._removeSocketReconnectListener(),this._init_chats_abort&&(this._init_chats_abort.abort(),this._init_chats_abort=null),A.AmoJoMediator.set({}),w.default.init({}),T.default.init({}),O.default.init({}),this.disableScroll(!1),l.default.prototype.destroy.apply(this,arguments)},cardBack:function(){this.disableScroll(!1),l.default.prototype.cardBack.apply(this,arguments)},registerPerformance:function(){var e,t,n=(I(e={},g.TrackedMetricGroupName.TTI,[g.TrackedMetricName.CARD_TTI,g.TrackedMetricName.FEED_TTI,g.TrackedMetricName.COMPOSE_TTI]),I(e,g.TrackedMetricGroupName.TIMELINE_ENDPOINTS_STATS,function(e){if(Array.isArray(e))return M(e)}(t=g.TrackedNavigationMetricName)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e);APP.constant("load_from_server")?(0,g.registerPerformanceMetrics)({metrics:L(I({},g.TrackedMetricGroupName.FCP,[g.TrackedMetricName.CARD_FCP,g.TrackedMetricName.FEED_FCP]),n)}):(0,g.registerPerformanceMetrics)({metrics:n})},registerOldPerformanceMetrics:function(){this.shouldCollectMetrics=APP.constant("load_from_server")&&"CARD"===(0,d.getRealCardPageType)()&&"leads"===APP.getBaseEntity(),this.shouldCollectMetrics&&(0,d.setupPerformanceMetrics)({type:"CARD",metrics:["feedFcp","cardFcp","cardTti","feedTti","composeTti","cardInitializeEnd","feedTimelineStart","feedTimelineEnd","feedAmojoAnswerGot","feedRenderStart","feedGroupStart","feedGroupEnd","timelineEndpointStats","chatsEndpointStats","linkedTypesListEndpointStats"]})},logBackendMetric:function(e,t,n){var r=n.url,a=(0,g.getBackendPerformanceMetric)({url:r,request:t});if(i().isObject(a)){var o=a;(0,g.trackPerformanceMetric)({group:e,value:o}),this.shouldCollectMetrics&&(0,d.logPerformanceMetric)({type:"CARD",name:e,value:a})}},serverLoadCheck:function(){l.default.prototype.serverLoadCheck.apply(this,arguments),this._prepareNotes(),this._initChats(),this.is_from_server?((0,o.handleEndComponentLoading)(o.components.card),this.disableScroll(!0)):(this._prepareControls(),this.animation_end_def.then(i().bind(this.disableScrollOnAnimationEnd,this,!0)))},onServerError:function(e){return x((function(){var t,n;return D(this,(function(r){switch(r.label){case 0:return this._$document.trigger("page:change:stop"),t={title:(0,h.i18n)("Nothing here,"),text:(0,h.i18n)("just an empty space, sorry"),sentryExtra:{"Feed Loaded":!(0,o.isPageComponentLoading)(o.components.feed)}},this.error_handler=this._addComponent(S.default,{jqXHR:e,space_options:t}),[4,this.animation_end_def];case 1:return r.sent(),n=this.makeFakeCard(),this.view_handler=c.default,this.card_rendered=!0,this.html=n.html(),this.fakeCardHide(),this.$el.append(this.error_handler.$el),[2]}}))})).apply(this)},load:function(){return APP.constant("load_from_server")&&((0,d.logPerformanceMetric)({type:(0,d.getRealCardPageType)(),name:"feedFcp"}),(0,g.trackPerformanceMetric)({name:g.TrackedMetricName.FEED_FCP,group:g.TrackedMetricGroupName.FCP})),a.default.fix("(card) отправили запрос"),l.default.prototype.load.apply(this,arguments)},init:function(){this.initCardHandler.apply(this,arguments)},initCardHandler:function(){var e,t=this,n=arguments,r=(e=x((function(){return D(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,l.default.prototype.initCardHandler.apply(t,n)];case 1:return e.sent(),a.default.fix("(card) проинициализировали карточку").stop(),(0,d.logPerformanceMetric)({type:(0,d.getRealCardPageType)(),name:"cardInitializeEnd",isSync:!0}),t.card_init_def.resolve(),[3,3];case 2:return e.sent(),t.card_init_def.reject(),[3,3];case 3:return[2]}}))})),function(){return e.apply(this,arguments)});this.is_from_server?setTimeout(r):(0,o.onPageFullyLoaded)(r)},fakeCardHide:function(){l.default.prototype.fakeCardHide.apply(this,arguments),this.is_from_server||(this.html||this.$el.html(this.getFakeCardHTML({old_metric_type:(0,d.getRealCardPageType)()})),this.$el.show(),this.html||((0,d.logPerformanceMetric)({type:(0,d.getRealCardPageType)(),name:"cardFcp"}),(0,g.trackPerformanceMetric)({name:g.TrackedMetricName.CARD_FCP,group:g.TrackedMetricGroupName.FCP})))},_prepareControls:function(){y.default.pause(),(0,o.onPageFullyLoaded)((function(){y.default.resume()}))},_prepareNotes:function(){var e=this,t=APP.element_types[APP.data.current_entity];if(!this.notes)if(this.notes=this._addComponent(P.default,i().extend({user:APP.constant("user")||{},element_id:this.id,element_type:t,element_info:APP.constant("card_element")||{},can_add:!0,free_user:APP.constant("user_rights").is_free_user,disabled_types:this._getDisabledTypes(),PagerCollection:v.default,getResponsibleId:function(){if(APP.data.current_card)return APP.data.current_card.getMainUser()},getMainContactId:function(){if(APP.data.current_card)return APP.data.current_card.getMainContactId()},getMainEntity:this._generateMainEntityGetter(),getLinkedEntities:this._generateLinkedEntitiesGetter(),getAccountUsers:this._generateAccountUsersGetter(),getFullChats:this._generateFullChatsGetter(),collectEmailsFromCF:i().bind(this._collectEmailsFromCF,this),onTimelineRequestEnd:i().bind(this.logBackendMetric,this,"timelineEndpointStats")},this._getPageFeedOptions())),this.notes.render({is_add_mode:!this.id,preload:!0}).then(this.notes_render_def.resolve),this.id){var n=this;this.opened_talks_collection=new k.default,this.notes.notes.opened_talks_collection=this.opened_talks_collection,this.listenToOnce(this.notes.notes,"fetched",(function(){a.default.fix("(feed) отправили элементы на рендер"),(0,d.logPerformanceMetric)({type:(0,d.getRealCardPageType)(),name:"feedRenderStart",isSync:!0})})).listenToOnce(this.notes.notes,"views:added",(function(){a.default.fix("(feed) закончили рендер",e.notes.$el),(0,g.trackPerformanceMetric)({name:g.TrackedMetricName.FEED_TTI,group:g.TrackedMetricGroupName.TTI}),APP.constant("load_from_server")&&(0,d.logPerformanceMetric)({type:(0,d.getRealCardPageType)(),name:"feedTti"})})),this._loadNotes().then((function(){return e.renderFeed()}),(function(){return e.renderFeed()})).then((function(){e._isExternalChatTargetReady=!0,e._deferredTalkQueue.forEach((function(t){e._handleNewTalkAdding(t)}))})),this._removeSocketReconnectListener=E.default.onConnectionChange((function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).status===s.SOCKET_STATE.CONNECTED&&n.notes.loadMore({fetch:{direction:"bottom"}})})),this.listenTo(this.notes.notes,"add:from_socket",this._handleNewTalkAdding).listenTo(this.notes.notes,"dialog:closed",this._handleTalkClosing),this.listenToOnce(this.notes.notes,"views:added",this._renderedNotes)}else this.renderFeed(),F.when(this.notes_render_def,this.animation_end_def).then((function(){return e._renderedNotes()}))},_loadNotes:function(){var e=parseFloat((0,u.getQueryParam)("t")),t=(0,u.getQueryParam)("tid"),n=(0,u.getQueryParam)("cid");return i().isNaN(e)||!t&&!n?this.notes.loadMore({reset:!0}):n?this.notes.scrollToTalkId(n,e):this.notes.findAndScrollToView(t,e)},_getDisabledTypes:function(){return(0,f.isAmoChatsFullEnabled)()?["email","task"]:[]},render:function(){var e=this;return this.animation_end_def.then((function(){if(!e.card_rendered&&null!==e.view_handler&&e.html){var t=document.createElement("template");if(t.innerHTML=e.html,e.notes._fully_loaded){var n=t.content.querySelector(e._selector("feed"));n&&n.parentNode.removeChild(n);var r=e.el.querySelector(e._selector("fields"));r&&r.parentNode.removeChild(r)}else e.el.innerHTML="";e.$el.show().prepend(t.content),a.default.fix("(card) отрисовали левую часть",e.$el),(0,o.handleEndComponentLoading)(o.components.card),e.fakeCardHide(),e.replaceFeed(),e.pageHolderHide(),e.init(),e._$document.trigger("page:change:stop"),e.card_rendered=!0}}))},renderFeed:function(){var e=this;this.feed_rendered||APP.data.card_page&&APP.data.card_page!==this||(F.when(this.notes_render_def,this.animation_end_def).then((function(){e.fakeCardHide(),e.pageHolderHide(),e.replaceFeed()})),this.feed_rendered=!0)},replaceFeed:function(){if(!this.notes._fully_loaded){var e=this.el.querySelector(this._selector("feed"));e&&(e.innerHTML="",e.appendChild(this.notes.el),this.notes.setFullyLoaded())}},_getPageFeedOptions:function(){return{}},_checkPageHandlerChatsExists:function(){var e=(i().propertyOf(APP.data.current_view)("getCardChats")||i().noop)(this.id,APP.getBaseEntity());e&&(A.AmoJoMediator.set(e.get("chats")),this._prepareNotes(),this._initChats())},_showOpenedTalksPin:function(){if(this.opened_talks_collection&&this.opened_talks_collection.length){var e=[];if((0,p.current)("settings").need_open_talks_preview){var t=i().filter(this.opened_talks_collection.toJSON(),(function(e){return 1!==parseInt(e.status)&&e.last_message_date>0}));i().each(i().sortBy(t,(function(e){return-e.last_message_date})),(function(n,r){var a=[];e.push(n),(r<3||(4===t.length&&3===r||t.length>4&&r===t.length-1)&&n.last_message_date)&&((a=this.notes.notes._filterLinkedAndOld([{view:{model:{id:"opened-talk-"+n.id,chat_id:n.chat_id,object_type:{code:"opened_talks"},date_create:e[0].last_message_date,data:i().filter(e,(function(e){return this.notes.notes._checkLinkedTalkVisibility(e.id)}),this)}}}])).length&&a[0].view.model.data.length&&this.notes.addNotes(a[0].view.model,{scroll_anchor_model_id:a[0].view.model.id}),e=[])}),this)}}},_getAmoJoMessageInternalUser:function(e){var t=(0,p.getByAmoJoId)()[e];return t?t.id:e},_handleNewTalkAdding:function(e){if(this._isExternalChatTargetReady){var t=e.dialog||{};if(t.opened&&this.opened_talks_collection){var n,r=i().propertyOf(e)(["author","id"]),a=A.AmoJoMediator.get()[e.chat_id]||{contacts:{},users:{}},o=C.ExistingExternalChatTarget.createFromChat(a),s={id:t.id};i().extend(s,{status:0,origin:o.getOrigin()}),t.category&&i().extend(s,{category:t.category}),r===o.getAmojoUserId()?i().extend(s,{last_message_author:{type:"contact",id:o.getContactId()},read_status:0}):i().extend(s,{last_message_author:{type:"user",id:this._getAmoJoMessageInternalUser(r)},read_status:1}),i().extend(s,{chat_id:e.chat_id,last_message_date:e.created_at,last_message:i().propertyOf(e.message)("text")}),n=!this.opened_talks_collection.get(s.id);var d=this.opened_talks_collection.add(s,{merge:!0});n?this.opened_talks_collection.trigger("refresh"):d.trigger("change",d)}}else this._deferredTalkQueue.push(e)},_handleTalkClosing:function(e){this.opened_talks_collection&&(this.opened_talks_collection.remove(e.talk),this.opened_talks_collection.trigger("refresh"))},_renderedNotes:function(){var e=this;(0,o.handleEndComponentLoading)(o.components.feed),(0,o.onPageComponentLoadEnd)((function(){e.opened_talks_collection&&(e.listenTo(e.opened_talks_collection,"sync refresh",e._showOpenedTalksPin),e.listenTo(e.notes.notes,"reset",e._showOpenedTalksPin),e._showOpenedTalksPin()),(0,o.onPageComponentLoadEnd)((function(){e.card_init_def.then((function(){e._$document.triggerHandler("widgets:load")}))}),o.components.card,!0)}),o.components.inbox,!0)},_getCurrentTalkId:function(){return null},_getReactionsNotifications:function(e){var t=this._getCurrentTalkId(),n=[];if(t){var r=i().find(e,(function(e){return e.talk_id===t}));n=r&&r.reaction||[]}else i().each(e,(function(e){e.reaction&&n.push(e.reaction)})),n.reverse();return i().flatten(n)},_updateOpenedDialogs:function(e){var t=this,n=function(){return t.opened_talks_collection?t.opened_talks_collection.fetch({merge:!0}).then((function(e){i().each(e,(function(e){if(e.length>0){var n=t._getReactionsNotifications(e);n.length>0&&t.notes.addReactionsNotifications(n)}}))})):Promise.resolve()};return new Promise((function(t,r){e?n().then(t,r):(0,o.onPageFullyLoaded)((function(){n().then(t,r)}))}))},_initChats:function(){var e=this;if(this.id){var t=i().propertyOf(this.notes._filter.get())("without")||[],n=!1;this._init_chats_abort=new AbortController,this._init_chats_abort.signal.addEventListener("abort",(function(){n=!0})),b.default.loadChatsByEntity({entityId:this.id,entityType:APP.getBaseEntity(),onRequestEnd:i().bind(this.logBackendMetric,this,"chatsEndpointStats")}).then((function(t){if(!n){var r=i().reduce(t,(function(e,t){return e[t.chat_id]=t,e}),{});A.AmoJoMediator.extend(r),A.AmoJoMediator.on("add",e._updateOpenedDialogs)}})).finally((function(){e._init_chats_abort=null})),i().contains(t,"contacts")?this.notes.notes.addExternalPromisePending(this._updateOpenedDialogs(!0)):this._updateOpenedDialogs()}},_manageChatSubscription:function(e,t){t=i().pick(t,"chat_id","token"),"subscribe"===e?(this._subscriptions.push(t),E.default.subscribe(t)):(this._subscriptions=i().without(this._subscriptions,t),E.default.unsubscribe(t))},disableScrollOnAnimationEnd:function(){this.disableScroll(!0),this.$animate_card.css("margin-right","")},disableScroll:function(e){document.getElementsByTagName("html")[0].style.overflow=e?"hidden":""},_getEmailAndPhoneCardFieldsName:function(){var e=i().clone(APP.data.current_card.linked_forms.form_views);e.push(APP.data.current_card.form);var t=["phone","email"];return i().map(e,(function(e){return(0,m.getFieldNamesByTypes)(e.$el,t)}))},_generateAccountUsersGetter:function(){var e=i().reduce((0,p.get)()||{},(function(e,t){return e[t.id]=i().extend({},t,{full_name:t.option}),e}),{});return function(){return e}},_generateMainEntityGetter:function(){var e=this,t=null,n={id:this.id,element_type:APP.element_types[APP.getBaseEntity()]},r=i().values(i().propertyOf(e.notes)(["notes","embedded",APP.getBaseEntity()]))[0]||{},a=i().bind((function(){var e;t=n,APP.data.current_card&&APP.data.current_card.model?(t.element_type=APP.data.current_card.element_type,t.name=APP.data.current_card.getName(),t.main_user_id=APP.data.current_card.getMainUser(),t.element_type===APP.element_types.leads&&(t.price=APP.data.current_card.model.get("lead[PRICE]"),t.pipeline_id=APP.data.current_card.getPipelineId()||APP.data.current_card.getSinglePipelineId(),t.status_id=APP.data.current_card.getStatusId(),t.main_contact_id=APP.data.current_card.getMainContactId()),t.element_type===APP.element_types.customers&&(t.next_date=APP.data.current_card.model.get("next_date"),t.next_price=APP.data.current_card.model.get("next_price"),t.main_contact_id=APP.data.current_card.getMainContactId()),-1!==i().indexOf([APP.element_types.contacts,APP.element_types.companies],t.element_type)&&(e=this._getEmailAndPhoneCardFieldsName(),t.email=this._collectEmailsFromCF(APP.data.current_card.model.toJSON(),e),t.phone=this._collectPhonesFromCF(APP.data.current_card.model.toJSON(),e)),t.element_type===APP.element_types.contacts&&(t.name=(0,h.contactName)(t.name),t.first_name=APP.data.current_card.model.get("contact[FN]"),t.last_name=APP.data.current_card.model.get("contact[LN]")),t.custom_fields=this.getCustomFieldsFromAttributes(APP.data.current_card.model.attributes)):i().extend(t)}),this),o=!1;return function(){return o||(i().propertyOf(APP.data.current_card)(["model"])&&(o=!0,e.listenTo(APP.data.current_card.model,"change",a),e.card_init_def.then(a)),a()),t||r||n}},_generateLinkedEntitiesGetter:function(){var e=this,t=!1,n=[],r=[],a=[],o=[],s=function(){var e=i().reduce(i().union(o,a),(function(e,t){return e[t.id]=i().extend({},e[t.id]||{},t||{}),e}),{});r=i().chain(e).values().sortBy("element_type").value()},d=function(){var n=APP.constant("account").is_contact_name_display_order_first;if(APP.data.current_card&&APP.data.current_card.linked_forms){var r=e._getEmailAndPhoneCardFieldsName();a=APP.data.current_card.linked_forms.form_models.chain().filter((function(e){var t=parseInt(e.get("ELEMENT_TYPE"));return parseInt(e.get("ID"))&&(t===APP.element_types.contacts||t===APP.element_types.companies)})).map((function(t){var a=n?i().compact([t.get("contact[FN]"),t.get("contact[LN]")]).join(" "):i().compact([t.get("contact[LN]"),t.get("contact[FN]")]).join(" ");a||(a=t.get("contact[N]")||t.get("contact[NAME]")),parseInt(t.get("ELEMENT_TYPE"))===APP.element_types.contacts&&(a=(0,h.contactName)(a));var o={id:parseInt(t.get("ID")),element_type:parseInt(t.get("ELEMENT_TYPE")),main_user_id:parseInt(t.get("MAIN_USER_ID")),name:a,avatar:t.get("avatar"),email:e._collectEmailsFromCF(t.toJSON(),r),phone:e._collectPhonesFromCF(t.toJSON(),r),custom_fields:e.getCustomFieldsFromAttributes(t.attributes)};return parseInt(t.get("ELEMENT_TYPE"))===APP.element_types.contacts&&i().extend(o,{first_name:t.get("contact[FN]"),last_name:t.get("contact[LN]")}),o})).value(),t&&s()}};return function(){var a=i().union(i().values(i().propertyOf(e.notes)(["notes","embedded","contacts"])),i().values(i().propertyOf(e.notes)(["notes","embedded","companies"])));return t||(e.card_init_def.then((function(){e.listenTo(APP.data.current_card.linked_forms,"inited",d),e.listenTo(APP.data.current_card.linked_forms.form_models,"add remove change",d),d()})),d(),t=!0),o!==a&&(o=a,s()),n.concat(r)}},_generateFullChatsGetter:function(){var e=!0,t={},n=function(){e=!0};return i().isFunction(this._offFullChatsGetter)&&this._offFullChatsGetter(),A.AmoJoMediator.on("add",n),A.AmoJoMediator.on("update",n),A.AmoJoMediator.on("remove",n),this._offFullChatsGetter=function(){A.AmoJoMediator.off("add",n),A.AmoJoMediator.off("update",n),A.AmoJoMediator.off("remove",n)},function(){return e&&(t=i().reduce(A.AmoJoMediator.get(),(function(e,t,n){return A.AmoJoMediator.isFullChat(n)&&(e[n]=t),e}),{}),e=!1),t}},_collectEmailsFromCF:function(e,t){return this._collectPhonesOrEmailsFromCF(e,"email",t)},_collectPhonesFromCF:function(e,t){return this._collectPhonesOrEmailsFromCF(e,"phone",t)},_collectPhonesOrEmailsFromCF:function(e,t,n){var r="phone"===t?i().constant(!0):_.isValidEmailForSending;return i().chain(n).map((function(n){var r=i().map(n[t],(function(t){return e[t]}));return i().reject(r,(function(e){return i().isUndefined(e)}))})).reject((function(e){return i().isEmpty(i().compact(e))})).flatten().filter((function(e){return r(e)})).value()},getFieldsInfo:function(){return i().extend({},j.cf,i().indexBy(j.predefined_cf,"ID"))},getCustomFieldsFromAttributes:function(e){var t,n,r,a,o,s,d,c,l,u=this.getFieldsInfo(),_={};return i().each(e,(function(f,p){if((d=/^CFV\[(\d+)\](\[([\d|\w]+)\])?(\[(DESCRIPTION|VALUE){1}\])?$/.exec(p))&&(t=parseInt(d[1]))){if(!(s=u[t]))return;if(n=parseInt(s.TYPE_ID),i().isEmpty(f)&&n!==APP.cf_types.checkbox)return;switch(_.hasOwnProperty(t)||(_[t]={id:t,values:[]}),n){case APP.cf_types.multiselect:r=parseInt(d[3]),_[t].values.push({value:s.ENUMS[r].VALUE,enum:r});break;case APP.cf_types.checkbox:f=f===(0,h.i18n)("Yes")?(0,h.i18n)("Yes"):(0,h.i18n)("No"),_[t].values.push({value:f});break;case APP.cf_types.select:case APP.cf_types.radiobutton:r=parseInt(f),_[t].values.push({value:s.ENUMS[r].VALUE,enum:r});break;case APP.cf_types.multitext:o="CFV["+t+"]",o+="["+d[3]+"]",o+="[VALUE]","DESCRIPTION"===d[5]&&e[o]&&(r=parseInt(f),a=s.ENUMS[r].VALUE,_[t].code=s.CODE,_[t].values.push({value:e[o],enum:r,code:a.toLowerCase()}));break;case APP.cf_types.smart_address:a=d[3],_[t].code=s.CODE,"country"===d[3]&&(f=s.VARIANTS.country[f]),_[t].values.push({value:f,code:a});break;case APP.cf_types.file:c=f,l=APP.data.current_card.$el.find('[name="'+p+'"]').trigger("drive-field:get-filename").data("file_name"),f&&(_[t].type="file",_[t].values.push({value:{file_id:c,file_name:l,type:"file"}}));break;case APP.cf_types.chained_list:(f=APP.data.current_card.$el.find('[name="'+p+'"]').trigger("chained-list:get-element-name").data("element-name"))&&(_[t].code="CHAINED_LIST",_[t].values.push({value:f}));break;case APP.cf_types.monetary:_[t].values.push({value:(0,h.currency)(f,!1,f%1==0?0:2,i().propertyOf(s)(["SETTINGS","currency"]))});break;default:_[t].values.push({value:f})}}})),_}})}}]);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"build_2025_11_28_18_50_52"},function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3c5bbe01-758c-4315-a1d4-fe0420c35064",e._sentryDebugIdIdentifier="sentry-dbid-3c5bbe01-758c-4315-a1d4-fe0420c35064")}catch(e){}}();
//# sourceMappingURL=64657.e612c96f01a7e204b544.js.map