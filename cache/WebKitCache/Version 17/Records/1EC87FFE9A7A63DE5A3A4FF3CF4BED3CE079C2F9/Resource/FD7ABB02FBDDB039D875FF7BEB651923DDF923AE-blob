"use strict";(window.webpackChunk=window.webpackChunk||[]).push([[90580],{790580:(t,e,n)=>{n.r(e),n.d(e,{default:()=>p});var i=n(661533),s=n.n(i),a=n(629133),o=n.n(a),r=n(460159),c=n.n(r),l=n(350562),d=n(859200),u=n(744704);const p=u.default.extend({_skip_save:["amoforms","chat_send","import","digital_pipeline","mailparser","salesbot-designer"],_tags_for_deletion:null,_tags_for_addition:null,events:o().extend({},u.default.prototype.events,{"multisuggest:select-first":"setPositions"}),_classes:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=u.default.prototype._classes.apply(this,e);return o().extend({},i,{outside_loader:"js-multisuggest-outside-loader"})},initialize:function(t){this.options={cant_add:o().isUndefined(t.cant_add)?"D"===(0,d.getRights)("tags","add"):t.cant_add},u.default.prototype.initialize.call(this,o().extend({},t,{$el:t.$input_container?t.$input_container:t.$container,existing_items:t.tags||{},can_remove:!0,replace:t.replace,cant_add:this.options.cant_add,topbar_offset:t.topbar_offset||0,no_absolute_positioning:t.no_absolute_positioning,render_hidden:t.render_hidden,$relative_to:t.$relative_to,$container:t.$container,autosize:t.autosize,onInit:o().bind(this.onInit,this,t.onInit),onItemChoosed:o().bind(this.onItemChoosed,this,t.onItemChoosed)}))},destroy:function(){var t=this;new Promise((function(e){t.hasModifications()?t.save().then(e):(t.rerenderInput(t.old_tags),e())})).then((function(){o().isFunction(t.options.onDestroy)&&t.options.onDestroy.call(t)})),u.default.prototype.destroy.call(t)},onInit:function(t){var e=this.options.area,n=o().isArray(e)?o().map(e,(function(t){return"fast-tags-".concat(t)})).join(" "):"fast-tags-".concat(e),i=o().isArray(e)?o().map(e,(function(t){return"fast-tags-suggest-".concat(t)})).join(" "):"fast-tags-suggest-".concat(e);this.options.area&&(this.$el.addClass(n),this.$list.addClass(i)),this.old_tags=o().filter(this.options.existing_items,(function(t){var e=parseInt(t.id);return!o().isNaN(e)&&e>0})),o().isFunction(t)&&t.call(this)},onItemChoosed:function(t){o().isFunction(t)&&t.call(this)},setPositions:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];u.default.prototype.setPositions.apply(this,e),o().isFunction(this.options.onSetPositions)&&this.options.onSetPositions.apply(this)},loadItems:function(){var t=this.options.entity||APP.getBaseEntity();this.$list.addClass("js-loading"),(0,l.getFullTagsList)({entity:t}).then(o().bind((function(t){this.$list.removeClass("js-loading"),t=this.parseLoadedTags(t.items),this.setItems({items:t,selected:this.options.existing_items,from_load:!0}),this.setPositions()}),this))},rerenderInput:function(t){this.options.items_template&&this.$el.replaceWith(s()(c()({ref:this.options.items_template}).render(o().extend({id:this.options.id,class_name:this.options.class_name||"",items:t},this.options.onRenderItemsParams?this.options.onRenderItemsParams(t):{}))))},saveSuccess:function(t){return this.saved_tags=t,this.rerenderInput(t),o().isFunction(this.options.onSaveSuccess)&&this.options.onSaveSuccess.call(this,t),t},save:function(){var t,e=this._elem("input");return e.val()&&!this.options.cant_add&&(this.$el.trigger("multisuggest:item:choose",{title:e.val()}),e.val("")),t=this.getSelectedItems(),this._elem("outside_loader").show(),this.createNewTags(t).finally(o().bind((function(t){return this._elem("outside_loader").hide(),t}),this)).then(o().bind((function(e){return t=e,o().first(this.options.id)<=0||o().contains(this._skip_save,this.options.entity)||this.options.entity_skip_save?Promise.resolve():this.save_xhr=(0,l.setTags)({entity:this.options.entity,ids:this.options.id,tags:this.prepareTagsForRequest(o().values(s().extend(!0,{},e)),this.old_tags)})}),this)).then(o().bind((function(){this.saveSuccess(t)}),this)).catch(o().bind((function(){o().isFunction(this.options.onSaveFail)&&this.options.onSaveFail.call(this,{items:this.old_tags})}),this))},hasModifications:function(){var t=this.getSelectedItems();return!o().isEqual(o().sortBy(o().pluck(t,"id")),o().sortBy(o().pluck(this.old_tags,"id")))||!(!this._elem("input").val()||this.options.cant_add)},getTags:function(){return this.saved_tags||this.getSelectedItems()},getSelectedItems:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=u.default.prototype.getSelectedItems.apply(this,e);return o().map(i,(function(t){return o().extend(t,{id:parseInt(t.id)||0})}))},parseLoadedTags:function(t){return t},createNewTags:function(t,e){var n=o().chain(t).filter((function(t){return!t.id})).pluck("raw_title").value();return e=e||this.options.entity,new Promise((function(i,s){n.length?(0,l.createNewTags)(n,e).done((function(e){t=o()(t).filter((function(t){return t.id})).concat(e.items),i(t)})).fail(s):i(t)}))},prepareTagsForRequest:function(t,e){var n=o().chain(t).filter((function(t){return t.id})).map((function(t){return parseInt(t.id)})).value(),i=o().map(e,(function(t){return parseInt(t.id)}));this._tags_for_deletion||(this._tags_for_deletion=[]),o().each(o().difference(i,n),(function(t){var n=o().findWhere(e,{id:t});t<=0||this._tags_for_deletion.push(o().extend(n,{deleted:!0}))}),this),this._tags_for_addition||(this._tags_for_addition=[]);var s=this._tags_for_deletion;return this._tags_for_deletion=[],o().each(o().difference(n,i),(function(e){var n=o().findWhere(t,{id:e});this._tags_for_addition.push(n)}),this),t.concat(s)}});var f="../build/transpiled/interface/fast_tags";window.define(f,(function(){var t="undefined",n=typeof e===t?typeof __WEBPACK_AMD_DEFINE_RESULT__===t?typeof module===t?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:e;return n&&n.default||n})),window.require([f])},350562:(t,e,n)=>{n.r(e),n.d(e,{createNewTags:()=>p,deleteTags:()=>f,getAccountSettings:()=>_,getFullTagsList:()=>d,getTagName:()=>v,getTagsById:()=>u,getTagsList:()=>m,getTagsListUrl:()=>b,setAccountSettings:()=>y,setTagColor:()=>h,setTags:()=>g});var i=n(629133),s=n.n(i),a=n(567952),o=n.n(a),r=n(863055),c=n(661533),l={name_keys:["raw_title","name","label","title"],getTagName:function(t){var e;return t=t||{},s()(l.name_keys).each((function(n){s().isUndefined(t[n])||(e=t[n])})),e},getTagsList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(e){c.ajax({url:(0,r.getTagsListUrl)(o()(t)),type:"GET",dataType:"json"}).done((function(t){e(l.parseResponse(t))})).fail((function(){e(l.parseResponse())}))}))},getTagsListUrl:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,r.parseEntity)(t.entity),n=s().isEmpty(t.qs_params)?"":"/?".concat(c.param(t.qs_params));return("leads"===e?"/ajax/v3/leads".concat(t.pipeline_id?"/pipeline/".concat(t.pipeline_id):"","/tags"):"/ajax/v3".concat(e?"/".concat(e):"","/tags"))+n},getDeleteUrl:function(t){var e,n;return 1===t.length?e=s()(t).first().id:(n={filter:{id:s()(t).pluck("id")}},e="?".concat(c.param(n))),"/ajax/v3/tags/".concat(e)},parseResponse:function(t){return s().isEmpty(t)?{total:0,items:[]}:{total:t.total,items:s().map(t._embedded.items,(function(t){return{id:t.id,name:t.name,frequency:t.total||0,color:t.color}}))}},parseEntity:function(t){switch(t){case"amoforms":case"mailparser":return"leads";case"stats":switch(window.location.pathname){case"/stats/consolidated/":return"leads";case"/stats/consolidated/contacts/":return"contacts"}break;case"salesbot-designer":case"chat_send":return"";case"import":case"digital_pipeline":return APP.getBaseEntity();default:return t}}};function d(t){return t=s().extend(t||{},{qs_params:{limit:-1}}),l.getTagsList(t)}function u(t){return t.length?c.ajax({url:"/ajax/v3/tags/",type:"GET",contentType:"application/json",dataType:"json",data:c.param({filter:{id:t}})}):c.Deferred().reject({error:"No tag ids provided!"})}function p(t,e){return t.length?(e=(0,r.parseEntity)(e),c.ajax({url:e?"/ajax/v3/%s/tags/".replace("%s",e):"/ajax/v3/tags/",type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify(s().map(t,(function(t){return{name:t}})))}).then(l.parseResponse)):c.Deferred().reject({error:"No tag names provided!"})}function f(t){return t.length?c.ajax({url:l.getDeleteUrl(t),type:"DELETE",dataType:"json"}):c.Deferred().reject({error:"No tags provided!"})}function g(t){return s().isEmpty(t)?c.Deferred().reject({error:"No options provided!"}):c.ajax({url:"/ajax/v3/".concat((0,r.parseEntity)(t.entity)),type:"PATCH",dataType:"json",contentType:"application/json",data:JSON.stringify(s().map(t.ids,(function(e){return{id:e,tags:s().map(t.tags,(function(e){return{id:e.id||0,name:l.getTagName(e),deleted:!!e.deleted,old_pipeline_id:t.old_pipeline_id||!1}}))}})))})}function h(t){return s().isEmpty(t)?c.Deferred().reject({error:"No options provided!"}):c.ajax({url:"/ajax/v4/".concat((0,r.parseEntity)(t.entity),"/tags/").concat(t.id),type:"PATCH",dataType:"json",contentType:"application/json",data:JSON.stringify({color:t.color})})}function _(){return c.ajax({url:"/ajax/v3/accounts/".concat((APP.constant("account")||{}).id),type:"GET",dataType:"json"})}function y(t){return t?c.ajax({url:"/ajax/v3/accounts/".concat((APP.constant("account")||{}).id),type:"PATCH",dataType:"json",contentType:"application/json",data:JSON.stringify(t)}):c.Deferred().reject({error:"No options provided!"})}var m=l.getTagsList,v=l.getTagName,b=l.getTagsListUrl,T="../build/transpiled/network/tags/api";window.define(T,(function(){var t="undefined",n=typeof e===t?typeof __WEBPACK_AMD_DEFINE_RESULT__===t?typeof module===t?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:e;return n&&n.default||n})),window.require([T])},669868:(t,e,n)=>{n.r(e),n.d(e,{getFullTagsList:()=>u});var i=n(629133),s=n.n(i),a=n(104737),o=n(23713);function r(t,e,n,i,s,a,o){try{var r=t[a](o),c=r.value}catch(t){return void n(t)}r.done?e(c):Promise.resolve(c).then(i,s)}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l,d,u=(l=function(){var t,e,n,i,r=arguments;return function(t,e){var n,i,s,a,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(a){return function(r){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&a[0]?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){o.label=a[1];break}if(6===a[0]&&o.label<s[1]){o.label=s[1],s=a;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(a);break}s[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,r])}}}(this,(function(l){switch(l.label){case 0:return d=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),i.forEach((function(e){c(t,e,n[e])}))}return t}({},t=r.length>0&&void 0!==r[0]?r[0]:{}),u=null!=(u={qsParams:{limnit:-1}})?u:{},Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(u)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n.push.apply(n,i)}return n}(Object(u)).forEach((function(t){Object.defineProperty(d,t,Object.getOwnPropertyDescriptor(u,t))})),t=d,[4,a.default.request({url:(0,o.getTagsListUrl)(t)})];case 1:return e=l.sent(),s().isEmpty(e)?[2,{total:0,items:[]}]:(n=e.total,i=e.Embedded.items,[2,{total:n,items:s().map(i,(function(t){var e=t.id,n=t.name,i=t.total;return{id:e,name:n,frequency:void 0===i?0:i,color:t.color}}))}])}var d,u}))},d=function(){var t=this,e=arguments;return new Promise((function(n,i){var s=l.apply(t,e);function a(t){r(s,n,i,a,o,"next",t)}function o(t){r(s,n,i,a,o,"throw",t)}a(void 0)}))},function(){return d.apply(this,arguments)})},810740:(t,e,n)=>{n.r(e),n.d(e,{getFullTagsList:()=>i.getFullTagsList});var i=n(669868)},585521:(t,e,n)=>{n.r(e),n.d(e,{getTagsListUrl:()=>r});var i=n(629133),s=n.n(i),a=n(968276),o=n(661533),r=function(t){var e=t.entity,n=t.qsParams,i=void 0===n?{}:n,r=t.pipelineId,c=(0,a.parseEntity)(e),l=s().isEmpty(i)?"":"/?".concat(o.param(i)),d="";switch(c){case"leads":d="/ajax/v3/leads".concat(r?"/pipeline/".concat(r):"","/tags");break;case"settings":d="/ajax/v3/tags";break;default:d="/ajax/v3".concat(c?"/".concat(c):"","/tags")}return d+l}},61428:(t,e,n)=>{n.r(e),n.d(e,{getTagsListUrl:()=>i.getTagsListUrl});var i=n(585521)},23713:(t,e,n)=>{n.r(e),n.d(e,{getTagsListUrl:()=>i.getTagsListUrl,parseEntity:()=>s.parseEntity});var i=n(61428),s=n(968276)},968276:(t,e,n)=>{n.r(e),n.d(e,{parseEntity:()=>i});var i=function(t){switch(t){case"amoforms":case"mailparser":return"leads";case"stats":switch(window.location.pathname){case"/stats/consolidated/":return"leads";case"/stats/consolidated/contacts/":return"contacts"}return"";case"salesbot-designer":case"chat_send":return"";case"import":case"digital_pipeline":return APP.getBaseEntity();default:return t}}},863055:(t,e,n)=>{n.r(e),n.d(e,{getFullTagsList:()=>i.getFullTagsList,getTagsListUrl:()=>s.getTagsListUrl,parseEntity:()=>s.parseEntity});var i=n(810740),s=n(23713)}}]);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"build_2025_11_28_18_50_52"},function(){try{var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=(new Error).stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="8bfbf81b-6d3d-4b8e-a459-61f9cd38ebbe",t._sentryDebugIdIdentifier="sentry-dbid-8bfbf81b-6d3d-4b8e-a459-61f9cd38ebbe")}catch(t){}}();
//# sourceMappingURL=90580.dd2bf51f7b7ab08d46c5.js.map