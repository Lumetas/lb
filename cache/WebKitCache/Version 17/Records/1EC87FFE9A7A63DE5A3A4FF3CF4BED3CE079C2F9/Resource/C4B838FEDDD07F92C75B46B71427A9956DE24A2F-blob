{
"version": 3,
"sections": [
{"offset":{"line":0,"column":0},"map":{
"version": 3,
"file": "/w/load.php?lang=ru&modules=ext.visualEditor.core.utils.parsing%7Cext.visualEditor.desktopArticleTarget.init%7Cext.visualEditor.progressBarWidget%2CsupportCheck%2CtargetLoader%2CtempWikitextEditorWidget%2Ctrack%2Cve&skin=vector&version=u9zxi",
"sources": ["/w/extensions/VisualEditor/lib/ve/src/ve.utils.parsing.js"],
"sourcesContent": ["/*!\n * VisualEditor parsing utilities, used when converting HTMLDocuments and strings.\n *\n * @copyright See AUTHORS.txt\n */\n\n/**\n * Check whether a given DOM element has a block element type.\n *\n * @param {HTMLElement|string} element Element or element name\n * @return {boolean} Element is a block element\n */\nve.isBlockElement = function ( element ) {\n\tconst elementName = typeof element === 'string' ? element : element.nodeName;\n\treturn ve.elementTypes.block.includes( elementName.toLowerCase() );\n};\n\n/**\n * Check whether a given DOM element is a void element (can't have children).\n *\n * @param {HTMLElement|string} element Element or element name\n * @return {boolean} Element is a void element\n */\nve.isVoidElement = function ( element ) {\n\tconst elementName = typeof element === 'string' ? element : element.nodeName;\n\treturn ve.elementTypes.void.includes( elementName.toLowerCase() );\n};\n\nve.elementTypes = {\n\tblock: [\n\t\t'div', 'p',\n\t\t// Tables\n\t\t'table', 'tbody', 'thead', 'tfoot', 'caption', 'th', 'tr', 'td',\n\t\t// Lists\n\t\t'ul', 'ol', 'li', 'dl', 'dt', 'dd',\n\t\t// HTML5 heading content\n\t\t'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hgroup',\n\t\t// HTML5 sectioning content\n\t\t'article', 'aside', 'body', 'nav', 'section', 'footer', 'header', 'figure',\n\t\t'figcaption', 'fieldset', 'details', 'blockquote',\n\t\t// Other\n\t\t'hr', 'button', 'canvas', 'center', 'col', 'colgroup', 'embed',\n\t\t'map', 'object', 'pre', 'progress', 'video'\n\t],\n\tvoid: [\n\t\t// https://html.spec.whatwg.org/#void-elements\n\t\t'area', 'base', 'br', 'col', 'embed', 'hr', 'img', 'input',\n\t\t'link', 'meta', 'param', 'source', 'track', 'wbr'\n\t]\n};\n\n/**\n * Match a specific HTML tag that appears once, e.g. 'html' or 'body'\n *\n * @param {string} html Document HTML\n * @param {string} tag Tag name\n * @return {string[]|null} Regex match, null if not found\n */\nve.matchTag = function ( html, tag ) {\n\treturn html.match(\n\n\t\tnew RegExp( '<' + tag + '(>|\\\\s[^>]*>)' )\n\t);\n};\n\n/**\n * Add a tag to `<head>` using HTML string splicing\n *\n * @param {string} docHtml Document HTML\n * @param {string} tagHtml Tag HTML to be added to `<head>`\n * @return {string} Document HTML\n */\nve.addHeadTag = function ( docHtml, tagHtml ) {\n\t/**\n\t * Splice text after a regex match\n\t *\n\t * @param {string[]} match Regex match\n\t * @param {string} text Text to insert\n\t * @return {string}\n\t */\n\tfunction insertAfter( match, text ) {\n\t\tconst offset = match.index + match[ 0 ].length;\n\t\treturn docHtml.slice( 0, offset ) +\n\t\t\ttext +\n\t\t\tdocHtml.slice( offset );\n\t}\n\n\tconst headMatch = ve.matchTag( docHtml, 'head' );\n\tif ( headMatch ) {\n\t\treturn insertAfter( headMatch, tagHtml );\n\t} else {\n\t\tconst htmlMatch = ve.matchTag( docHtml, 'html' );\n\t\tif ( htmlMatch ) {\n\t\t\t// <html> but no <head>\n\t\t\treturn insertAfter( htmlMatch, '<head>' + tagHtml + '</head>' );\n\t\t} else {\n\t\t\t// No <html> or </head>\n\t\t\treturn '<head>' + tagHtml + '</head>' + docHtml;\n\t\t}\n\t}\n};\n\n/**\n * Create an HTMLDocument from an HTML string.\n *\n * The html parameter is supposed to be a full HTML document with a doctype and an `<html>` tag.\n * If you pass a document fragment, it will be wrapped in `<body>…</body>`.\n *\n * To create an empty document, pass the empty string.\n *\n * If your input is both valid HTML and valid XML, and you need to work around style\n * normalization bugs in Internet Explorer, use #parseXhtml and #serializeXhtml.\n *\n * @param {string} html\n * @return {HTMLDocument} Document constructed from the HTML string\n */\nve.createDocumentFromHtml = function ( html ) {\n\tif ( html !== '' ) {\n\t\tif ( !ve.matchTag( html, 'body' ) ) {\n\t\t\t// When the given HTML fragment starts with a <meta> or <style> element, it is placed in the\n\t\t\t// automatically generated <head> rather than <body>, and breaks our assumptions. (T273234)\n\t\t\thtml = '<body>' + html + '</body>';\n\t\t}\n\t\t// Add iOS hack (T116525)\n\t\thtml = ve.addHeadTag( html, '<meta name=\"format-detection\" content=\"telephone=no\" data-ve-tmp/>' );\n\t}\n\n\tconst newDocument = new DOMParser().parseFromString( html, 'text/html' );\n\n\t// Remove iOS hack\n\tconst tmpMeta = newDocument.querySelector( 'meta[data-ve-tmp]' );\n\tif ( tmpMeta ) {\n\t\ttmpMeta.parentNode.removeChild( tmpMeta );\n\t}\n\n\treturn newDocument;\n};\n\n/**\n * Take a target document with a possibly relative base URL, and modify it to be absolute.\n * The base URL of the target document is resolved using the base URL of the source document.\n *\n * Note that the fallbackBase parameter will be used if there is no <base> tag, even if\n * the document does have a valid base URL: this is to work around Firefox's behavior of having\n * documents created by DOMParser inherit the base URL of the main document.\n *\n * @param {HTMLDocument} targetDoc Document whose base URL should be resolved\n * @param {HTMLDocument} sourceDoc Document whose base URL should be used for resolution\n * @param {string} [fallbackBase] Base URL to use if resolving the base URL fails or there is no <base> tag\n */\nve.fixBase = function ( targetDoc, sourceDoc, fallbackBase ) {\n\t// Skip security warnings, as these are for user input being passed to link href's\n\t/* eslint-disable local/no-unsanitized-href */\n\tlet baseNode = targetDoc.getElementsByTagName( 'base' )[ 0 ];\n\tif ( baseNode ) {\n\t\t// Support: Safari\n\t\t// In Safari a base node with an invalid href (e.g. protocol-relative)\n\t\t// in a document which has been dynamically created results in\n\t\t// 'about:blank' rather than '' or null. The base's href will also be '',\n\t\t// but that works out just setting the base to fallbackBase, so it's okay.\n\t\tif ( !targetDoc.baseURI || targetDoc.baseURI === 'about:blank' ) {\n\t\t\t// <base> tag present but not valid, try resolving its URL\n\t\t\tbaseNode.setAttribute( 'href', ve.resolveUrl( baseNode.getAttribute( 'href' ), sourceDoc ) );\n\t\t\tif ( !targetDoc.baseURI && fallbackBase ) {\n\t\t\t\t// That didn't work, use the fallback\n\t\t\t\tbaseNode.setAttribute( 'href', fallbackBase );\n\t\t\t}\n\t\t}\n\t\t// Support: Chrome\n\t\t// Chrome just entirely ignores <base> tags with a protocol-relative href attribute.\n\t\t// Code below is *not a no-op*; reading the href property and setting it back\n\t\t// will expand the href *attribute* to use an absolute URL if it was relative.\n\t\t// eslint-disable-next-line no-self-assign\n\t\tbaseNode.href = baseNode.href;\n\t} else if ( fallbackBase ) {\n\t\t// Support: Firefox\n\t\t// No <base> tag, add one\n\t\tbaseNode = targetDoc.createElement( 'base' );\n\t\tbaseNode.setAttribute( 'href', fallbackBase );\n\t\ttargetDoc.head.appendChild( baseNode );\n\t}\n\t/* eslint-enable local/no-unsanitized-href */\n};\n\n/**\n * Get the actual inner HTML of a DOM node.\n *\n * In most browsers, .innerHTML is broken and eats newlines in `<pre>` elements, see\n * https://bugzilla.mozilla.org/show_bug.cgi?id=838954 . This function detects this behavior\n * and works around it, to the extent possible. `<pre>\\nFoo</pre>` will become `<pre>Foo</pre>`\n * if the browser is broken, but newlines are preserved in all other cases.\n *\n * @param {HTMLElement} element HTML element to get inner HTML of\n * @return {string} Inner HTML\n */\nve.properInnerHtml = function ( element ) {\n\treturn ve.fixupPreBug( element ).innerHTML;\n};\n\n/**\n * Get the actual outer HTML of a DOM node.\n *\n * @see ve.properInnerHtml\n * @param {HTMLElement} element HTML element to get outer HTML of\n * @return {string} Outer HTML\n */\nve.properOuterHtml = function ( element ) {\n\treturn ve.fixupPreBug( element ).outerHTML;\n};\n\n/**\n * Helper function for #properInnerHtml, #properOuterHtml and #serializeXhtml.\n *\n * Detect whether the browser has broken `<pre>` serialization, and if so return a clone\n * of the node with extra newlines added to make it serialize properly. If the browser is not\n * broken, just return the original node.\n *\n * @param {HTMLElement} element HTML element to fix up\n * @return {HTMLElement} Either element, or a fixed-up clone of it\n */\nve.fixupPreBug = function ( element ) {\n\t// Support: Chrome, FF\n\tif ( ve.isPreInnerHtmlBroken === undefined ) {\n\t\t// Test whether newlines in `<pre>` are serialized back correctly\n\t\tconst div = document.createElement( 'div' );\n\t\tdiv.innerHTML = '<pre>\\n\\n</pre>';\n\t\tve.isPreInnerHtmlBroken = div.innerHTML === '<pre>\\n</pre>';\n\t}\n\n\tif ( !ve.isPreInnerHtmlBroken ) {\n\t\treturn element;\n\t}\n\n\t// Workaround for T44469: if a `<pre>` starts with a newline, that means .innerHTML will\n\t// screw up and stringify it with one fewer newline. Work around this by adding a newline.\n\t// If we don't see a leading newline, we still don't know if the original HTML was\n\t// `<pre>Foo</pre>` or `<pre>\\nFoo</pre>`, but that's a syntactic difference, not a\n\t// semantic one, and handling that is the integration target's job.\n\tconst $element = $( element ).clone();\n\t$element.find( 'pre, textarea, listing' ).each( ( i, el ) => {\n\t\tlet matches;\n\t\tif ( el.firstChild && el.firstChild.nodeType === Node.TEXT_NODE ) {\n\t\t\tmatches = el.firstChild.data.match( /^(\\r\\n|\\r|\\n)/ );\n\t\t\tif ( matches && matches[ 1 ] ) {\n\t\t\t\t// Prepend a newline exactly like the one we saw\n\t\t\t\tel.firstChild.insertData( 0, matches[ 1 ] );\n\t\t\t}\n\t\t}\n\t} );\n\treturn $element.get( 0 );\n};\n\n/**\n * Helper function for #transformStyleAttributes.\n *\n * Normalize an attribute value. In compliant browsers, this should be\n * a no-op, but in IE style attributes are normalized on all elements,\n * color and bgcolor attributes are normalized on some elements (like `<tr>`),\n * and width and height attributes are normalized on some elements( like `<table>`).\n *\n * @param {string} name Attribute name\n * @param {string} value Attribute value\n * @param {string} [nodeName='div'] Element name\n * @return {string} Normalized attribute value\n */\nve.normalizeAttributeValue = function ( name, value, nodeName = 'div' ) {\n\tconst node = document.createElement( nodeName );\n\tnode.setAttribute( name, value );\n\treturn node.getAttribute( name );\n};\n\n/**\n * Resolve a URL relative to a given base.\n *\n * @param {string} url URL to resolve\n * @param {HTMLDocument} base Document whose base URL to use\n * @return {string} Resolved URL\n */\nve.resolveUrl = function ( url, base ) {\n\tconst node = base.createElement( 'a' );\n\t// eslint-disable-next-line local/no-unsanitized-href\n\tnode.setAttribute( 'href', url );\n\t// If doc.baseURI isn't set, node.href will be an empty string\n\t// This is crazy, returning the original URL is better\n\treturn node.href || url;\n};\n"],
"names": [],
"mappings": "+GAYA,EAAE,CAAC,cAAe,CAAE,QAAS,CAAE,OAAQ,CAAE,CACxC,MAAM,WAAY,CAAE,OAAO,OAAQ,GAAI,QAAS,CAAE,OAAQ,CAAE,OAAO,CAAC,QAAQ,CAC5E,OAAO,EAAE,CAAC,YAAY,CAAC,KAAK,CAAC,QAAQ,CAAE,WAAW,CAAC,WAAW,CAAC,CAAE,CAAC,CACnE,CAAC,CAQD,EAAE,CAAC,aAAc,CAAE,QAAS,CAAE,OAAQ,CAAE,CACvC,MAAM,WAAY,CAAE,OAAO,OAAQ,GAAI,QAAS,CAAE,OAAQ,CAAE,OAAO,CAAC,QAAQ,CAC5E,OAAO,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,QAAQ,CAAE,WAAW,CAAC,WAAW,CAAC,CAAE,CAAC,CAClE,CAAC,CAED,EAAE,CAAC,YAAa,CAAE,CACjB,KAAK,CAAE,CACN,KAAK,CAAE,GAAG,CAEV,OAAO,CAAE,OAAO,CAAE,OAAO,CAAE,OAAO,CAAE,SAAS,CAAE,IAAI,CAAE,IAAI,CAAE,IAAI,CAE/D,IAAI,CAAE,IAAI,CAAE,IAAI,CAAE,IAAI,CAAE,IAAI,CAAE,IAAI,CAElC,IAAI,CAAE,IAAI,CAAE,IAAI,CAAE,IAAI,CAAE,IAAI,CAAE,IAAI,CAAE,QAAQ,CAE5C,SAAS,CAAE,OAAO,CAAE,MAAM,CAAE,KAAK,CAAE,SAAS,CAAE,QAAQ,CAAE,QAAQ,CAAE,QAAQ,CAC1E,YAAY,CAAE,UAAU,CAAE,SAAS,CAAE,YAAY,CAEjD,IAAI,CAAE,QAAQ,CAAE,QAAQ,CAAE,QAAQ,CAAE,KAAK,CAAE,UAAU,CAAE,OAAO,CAC9D,KAAK,CAAE,QAAQ,CAAE,KAAK,CAAE,UAAU,CAAE,OACrC,CAAC,CACD,IAAI,CAAE,CAEL,MAAM,CAAE,MAAM,CAAE,IAAI,CAAE,KAAK,CAAE,OAAO,CAAE,IAAI,CAAE,KAAK,CAAE,OAAO,CAC1D,MAAM,CAAE,MAAM,CAAE,OAAO,CAAE,QAAQ,CAAE,OAAO,CAAE,KAC7C,CACD,CAAC,CASD,EAAE,CAAC,QAAS,CAAE,QAAS,CAAE,IAAI,CAAE,GAAI,CAAE,CACpC,OAAO,IAAI,CAAC,KAAK,CAEhB,IAAI,MAAM,CAAE,GAAI,CAAE,GAAI,CAAE,eAAgB,CACzC,CAAC,CACF,CAAC,CASD,EAAE,CAAC,UAAW,CAAE,QAAS,CAAE,OAAO,CAAE,OAAQ,CAAE,CAQ7C,SAAS,WAAW,CAAE,KAAK,CAAE,IAAK,CAAE,CACnC,MAAM,MAAO,CAAE,KAAK,CAAC,KAAM,CAAE,KAAK,CAAE,CAAE,CAAC,CAAC,MAAM;AAC9C,OAAO,OAAO,CAAC,KAAK,CAAE,CAAC,CAAE,MAAO,CAAE,CACjC,IAAK,CACL,OAAO,CAAC,KAAK,CAAE,MAAO,CAAC,CACzB,CAEA,MAAM,SAAU,CAAE,EAAE,CAAC,QAAQ,CAAE,OAAO,CAAE,MAAO,CAAC,CAChD,EAAG,CAAE,SAAU,CAAE,CAChB,OAAO,WAAW,CAAE,SAAS,CAAE,OAAQ,CAAC,CACzC,CAAE,IAAK,CACN,MAAM,SAAU,CAAE,EAAE,CAAC,QAAQ,CAAE,OAAO,CAAE,MAAO,CAAC,CAChD,EAAG,CAAE,SAAU,CAAE,CAEhB,OAAO,WAAW,CAAE,SAAS,CAAE,QAAS,CAAE,OAAQ,CAAE,SAAU,CAAC,CAChE,CAAE,IAAK,CAEN,MAAO,QAAS,CAAE,OAAQ,CAAE,SAAU,CAAE,OAAO,CAChD,CACD,CACD,CAAC,CAgBD,EAAE,CAAC,sBAAuB,CAAE,QAAS,CAAE,IAAK,CAAE,CAC7C,EAAG,CAAE,IAAK,GAAI,EAAG,CAAE,CAClB,EAAG,CAAE,CAAC,EAAE,CAAC,QAAQ,CAAE,IAAI,CAAE,MAAO,CAAE,CAAE,CAGnC,IAAK,CAAE,QAAS,CAAE,IAAK,CAAE,SAAS,CACnC,CAEA,IAAK,CAAE,EAAE,CAAC,UAAU,CAAE,IAAI,CAAE,oEAAqE,CAAC,CACnG,CAEA,MAAM,WAAY,CAAE,IAAI,SAAS,CAAC,CAAC,CAAC,eAAe,CAAE,IAAI,CAAE,WAAY,CAAC,CAGxE,MAAM,OAAQ,CAAE,WAAW,CAAC,aAAa,CAAE,mBAAoB,CAAC,CAChE,EAAG,CAAE,OAAQ,CAAE,CACd,OAAO,CAAC,UAAU,CAAC,WAAW,CAAE,OAAQ,CAAC,CAC1C,CAEA,OAAO,WAAW,CACnB,CAAC,CAcD,EAAE,CAAC,OAAQ,CAAE,QAAS,CAAE,SAAS,CAAE,SAAS,CAAE,YAAa,CAAE,CAG5D,IAAI,QAAS,CAAE,SAAS,CAAC,oBAAoB,CAAE,MAAO,CAAC,CAAE,CAAE,CAAC,CAC5D,EAAG,CAAE,QAAS,CAAE,CAMf,EAAG,CAAE,CAAC,SAAS,CAAC,OAAQ,EAAG,SAAS,CAAC,OAAQ,GAAI,aAAc,CAAE,CAEhE,QAAQ,CAAC,YAAY,CAAE,MAAM,CAAE,EAAE,CAAC,UAAU,CAAE,QAAQ,CAAC,YAAY,CAAE,MAAO,CAAC,CAAE,SAAU,CAAE,CAAC;AAC5F,EAAG,CAAE,CAAC,SAAS,CAAC,OAAQ,EAAG,YAAa,CAAE,CAEzC,QAAQ,CAAC,YAAY,CAAE,MAAM,CAAE,YAAa,CAAC,CAC9C,CACD,CAMA,QAAQ,CAAC,IAAK,CAAE,QAAQ,CAAC,IAAI,CAC9B,CAAE,KAAK,EAAG,CAAE,YAAa,CAAE,CAG1B,QAAS,CAAE,SAAS,CAAC,aAAa,CAAE,MAAO,CAAC,CAC5C,QAAQ,CAAC,YAAY,CAAE,MAAM,CAAE,YAAa,CAAC,CAC7C,SAAS,CAAC,IAAI,CAAC,WAAW,CAAE,QAAS,CAAC,CACvC,CAED,CAAC,CAaD,EAAE,CAAC,eAAgB,CAAE,QAAS,CAAE,OAAQ,CAAE,CACzC,OAAO,EAAE,CAAC,WAAW,CAAE,OAAQ,CAAC,CAAC,SAAS,CAC3C,CAAC,CASD,EAAE,CAAC,eAAgB,CAAE,QAAS,CAAE,OAAQ,CAAE,CACzC,OAAO,EAAE,CAAC,WAAW,CAAE,OAAQ,CAAC,CAAC,SAAS,CAC3C,CAAC,CAYD,EAAE,CAAC,WAAY,CAAE,QAAS,CAAE,OAAQ,CAAE,CAErC,EAAG,CAAE,EAAE,CAAC,oBAAqB,GAAI,SAAU,CAAE,CAE5C,MAAM,GAAI,CAAE,QAAQ,CAAC,aAAa,CAAE,KAAM,CAAC,CAC3C,GAAG,CAAC,SAAU,CAAE,iBAAiB,CACjC,EAAE,CAAC,oBAAqB,CAAE,GAAG,CAAC,SAAU,GAAI,eAAe,CAC5D,CAEA,EAAG,CAAE,CAAC,EAAE,CAAC,oBAAqB,CAAE,CAC/B,OAAO,OAAO,CACf,CAOA,MAAM,QAAS,CAAE,CAAC,CAAE,OAAQ,CAAC,CAAC,KAAK,CAAC,CAAC,CACrC,QAAQ,CAAC,IAAI,CAAE,wBAAyB,CAAC,CAAC,IAAI,CAAE,CAAE,CAAC,CAAE,EAAG,CAAE,EAAG,CAC5D,IAAI,OAAO,CACX,EAAG,CAAE,EAAE,CAAC,UAAW,EAAG,EAAE,CAAC,UAAU,CAAC,QAAS,GAAI,IAAI,CAAC,SAAU,CAAE,CACjE,OAAQ,CAAE,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAE,eAAgB,CAAC,CACrD,EAAG,CAAE,OAAQ,EAAG,OAAO,CAAE,CAAE,CAAE,CAAE,CAE9B,EAAE,CAAC,UAAU,CAAC,UAAU,CAAE,CAAC,CAAE,OAAO,CAAE,CAAE,CAAE,CAAC,CAC5C,CACD,CACD,CAAE,CAAC,CACH,OAAO,QAAQ,CAAC,GAAG,CAAE,CAAE,CAAC,CACzB,CAAC,CAeD,EAAE,CAAC,uBAAwB,CAAE,QAAS,CAAE,IAAI,CAAE,KAAK,CAAE,QAAS,CAAE,KAAM,CAAE;AACvE,MAAM,IAAK,CAAE,QAAQ,CAAC,aAAa,CAAE,QAAS,CAAC,CAC/C,IAAI,CAAC,YAAY,CAAE,IAAI,CAAE,KAAM,CAAC,CAChC,OAAO,IAAI,CAAC,YAAY,CAAE,IAAK,CAAC,CACjC,CAAC,CASD,EAAE,CAAC,UAAW,CAAE,QAAS,CAAE,GAAG,CAAE,IAAK,CAAE,CACtC,MAAM,IAAK,CAAE,IAAI,CAAC,aAAa,CAAE,GAAI,CAAC,CAEtC,IAAI,CAAC,YAAY,CAAE,MAAM,CAAE,GAAI,CAAC,CAGhC,OAAO,IAAI,CAAC,IAAK,EAAG,GAAG,CACxB,CAAC"
}
},
{"offset":{"line":5,"column":0},"map":{
"version": 3,
"file": "/w/load.php?lang=ru&modules=ext.visualEditor.core.utils.parsing%7Cext.visualEditor.desktopArticleTarget.init%7Cext.visualEditor.progressBarWidget%2CsupportCheck%2CtargetLoader%2CtempWikitextEditorWidget%2Ctrack%2Cve&skin=vector&version=u9zxi",
"sources": ["/w/extensions/VisualEditor/modules/ve-mw/preinit/ve.init.mw.DesktopArticleTarget.init.js","/w/extensions/VisualEditor/modules/ve-mw/preinit/data.json"],
"sourcesContent": ["/*!\n * VisualEditor MediaWiki DesktopArticleTarget init.\n *\n * This file must remain as widely compatible as the base compatibility\n * for MediaWiki itself (see mediawiki/core:/resources/startup.js).\n * Avoid use of: SVG, HTML5 DOM, ContentEditable etc.\n *\n * @copyright See AUTHORS.txt\n * @license The MIT License (MIT); see LICENSE.txt\n */\n\n/* eslint-disable no-jquery/no-global-selector */\n// TODO: ve.now and ve.track should be moved to mw.libs.ve\n/* global ve */\n\n/**\n * Platform preparation for the MediaWiki view page. This loads (when user needs it) the\n * actual MediaWiki integration and VisualEditor library.\n */\n( function () {\n\tconst configData = require( './data.json' ),\n\t\tveactionToMode = {\n\t\t\tedit: 'visual',\n\t\t\teditsource: 'source'\n\t\t};\n\tlet init = null,\n\t\tconf = null,\n\t\ttabMessages = null,\n\t\tpageExists = null,\n\t\tviewUrl = null,\n\t\tveEditUrl = null,\n\t\ttabPreference = null;\n\tlet veEditSourceUrl, targetPromise, currentUrl,\n\t\tinitialWikitext, oldId,\n\t\tisLoading, tempWikitextEditor, tempWikitextEditorData,\n\t\t$toolbarPlaceholder, $toolbarPlaceholderBar,\n\t\tcontentTop, wasFloating,\n\t\tactive = false,\n\t\ttargetLoaded = false,\n\t\tplugins = [],\n\t\twelcomeDialogDisabled = false,\n\t\teducationPopupsDisabled = false,\n\t\t// Defined after document-ready below\n\t\t$targetContainer = null;\n\n\tif ( mw.config.get( 'wgMFMode' ) ) {\n\t\tmw.log.warn( 'Attempted to load desktop target on mobile.' );\n\t\treturn;\n\t}\n\n\t/**\n\t * Show the loading progress bar\n\t */\n\tfunction showLoading() {\n\t\tif ( isLoading ) {\n\t\t\treturn;\n\t\t}\n\n\t\tisLoading = true;\n\n\t\t$( 'html' ).addClass( 've-activated ve-loading' );\n\t\tif ( !init.$loading ) {\n\t\t\tinit.progressBar = new mw.libs.ve.ProgressBarWidget();\n\t\t\tinit.$loading = $( '<div>' )\n\t\t\t\t.addClass( 've-init-mw-desktopArticleTarget-loading-overlay' )\n\t\t\t\t.append( init.progressBar.$element );\n\t\t}\n\t\t$( document ).on( 'keydown', onDocumentKeyDown );\n\n\t\t$toolbarPlaceholderBar.append( init.$loading );\n\t}\n\n\t/**\n\t * Increment loading progress by one step\n\t *\n\t * See mw.libs.ve.ProgressBarWidget for steps.\n\t */\n\tfunction incrementLoadingProgress() {\n\t\tinit.progressBar.incrementLoadingProgress();\n\t}\n\n\t/**\n\t * Clear and hide the loading progress bar\n\t */\n\tfunction clearLoading() {\n\t\tinit.progressBar.clearLoading();\n\t\tisLoading = false;\n\t\t$( document ).off( 'keydown', onDocumentKeyDown );\n\t\t$( 'html' ).removeClass( 've-loading' );\n\t\tif ( init.$loading ) {\n\t\t\tinit.$loading.detach();\n\t\t}\n\n\t\tif ( tempWikitextEditor ) {\n\t\t\tteardownTempWikitextEditor();\n\t\t}\n\t\thideToolbarPlaceholder();\n\t}\n\n\t/**\n\t * Handle window scroll events\n\t *\n\t * @param {Event} e\n\t */\n\tfunction onWindowScroll() {\n\t\tconst scrollTop = $( document.documentElement ).scrollTop();\n\t\tconst floating = scrollTop > contentTop;\n\t\tif ( floating !== wasFloating ) {\n\t\t\tconst width = $targetContainer.outerWidth();\n\t\t\t$toolbarPlaceholder.toggleClass( 've-init-mw-desktopArticleTarget-toolbarPlaceholder-floating', floating );\n\t\t\t$toolbarPlaceholderBar.css( 'width', width );\n\t\t\twasFloating = floating;\n\t\t}\n\t}\n\n\tconst onWindowScrollListener = mw.util.throttle( onWindowScroll, 250 );\n\n\t/**\n\t * Show a placeholder for the VE toolbar\n\t */\n\tfunction showToolbarPlaceholder() {\n\t\tif ( !$toolbarPlaceholder ) {\n\t\t\t// Create an equal-height placeholder for the toolbar to avoid vertical jump\n\t\t\t// when the real toolbar is ready.\n\t\t\t$toolbarPlaceholder = $( '<div>' ).addClass( 've-init-mw-desktopArticleTarget-toolbarPlaceholder' );\n\t\t\t$toolbarPlaceholderBar = $( '<div>' ).addClass( 've-init-mw-desktopArticleTarget-toolbarPlaceholder-bar' );\n\t\t\t$toolbarPlaceholder.append( $toolbarPlaceholderBar );\n\t\t}\n\t\t// Toggle -floating class before append (if required) to avoid content moving later\n\t\tcontentTop = $targetContainer.offset().top;\n\t\twasFloating = null;\n\t\tonWindowScroll();\n\n\t\tconst scrollTopBefore = $( document.documentElement ).scrollTop();\n\n\t\t$targetContainer.prepend( $toolbarPlaceholder );\n\n\t\twindow.addEventListener( 'scroll', onWindowScrollListener, { passive: true } );\n\n\t\tif ( wasFloating ) {\n\t\t\t// Browser might not support scroll anchoring:\n\t\t\t// https://developer.mozilla.org/en-US/docs/Web/CSS/overflow-anchor/Guide_to_scroll_anchoring\n\t\t\t// ...so compute the new scroll offset ourselves.\n\t\t\twindow.scrollTo( 0, scrollTopBefore + $toolbarPlaceholder.outerHeight() );\n\t\t}\n\n\t\t// Add class for transition after first render\n\t\tsetTimeout( () => {\n\t\t\t$toolbarPlaceholder.addClass( 've-init-mw-desktopArticleTarget-toolbarPlaceholder-open' );\n\t\t} );\n\t}\n\n\t/**\n\t * Hide the placeholder for the VE toolbar\n\t */\n\tfunction hideToolbarPlaceholder() {\n\t\tif ( $toolbarPlaceholder ) {\n\t\t\twindow.removeEventListener( 'scroll', onWindowScrollListener );\n\t\t\t$toolbarPlaceholder.detach();\n\t\t\t$toolbarPlaceholder.removeClass( 've-init-mw-desktopArticleTarget-toolbarPlaceholder-open' );\n\t\t}\n\t}\n\n\t/**\n\t * Create a temporary `<textarea>` wikitext editor while source mode loads\n\t *\n\t * @param {Object} data Initialisation data for VE\n\t */\n\tfunction setupTempWikitextEditor( data ) {\n\t\tlet wikitext = data.content;\n\t\t// Add trailing linebreak to non-empty wikitext documents for consistency\n\t\t// with old editor and usability. Will be stripped on save. T156609\n\t\tif ( wikitext ) {\n\t\t\twikitext += '\\n';\n\t\t}\n\t\ttempWikitextEditor = new mw.libs.ve.MWTempWikitextEditorWidget( { value: wikitext } );\n\t\ttempWikitextEditorData = data;\n\n\t\t// Bring forward some transformations that show the editor is now ready\n\t\t// Grey out the page title if it is below the editing toolbar (depending on skin), to show it is uneditable.\n\t\t$( '.ve-init-mw-desktopArticleTarget-targetContainer #firstHeading' ).addClass( 've-init-mw-desktopArticleTarget-uneditableContent' );\n\t\t$( '#mw-content-text' )\n\t\t\t.before( tempWikitextEditor.$element )\n\t\t\t.addClass( 'oo-ui-element-hidden' );\n\t\t$( 'html' ).addClass( 've-tempSourceEditing' ).removeClass( 've-loading' );\n\n\t\t// Resize the textarea to fit content. We could do this more often (e.g. on change)\n\t\t// but hopefully this temporary textarea won't be visible for too long.\n\t\ttempWikitextEditor.adjustSize().moveCursorToStart();\n\t\tve.track( 'editAttemptStep', { action: 'ready', mode: 'source', platform: 'desktop' } );\n\t\tmw.libs.ve.tempWikitextEditor = tempWikitextEditor;\n\t\tmw.hook( 've.wikitextInteractive' ).fire();\n\t}\n\n\t/**\n\t * Synchronise state of temporary wikitexteditor back to the VE initialisation data object\n\t */\n\tfunction syncTempWikitextEditor() {\n\t\tlet wikitext = tempWikitextEditor.getValue();\n\n\t\t// Strip trailing linebreak. Will get re-added in ArticleTarget#parseDocument.\n\t\tif ( wikitext.endsWith( '\\n' ) ) {\n\t\t\twikitext = wikitext.slice( 0, -1 );\n\t\t}\n\n\t\tif ( wikitext !== tempWikitextEditorData.content ) {\n\t\t\t// Write changes back to response data object,\n\t\t\t// which will be used to construct the surface.\n\t\t\ttempWikitextEditorData.content = wikitext;\n\t\t\t// TODO: Consider writing changes using a\n\t\t\t// transaction so they can be undone.\n\t\t\t// For now, just mark surface as pre-modified\n\t\t\ttempWikitextEditorData.fromEditedState = true;\n\t\t}\n\n\t\t// Store the last-seen selection and pass to the target\n\t\ttempWikitextEditorData.initialSourceRange = tempWikitextEditor.getRange();\n\n\t\ttempWikitextEditor.$element.prop( 'readonly', true );\n\t}\n\n\t/**\n\t * Teardown the temporary wikitext editor\n\t */\n\tfunction teardownTempWikitextEditor() {\n\t\t// Destroy widget and placeholder\n\t\ttempWikitextEditor.$element.remove();\n\t\tmw.libs.ve.tempWikitextEditor = tempWikitextEditor = null;\n\t\ttempWikitextEditorData = null;\n\n\t\t$( '#mw-content-text' ).removeClass( 'oo-ui-element-hidden' );\n\t\t$( 'html' ).removeClass( 've-tempSourceEditing' );\n\t}\n\n\t/**\n\t * Abort loading the editor\n\t */\n\tfunction abortLoading() {\n\t\t$( 'html' ).removeClass( 've-activated' );\n\t\tactive = false;\n\t\tupdateTabs( false );\n\t\t// Push read tab URL to history\n\t\tif ( $( '#ca-view a' ).length ) {\n\t\t\thistory.pushState( { tag: 'visualeditor' }, '', $( '#ca-view a' ).attr( 'href' ) );\n\t\t}\n\t\tclearLoading();\n\t}\n\n\t/**\n\t * Handle keydown events on the document\n\t *\n\t * @param {jQuery.Event} e Keydown event\n\t */\n\tfunction onDocumentKeyDown( e ) {\n\t\tif ( e.which === 27 /* OO.ui.Keys.ESCAPE */ ) {\n\t\t\tabortLoading();\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\t/**\n\t * Get a section value from a URL\n\t *\n\t * @param {URL} url URL\n\t * @return {string|null} Section if valid, null otherwise\n\t */\n\tfunction getSectionFromUrl( url ) {\n\t\tconst section = url.searchParams.get( 'section' );\n\t\t// Section must be a number, 'new' or 'T-' prefixed\n\t\tif ( section && /^(new|\\d+|T-\\d+)$/.test( section ) ) {\n\t\t\treturn section;\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Use deferreds to avoid loading and instantiating Target multiple times.\n\t *\n\t * @private\n\t * @param {string} mode Target mode: 'visual' or 'source'\n\t * @param {string} section Section to edit\n\t * @return {jQuery.Promise}\n\t */\n\tfunction getTarget( mode, section ) {\n\t\tif ( !targetPromise ) {\n\t\t\tmw.libs.ve.targetLoader.addPlugin(\n\t\t\t\t// Run VisualEditorPreloadModules, but if they fail, we still want to continue\n\t\t\t\t// loading, so convert failure to success\n\t\t\t\t() => mw.loader.using( conf.preloadModules ).catch(\n\t\t\t\t\t() => $.Deferred().resolve()\n\t\t\t\t)\n\t\t\t);\n\t\t\t// Add modules specific to desktop (modules shared between desktop\n\t\t\t// and mobile are already added by TargetLoader)\n\t\t\t[\n\t\t\t\t'ext.visualEditor.desktopArticleTarget',\n\t\t\t\t// Add requested plugins\n\t\t\t\t...plugins\n\t\t\t].forEach( mw.libs.ve.targetLoader.addPlugin );\n\t\t\tplugins = [];\n\t\t\ttargetPromise = mw.libs.ve.targetLoader.loadModules( mode ).then( () => {\n\t\t\t\tif ( !active ) {\n\t\t\t\t\t// Loading was aborted\n\t\t\t\t\t// TODO: Make loaders abortable instead of waiting\n\t\t\t\t\ttargetPromise = null;\n\t\t\t\t\treturn $.Deferred().reject().promise();\n\t\t\t\t}\n\n\t\t\t\tconst target = ve.init.mw.targetFactory.create(\n\t\t\t\t\tconf.contentModels[ mw.config.get( 'wgPageContentModel' ) ], {\n\t\t\t\t\t\tmodes: getAvailableModes(),\n\t\t\t\t\t\tdefaultMode: mode\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\ttarget.on( 'deactivate', () => {\n\t\t\t\t\tactive = false;\n\t\t\t\t\tupdateTabs( false );\n\t\t\t\t} );\n\t\t\t\ttarget.on( 'reactivate', () => {\n\t\t\t\t\tcurrentUrl = new URL( location.href );\n\t\t\t\t\tactivateTarget(\n\t\t\t\t\t\tgetEditModeFromUrl( currentUrl ),\n\t\t\t\t\t\tgetSectionFromUrl( currentUrl )\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t\t\ttarget.setContainer( $targetContainer );\n\t\t\t\ttargetLoaded = true;\n\t\t\t\treturn target;\n\t\t\t}, ( e ) => {\n\t\t\t\tmw.log.warn( 'VisualEditor failed to load: ' + e );\n\t\t\t\treturn $.Deferred().reject( e ).promise();\n\t\t\t} );\n\t\t}\n\n\t\ttargetPromise.then( ( target ) => {\n\t\t\ttarget.section = section;\n\t\t} );\n\n\t\treturn targetPromise;\n\t}\n\n\t/**\n\t * @private\n\t * @param {Object} initData\n\t * @param {URL} [url]\n\t */\n\tfunction trackActivateStart( initData, url = currentUrl ) {\n\t\tif ( url.searchParams.get( 'wvprov' ) === 'sticky-header' ) {\n\t\t\tinitData.mechanism += '-sticky-header';\n\t\t}\n\t\tve.track( 'trace.activate.enter', { mode: initData.mode } );\n\t\tinitData.action = 'init';\n\t\tinitData.integration = 'page';\n\t\tve.track( 'editAttemptStep', initData );\n\t\tmw.libs.ve.activationStart = ve.now();\n\t}\n\n\t/**\n\t * Get the skin-specific message for an edit tab\n\t *\n\t * @param {string} tabMsg Base tab message key\n\t * @return {string} Message text\n\t */\n\tfunction getTabMessage( tabMsg ) {\n\t\tlet tabMsgKey = tabMessages[ tabMsg ];\n\t\tconst skinMsgKeys = {\n\t\t\tedit: 'edit',\n\t\t\tcreate: 'create',\n\t\t\teditlocaldescription: 'edit-local',\n\t\t\tcreatelocaldescription: 'create-local'\n\t\t};\n\t\tconst key = skinMsgKeys[ tabMsg ];\n\t\tif ( !tabMsgKey && key ) {\n\t\t\t// Some skins don't use the default skin message keys.\n\t\t\t// The following messages can be used here:\n\t\t\t// * vector-view-edit\n\t\t\t// * vector-view-create\n\t\t\t// * vector-view-edit-local\n\t\t\t// * vector-view-create-local\n\t\t\t// * messages for other skins\n\t\t\ttabMsgKey = mw.config.get( 'skin' ) + '-view-' + key;\n\t\t\tif ( !mw.message( tabMsgKey ).exists() ) {\n\t\t\t\t// The following messages can be used here:\n\t\t\t\t// * skin-view-edit\n\t\t\t\t// * skin-view-create\n\t\t\t\t// * skin-view-edit-local\n\t\t\t\t// * skin-view-create-local\n\t\t\t\ttabMsgKey = 'skin-view-' + key;\n\t\t\t}\n\t\t}\n\t\t// eslint-disable-next-line mediawiki/msg-doc\n\t\tconst msg = mw.message( tabMsgKey );\n\t\tif ( !msg.isParseable() ) {\n\t\t\tmw.log.warn( 'VisualEditor: MediaWiki:' + tabMsgKey + ' contains unsupported syntax. ' +\n\t\t\t\t'https://www.mediawiki.org/wiki/Manual:Messages_API#Feature_support_in_JavaScript' );\n\t\t\treturn undefined;\n\t\t}\n\t\treturn msg.text();\n\t}\n\n\t/**\n\t * Set the user's new preferred editor\n\t *\n\t * @param {string} editor Preferred editor, 'visualeditor' or 'wikitext'\n\t * @return {jQuery.Promise} Promise which resolves when the preference has been set\n\t */\n\tfunction setEditorPreference( editor ) {\n\t\t// If visual mode isn't available, don't set the editor preference as the\n\t\t// user has expressed no choice by opening this editor. (T246259)\n\t\t// Strictly speaking the same thing should happen if visual mode is\n\t\t// available but source mode isn't, but that is never the case.\n\t\tif ( !init.isVisualAvailable() ) {\n\t\t\treturn $.Deferred().resolve().promise();\n\t\t}\n\n\t\tif ( editor !== 'visualeditor' && editor !== 'wikitext' ) {\n\t\t\tthrow new Error( 'setEditorPreference called with invalid option: ', editor );\n\t\t}\n\n\t\tlet key = pageExists ? 'edit' : 'create',\n\t\t\tsectionKey = 'editsection';\n\n\t\tif (\n\t\t\tmw.config.get( 'wgVisualEditorConfig' ).useSingleEditTab &&\n\t\t\ttabPreference === 'remember-last'\n\t\t) {\n\t\t\tif ( $( '#ca-view-foreign' ).length ) {\n\t\t\t\tkey += 'localdescription';\n\t\t\t}\n\t\t\tif ( editor === 'wikitext' ) {\n\t\t\t\tkey += 'source';\n\t\t\t\tsectionKey += 'source';\n\t\t\t}\n\n\t\t\tconst fallbackSelector = function ( selector, fallback ) {\n\t\t\t\tconst $result = $( selector );\n\t\t\t\treturn $result.length > 0 ? $result : $( fallback );\n\t\t\t};\n\n\t\t\t// Depending on skin these might contain text nested in a span\n\t\t\tfallbackSelector( '#ca-edit a span', '#ca-edit a' ).text( getTabMessage( key ) );\n\t\t\tfallbackSelector( '.mw-editsection a span', '.mw-editsection a' ).text( getTabMessage( sectionKey ) );\n\t\t}\n\n\t\tmw.cookie.set( 'VEE', editor, { path: '/', expires: 30 * 86400, prefix: '' } );\n\n\t\t// Save user preference if logged in\n\t\tif (\n\t\t\tmw.user.isNamed() &&\n\t\t\tmw.user.options.get( 'visualeditor-editor' ) !== editor\n\t\t) {\n\t\t\t// Same as ve.init.target.getLocalApi()\n\t\t\treturn new mw.Api().saveOption( 'visualeditor-editor', editor ).then( () => {\n\t\t\t\tmw.user.options.set( 'visualeditor-editor', editor );\n\t\t\t} );\n\t\t}\n\t\treturn $.Deferred().resolve().promise();\n\t}\n\n\t/**\n\t * Update state of editing tabs\n\t *\n\t * @param {boolean} editing Whether the editor is loaded\n\t * @param {string} [mode='visual'] Edit mode ('visual' or 'source')\n\t * @param {boolean} [isNewSection] Adding a new section\n\t */\n\tfunction updateTabs( editing, mode, isNewSection ) {\n\t\tlet $tab;\n\n\t\tif ( editing ) {\n\t\t\tif ( isNewSection ) {\n\t\t\t\t$tab = $( '#ca-addsection' );\n\t\t\t} else if ( $( '#ca-ve-edit' ).length ) {\n\t\t\t\tif ( !mode || mode === 'visual' ) {\n\t\t\t\t\t$tab = $( '#ca-ve-edit' );\n\t\t\t\t} else {\n\t\t\t\t\t$tab = $( '#ca-edit' );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Single edit tab\n\t\t\t\t$tab = $( '#ca-edit' );\n\t\t\t}\n\t\t} else {\n\t\t\t$tab = $( '#ca-view' );\n\t\t}\n\n\t\t// Deselect current mode (e.g. \"view\" or \"history\") in skins that have\n\t\t// separate tab sections for content actions and namespaces, like Vector.\n\t\t$( '#p-views' ).find( 'li.selected' ).removeClass( 'selected' );\n\t\t// In skins like MonoBook that don't have the separate tab sections,\n\t\t// deselect the known tabs for editing modes (when switching or exiting editor).\n\t\t$( '#ca-edit, #ca-ve-edit, #ca-addsection' ).not( $tab ).removeClass( 'selected' );\n\n\t\t$tab.addClass( 'selected' );\n\t}\n\n\t/**\n\t * Scroll to a specific heading before VE loads\n\t *\n\t * Similar to ve.init.mw.ArticleTarget.prototype.scrollToHeading\n\t *\n\t * @param {string} section Parsed section (string)\n\t */\n\tfunction scrollToSection( section ) {\n\t\tif ( section === '0' || section === 'new' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet $heading;\n\t\t$( '#mw-content-text .mw-editsection a:not( .mw-editsection-visualeditor )' ).each( ( i, el ) => {\n\t\t\tconst linkUrl = new URL( el.href );\n\t\t\tif ( section === getSectionFromUrl( linkUrl ) ) {\n\t\t\t\t$heading = $( el ).closest( '.mw-heading' );\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} );\n\t\t// When loading on action=edit URLs, there is no page content\n\t\tif ( !$heading || !$heading.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet offset = 0;\n\t\tconst enableVisualSectionEditing = mw.config.get( 'wgVisualEditorConfig' ).enableVisualSectionEditing;\n\t\tif ( enableVisualSectionEditing === true || enableVisualSectionEditing === 'desktop' ) {\n\t\t\t// Heading will jump to the top of the page in visual section editing.\n\t\t\t// This measurement already includes the height of $toolbarPlaceholder.\n\t\t\toffset = $( '#mw-content-text' ).offset().top;\n\t\t} else {\n\t\t\t// Align with top of heading margin. Doesn't apply in visual section editing as the margin collapses.\n\t\t\toffset = parseInt( $heading.css( 'margin-top' ) ) + $toolbarPlaceholder.outerHeight();\n\t\t}\n\n\t\tmw.libs.ve.smoothScrollTo( $heading.offset().top - offset );\n\t}\n\n\t/**\n\t * Load and activate the target.\n\t *\n\t * If you need to call methods on the target before activate is called, call getTarget()\n\t * yourself, chain your work onto that promise, and pass that chained promise in as targetPromise.\n\t * E.g. `activateTarget( getTarget().then( function( target ) { target.doAThing(); } ) );`\n\t *\n\t * @private\n\t * @param {string} mode Target mode: 'visual' or 'source'\n\t * @param {string} [section] Section to edit.\n\t *  If visual section editing is not enabled, we will jump to the start of this section, and still\n\t *  the heading to prefix the edit summary.\n\t * @param {jQuery.Promise} [tPromise] Promise that will be resolved with a ve.init.mw.DesktopArticleTarget\n\t * @param {boolean} [modified=false] The page has been modified before loading (e.g. in source mode)\n\t */\n\tfunction activateTarget( mode, section, tPromise, modified ) {\n\t\tlet dataPromise;\n\n\t\tupdateTabs( true, mode, section === 'new' );\n\n\t\t// Only call requestPageData early if the target object isn't there yet.\n\t\t// If the target object is there, this is a second or subsequent load, and the\n\t\t// internal state of the target object can influence the load request.\n\t\tif ( !targetLoaded ) {\n\t\t\tdataPromise = mw.libs.ve.targetLoader.requestPageData( mode, mw.config.get( 'wgRelevantPageName' ), {\n\t\t\t\tsessionStore: true,\n\t\t\t\tsection,\n\t\t\t\toldId,\n\t\t\t\t// Should be ve.init.mw.DesktopArticleTarget.static.trackingName, but the\n\t\t\t\t// class hasn't loaded yet.\n\t\t\t\t// This is used for stats tracking, so do not change!\n\t\t\t\ttargetName: 'mwTarget',\n\t\t\t\tmodified,\n\t\t\t\teditintro: currentUrl.searchParams.get( 'editintro' ),\n\t\t\t\tpreload: currentUrl.searchParams.get( 'preload' ),\n\t\t\t\tpreloadparams: mw.util.getArrayParam( 'preloadparams', currentUrl.searchParams ),\n\t\t\t\t// If switching to visual with modifications, check if we have wikitext to convert\n\t\t\t\twikitext: mode === 'visual' && modified ? $( '#wpTextbox1' ).textSelection( 'getContents' ) : undefined\n\t\t\t} );\n\n\t\t\tdataPromise\n\t\t\t\t.then( ( response ) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t// Check target promise hasn't already failed (isLoading=false)\n\t\t\t\t\t\tisLoading &&\n\t\t\t\t\t\t// TODO: Support tempWikitextEditor when section=new (T185633)\n\t\t\t\t\t\tmode === 'source' && section !== 'new' &&\n\t\t\t\t\t\t// Can't use temp editor when recovering an autosave\n\t\t\t\t\t\t!( response.visualeditor && response.visualeditor.recovered )\n\t\t\t\t\t) {\n\t\t\t\t\t\tsetupTempWikitextEditor( response.visualeditor );\n\t\t\t\t\t}\n\t\t\t\t} )\n\t\t\t\t.then( incrementLoadingProgress );\n\t\t}\n\n\t\t// Do this before section scrolling\n\t\tshowToolbarPlaceholder();\n\t\tmw.hook( 've.activationStart' ).fire();\n\n\t\tlet visibleSection = null;\n\t\tlet visibleSectionOffset = null;\n\t\tif ( section === null ) {\n\t\t\tlet firstVisibleEditSection = null;\n\t\t\t$( '#firstHeading, #mw-content-text .mw-editsection' ).each( ( i, el ) => {\n\t\t\t\tconst top = el.getBoundingClientRect().top;\n\t\t\t\tif ( top > 0 ) {\n\t\t\t\t\tfirstVisibleEditSection = el;\n\t\t\t\t\t// break\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tif ( firstVisibleEditSection && firstVisibleEditSection.id !== 'firstHeading' ) {\n\t\t\t\tconst firstVisibleSectionLink = firstVisibleEditSection.querySelector( 'a' );\n\t\t\t\tconst linkUrl = new URL( firstVisibleSectionLink.href );\n\t\t\t\tvisibleSection = getSectionFromUrl( linkUrl );\n\n\t\t\t\tconst firstVisibleHeading = $( firstVisibleEditSection ).closest( '.mw-heading' )[ 0 ];\n\t\t\t\tvisibleSectionOffset = firstVisibleHeading.getBoundingClientRect().top;\n\t\t\t}\n\t\t} else if ( mode === 'visual' ) {\n\t\t\tscrollToSection( section );\n\t\t}\n\n\t\tshowLoading( mode );\n\t\tincrementLoadingProgress();\n\t\tactive = true;\n\n\t\ttPromise = tPromise || getTarget( mode, section );\n\t\ttPromise\n\t\t\t.then( ( target ) => {\n\t\t\t\ttarget.visibleSection = visibleSection;\n\t\t\t\ttarget.visibleSectionOffset = visibleSectionOffset;\n\n\t\t\t\tincrementLoadingProgress();\n\t\t\t\t// If target was already loaded, ensure the mode is correct\n\t\t\t\ttarget.setDefaultMode( mode );\n\t\t\t\t// syncTempWikitextEditor modified the result object in the dataPromise\n\t\t\t\tif ( tempWikitextEditor ) {\n\t\t\t\t\tsyncTempWikitextEditor();\n\t\t\t\t}\n\n\t\t\t\tconst deactivating = target.deactivatingDeferred || $.Deferred().resolve();\n\t\t\t\treturn deactivating.then( () => {\n\t\t\t\t\ttarget.currentUrl = new URL( location.href );\n\t\t\t\t\tconst activatePromise = target.activate( dataPromise );\n\n\t\t\t\t\t// toolbarSetupDeferred resolves slightly before activatePromise, use done\n\t\t\t\t\t// to run in the same paint cycle as the VE toolbar being drawn\n\t\t\t\t\ttarget.toolbarSetupDeferred.then( () => {\n\t\t\t\t\t\thideToolbarPlaceholder();\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn activatePromise;\n\t\t\t\t} );\n\t\t\t} )\n\t\t\t.then( () => {\n\t\t\t\tif ( mode === 'visual' ) {\n\t\t\t\t\t// `action: 'ready'` has already been fired for source mode in setupTempWikitextEditor\n\t\t\t\t\tve.track( 'editAttemptStep', { action: 'ready', mode } );\n\t\t\t\t} else if ( !tempWikitextEditor ) {\n\t\t\t\t\t// We're in source mode, but skipped the\n\t\t\t\t\t// tempWikitextEditor, so make sure we do relevant\n\t\t\t\t\t// tracking / hooks:\n\t\t\t\t\tve.track( 'editAttemptStep', { action: 'ready', mode } );\n\t\t\t\t\tmw.hook( 've.wikitextInteractive' ).fire();\n\t\t\t\t}\n\t\t\t\tve.track( 'editAttemptStep', { action: 'loaded', mode } );\n\t\t\t} )\n\t\t\t.always( clearLoading );\n\t}\n\n\t/**\n\t * @private\n\t * @param {string} mode Target mode: 'visual' or 'source'\n\t * @param {string} [section]\n\t * @param {boolean} [modified=false] The page has been modified before loading (e.g. in source mode)\n\t * @param {URL} [linkUrl] URL to navigate to, potentially with extra parameters\n\t */\n\tfunction activatePageTarget( mode, section, modified, linkUrl ) {\n\t\ttrackActivateStart( { type: 'page', mechanism: mw.config.get( 'wgArticleId' ) ? 'click' : 'new', mode }, linkUrl );\n\n\t\tif ( !active ) {\n\t\t\t// Replace the current state with one that is tagged as ours, to prevent the\n\t\t\t// back button from breaking when used to exit VE. FIXME: there should be a better\n\t\t\t// way to do this. See also similar code in the DesktopArticleTarget constructor.\n\t\t\thistory.replaceState( { tag: 'visualeditor' }, '', currentUrl );\n\t\t\t// Set action=edit or veaction=edit/editsource\n\t\t\t// Use linkUrl to preserve parameters like 'editintro' (T56029)\n\t\t\thistory.pushState( { tag: 'visualeditor' }, '', linkUrl || ( mode === 'source' ? veEditSourceUrl : veEditUrl ) );\n\t\t\t// Update URL instance\n\t\t\tcurrentUrl = linkUrl || veEditUrl;\n\n\t\t\tactivateTarget( mode, section, undefined, modified );\n\t\t}\n\t}\n\n\t/**\n\t * Get the last mode a user used\n\t *\n\t * @return {string|null} 'visualeditor', 'wikitext' or null\n\t */\n\tfunction getLastEditor() {\n\t\t// This logic matches VisualEditorHooks::getLastEditor\n\t\tlet editor = mw.cookie.get( 'VEE', '' );\n\t\t// Set editor to user's preference or site's default (ignore the cookie) if …\n\t\tif (\n\t\t\t// … user is logged in,\n\t\t\tmw.user.isNamed() ||\n\t\t\t// … no cookie is set, or\n\t\t\t!editor ||\n\t\t\t// value is invalid.\n\t\t\t!( editor === 'visualeditor' || editor === 'wikitext' )\n\t\t) {\n\t\t\teditor = mw.user.options.get( 'visualeditor-editor' );\n\t\t}\n\t\treturn editor;\n\t}\n\n\t/**\n\t * Get the preferred editor for this edit page\n\t *\n\t * For the preferred *available* editor, use getAvailableEditPageEditor.\n\t *\n\t * @return {string|null} 'visualeditor', 'wikitext' or null\n\t */\n\tfunction getEditPageEditor() {\n\t\t// This logic matches VisualEditorHooks::getEditPageEditor\n\t\t// !!+ casts '0' to false\n\t\tconst isRedLink = !!+currentUrl.searchParams.get( 'redlink' );\n\t\t// On dual-edit-tab wikis, the edit page must mean the user wants wikitext,\n\t\t// unless following a redlink\n\t\tif ( !mw.config.get( 'wgVisualEditorConfig' ).useSingleEditTab && !isRedLink ) {\n\t\t\treturn 'wikitext';\n\t\t}\n\t\t// Adding a new section is not supported in visual mode\n\t\tif ( currentUrl.searchParams.get( 'section' ) === 'new' ) {\n\t\t\treturn 'wikitext';\n\t\t}\n\t\t// Force switched from VE\n\t\tif ( currentUrl.searchParams.has( 'veswitched' ) ) {\n\t\t\treturn 'wikitext';\n\t\t}\n\n\t\tswitch ( tabPreference ) {\n\t\t\tcase 'prefer-ve':\n\t\t\t\treturn 'visualeditor';\n\t\t\tcase 'prefer-wt':\n\t\t\t\treturn 'wikitext';\n\t\t\tcase 'multi-tab':\n\t\t\t\t// 'multi-tab'\n\t\t\t\t// TODO: See VisualEditor.hooks.php\n\t\t\t\treturn isRedLink ?\n\t\t\t\t\tgetLastEditor() :\n\t\t\t\t\t'wikitext';\n\t\t\tcase 'remember-last':\n\t\t\tdefault:\n\t\t\t\treturn getLastEditor();\n\t\t}\n\t}\n\n\t/**\n\t * Get the preferred editor which is also available on this edit page\n\t *\n\t * @return {string} 'visual' or 'source'\n\t */\n\tfunction getAvailableEditPageEditor() {\n\t\tswitch ( getEditPageEditor() ) {\n\t\t\tcase 'visualeditor':\n\t\t\t\tif ( init.isVisualAvailable() ) {\n\t\t\t\t\treturn 'visual';\n\t\t\t\t}\n\t\t\t\tif ( init.isWikitextAvailable() ) {\n\t\t\t\t\treturn 'source';\n\t\t\t\t}\n\t\t\t\treturn null;\n\n\t\t\tcase 'wikitext':\n\t\t\tdefault:\n\t\t\t\treturn init.isWikitextAvailable() ? 'source' : null;\n\t\t}\n\t}\n\n\t/**\n\t * Check if a boolean preference is set in user options, mw.storage or a cookie\n\t *\n\t * @param {string} prefName Preference name\n\t * @param {string} storageKey mw.storage key\n\t * @param {string} cookieName Cookie name\n\t * @return {boolean} Preference is set\n\t */\n\tfunction checkPreferenceOrStorage( prefName, storageKey, cookieName ) {\n\t\tstorageKey = storageKey || prefName;\n\t\tcookieName = cookieName || storageKey;\n\t\treturn !!( mw.user.options.get( prefName ) ||\n\t\t\t(\n\t\t\t\t!mw.user.isNamed() && (\n\t\t\t\t\tmw.storage.get( storageKey ) ||\n\t\t\t\t\tmw.cookie.get( cookieName, '' )\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\t}\n\n\t/**\n\t * Set a boolean preference to true in user options, mw.storage or a cookie\n\t *\n\t * @param {string} prefName Preference name\n\t * @param {string} storageKey mw.storage key\n\t * @param {string} cookieName Cookie name\n\t */\n\tfunction setPreferenceOrStorage( prefName, storageKey, cookieName ) {\n\t\tstorageKey = storageKey || prefName;\n\t\tcookieName = cookieName || storageKey;\n\t\tif ( !mw.user.isNamed() ) {\n\t\t\t// Try local storage first; if that fails, set a cookie\n\t\t\tif ( !mw.storage.set( storageKey, 1 ) ) {\n\t\t\t\tmw.cookie.set( cookieName, 1, { path: '/', expires: 30 * 86400, prefix: '' } );\n\t\t\t}\n\t\t} else {\n\t\t\tnew mw.Api().saveOption( prefName, '1' );\n\t\t\tmw.user.options.set( prefName, '1' );\n\t\t}\n\t}\n\n\tconf = mw.config.get( 'wgVisualEditorConfig' );\n\ttabMessages = conf.tabMessages;\n\tviewUrl = new URL( mw.util.getUrl( mw.config.get( 'wgRelevantPageName' ) ), location.href );\n\tcurrentUrl = new URL( location.href );\n\t// T156998: Don't trust 'oldid' query parameter, it'll be wrong if 'diff' or 'direction'\n\t// is set to 'next' or 'prev'.\n\toldId = mw.config.get( 'wgRevisionId' ) || $( 'input[name=parentRevId]' ).val();\n\tif ( oldId === mw.config.get( 'wgCurRevisionId' ) || mw.config.get( 'wgEditLatestRevision' ) ) {\n\t\t// The page may have been edited by someone else after we loaded it, setting this to \"undefined\"\n\t\t// indicates that we should load the actual latest revision.\n\t\toldId = undefined;\n\t}\n\tpageExists = !!mw.config.get( 'wgRelevantArticleId' );\n\tconst isViewPage = mw.config.get( 'wgIsArticle' ) && !currentUrl.searchParams.has( 'diff' );\n\tconst wgAction = mw.config.get( 'wgAction' );\n\tconst isEditPage = wgAction === 'edit' || wgAction === 'submit';\n\tconst pageCanLoadEditor = isViewPage || isEditPage;\n\tconst pageIsProbablyEditable = mw.config.get( 'wgIsProbablyEditable' ) ||\n\t\tmw.config.get( 'wgRelevantPageIsProbablyEditable' );\n\n\t// Cast \"0\" (T89513)\n\tconst enable = !!+mw.user.options.get( 'visualeditor-enable' );\n\tconst tempdisable = !!+mw.user.options.get( 'visualeditor-betatempdisable' );\n\tconst autodisable = !!+mw.user.options.get( 'visualeditor-autodisable' );\n\ttabPreference = mw.user.options.get( 'visualeditor-tabs' );\n\n\t/**\n\t * The only edit tab shown to the user is for visual mode\n\t *\n\t * @return {boolean}\n\t */\n\tfunction isOnlyTabVE() {\n\t\treturn conf.useSingleEditTab && getAvailableEditPageEditor() === 'visual';\n\t}\n\n\t/**\n\t * The only edit tab shown to the user is for source mode\n\t *\n\t * @return {boolean}\n\t */\n\tfunction isOnlyTabWikitext() {\n\t\treturn conf.useSingleEditTab && getAvailableEditPageEditor() === 'source';\n\t}\n\n\tinit = {\n\t\t/**\n\t\t * Add a plugin module or function.\n\t\t *\n\t\t * Plugins are run after VisualEditor is loaded, but before it is initialized. This allows\n\t\t * plugins to add classes and register them with the factories and registries.\n\t\t *\n\t\t * The parameter to this function can be a ResourceLoader module name or a function.\n\t\t *\n\t\t * If it's a module name, it will be loaded together with the VisualEditor core modules when\n\t\t * VE is loaded. No special care is taken to ensure that the module runs after the VE\n\t\t * classes are loaded, so if this is desired, the module should depend on\n\t\t * ext.visualEditor.core .\n\t\t *\n\t\t * If it's a function, it will be invoked once the VisualEditor core modules and any\n\t\t * plugin modules registered through this function have been loaded, but before the editor\n\t\t * is intialized. The function can optionally return a jQuery.Promise . VisualEditor will\n\t\t * only be initialized once all promises returned by plugin functions have been resolved.\n\t\t *\n\t\t *     // Register ResourceLoader module\n\t\t *     mw.libs.ve.addPlugin( 'ext.gadget.foobar' );\n\t\t *\n\t\t *     // Register a callback\n\t\t *     mw.libs.ve.addPlugin( ( target ) => {\n\t\t *         ve.dm.Foobar = .....\n\t\t *     } );\n\t\t *\n\t\t *     // Register a callback that loads another script\n\t\t *     mw.libs.ve.addPlugin( () => $.getScript( 'http://example.com/foobar.js' ) );\n\t\t *\n\t\t * @param {string|Function} plugin Module name or callback that optionally returns a promise\n\t\t */\n\t\taddPlugin: function ( plugin ) {\n\t\t\tplugins.push( plugin );\n\t\t},\n\n\t\t/**\n\t\t * Adjust edit page links in the current document\n\t\t *\n\t\t * This will run multiple times in a page lifecycle, notably when the\n\t\t * page first loads and after post-save content replacement occurs. It\n\t\t * needs to avoid doing anything which will cause problems if it's run\n\t\t * twice or more.\n\t\t */\n\t\tsetupEditLinks: function () {\n\t\t\t// NWE\n\t\t\tif ( init.isWikitextAvailable() && !isOnlyTabVE() ) {\n\t\t\t\t$(\n\t\t\t\t\t// Edit section links, except VE ones when both editors visible\n\t\t\t\t\t'.mw-editsection a:not( .mw-editsection-visualeditor ),' +\n\t\t\t\t\t// Edit tab\n\t\t\t\t\t'#ca-edit a,' +\n\t\t\t\t\t// Add section is currently a wikitext-only feature\n\t\t\t\t\t'#ca-addsection a'\n\t\t\t\t).each( ( i, el ) => {\n\t\t\t\t\tif ( !el.href ) {\n\t\t\t\t\t\t// Not a real link, probably added by a gadget or another extension (T328094)\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst linkUrl = new URL( el.href );\n\t\t\t\t\tif ( linkUrl.searchParams.has( 'action' ) ) {\n\t\t\t\t\t\tlinkUrl.searchParams.delete( 'action' );\n\t\t\t\t\t\tlinkUrl.searchParams.set( 'veaction', 'editsource' );\n\t\t\t\t\t\t// linkUrl is safe\n\t\t\t\t\t\t// eslint-disable-next-line local/no-unsanitized-href\n\t\t\t\t\t\t$( el ).attr( 'href', linkUrl.toString() );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\t// Set up the tabs appropriately if the user has VE on\n\t\t\tif ( init.isAvailable ) {\n\t\t\t\t// … on two-edit-tab wikis, or single-edit-tab wikis, where the user wants both …\n\t\t\t\tif (\n\t\t\t\t\t!init.isSingleEditTab && init.isVisualAvailable() &&\n\t\t\t\t\t// T253941: This option does not actually disable the editor, only leaves the tabs/links unchanged\n\t\t\t\t\t!( conf.disableForAnons && mw.user.isAnon() )\n\t\t\t\t) {\n\t\t\t\t\t// … set the skin up with both tabs and both section edit links.\n\t\t\t\t\tinit.setupMultiTabSkin();\n\t\t\t\t} else if (\n\t\t\t\t\tpageCanLoadEditor && (\n\t\t\t\t\t\t( init.isVisualAvailable() && isOnlyTabVE() ) ||\n\t\t\t\t\t\t( init.isWikitextAvailable() && isOnlyTabWikitext() )\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\t// … on single-edit-tab wikis, where VE or NWE is the user's preferred editor\n\t\t\t\t\t// Handle section edit link clicks\n\t\t\t\t\t$( '.mw-editsection a' ).off( '.ve-target' ).on( 'click.ve-target', ( e ) => {\n\t\t\t\t\t\t// isOnlyTabVE is computed on click as it may have changed since load\n\t\t\t\t\t\tinit.onEditSectionLinkClick( isOnlyTabVE() ? 'visual' : 'source', e );\n\t\t\t\t\t} );\n\t\t\t\t\t// Allow instant switching to edit mode, without refresh\n\t\t\t\t\t$( '#ca-edit' ).off( '.ve-target' ).on( 'click.ve-target', ( e ) => {\n\t\t\t\t\t\tinit.onEditTabClick( isOnlyTabVE() ? 'visual' : 'source', e );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\tif ( !mw.user.isAnon() && pageCanLoadEditor && init.isVisualAvailable() && ( !init.isSingleEditTab || isOnlyTabVE() ) ) {\n\t\t\t\t\t// Show a category-edit link for logged in users who would be given VE if they clicked an \"edit\" link\n\t\t\t\t\t$( '#catlinks' ).prepend(\n\t\t\t\t\t\t$( '<span>' )\n\t\t\t\t\t\t\t.addClass( 've-init-mw-desktopArticleTarget-categoryEdit mw-editsection-like' )\n\t\t\t\t\t\t\t.on( 'click', init.onCategoryEditLinkClick )\n\t\t\t\t\t\t\t.append(\n\t\t\t\t\t\t\t\t$( '<span>' ).addClass( 'mw-editsection-bracket' ).text( '[' ),\n\t\t\t\t\t\t\t\t$( '<a>' ).text( mw.msg( 'editsection' ) ),\n\t\t\t\t\t\t\t\t$( '<span>' ).addClass( 'mw-editsection-bracket' ).text( ']' )\n\t\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Setup multiple edit tabs and section links (edit + edit source)\n\t\t */\n\t\tsetupMultiTabSkin: function () {\n\t\t\tinit.setupMultiTabs();\n\t\t\tinit.setupMultiSectionLinks();\n\t\t},\n\n\t\t/**\n\t\t * Setup multiple edit tabs (edit + edit source)\n\t\t */\n\t\tsetupMultiTabs: function () {\n\t\t\t// Minerva puts the '#ca-...' ids on <a> nodes, other skins put them on <li>\n\t\t\tconst $caEdit = $( '#ca-edit' );\n\t\t\tconst $caVeEdit = $( '#ca-ve-edit' );\n\n\t\t\tif ( pageCanLoadEditor ) {\n\t\t\t\t// Allow instant switching to edit mode, without refresh\n\t\t\t\t$caVeEdit.off( '.ve-target' ).on( 'click.ve-target', init.onEditTabClick.bind( init, 'visual' ) );\n\t\t\t}\n\t\t\tif ( pageCanLoadEditor ) {\n\t\t\t\t// Always bind \"Edit source\" tab, because we want to handle switching with changes\n\t\t\t\t$caEdit.off( '.ve-target' ).on( 'click.ve-target', init.onEditTabClick.bind( init, 'source' ) );\n\t\t\t}\n\t\t\tif ( pageCanLoadEditor && init.isWikitextAvailable() ) {\n\t\t\t\t// Only bind \"Add topic\" tab if NWE is available, because VE doesn't support section\n\t\t\t\t// so we never have to switch from it when editing a section\n\t\t\t\t$( '#ca-addsection' ).off( '.ve-target' ).on( 'click.ve-target', init.onEditTabClick.bind( init, 'source' ) );\n\t\t\t}\n\n\t\t\tif ( init.isVisualAvailable() ) {\n\t\t\t\tif ( conf.tabPosition === 'before' ) {\n\t\t\t\t\t$caEdit.addClass( 'collapsible' );\n\t\t\t\t} else {\n\t\t\t\t\t$caVeEdit.addClass( 'collapsible' );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Setup multiple section links (edit + edit source)\n\t\t */\n\t\tsetupMultiSectionLinks: function () {\n\t\t\tif ( pageCanLoadEditor ) {\n\t\t\t\tconst $editsections = $( '#mw-content-text .mw-editsection' );\n\n\t\t\t\t// Only init without refresh if we're on a view page. Though section edit links\n\t\t\t\t// are rarely shown on non-view pages, they appear in one other case, namely\n\t\t\t\t// when on a diff against the latest version of a page. In that case we mustn't\n\t\t\t\t// init without refresh as that'd initialise for the wrong rev id (T52925)\n\t\t\t\t// and would preserve the wrong DOM with a diff on top.\n\t\t\t\t$editsections.find( '.mw-editsection-visualeditor' )\n\t\t\t\t\t.off( '.ve-target' ).on( 'click.ve-target', init.onEditSectionLinkClick.bind( init, 'visual' ) );\n\t\t\t\tif ( init.isWikitextAvailable() ) {\n\t\t\t\t\t// TOOD: Make this less fragile\n\t\t\t\t\t$editsections.find( 'a:not( .mw-editsection-visualeditor )' )\n\t\t\t\t\t\t.off( '.ve-target' ).on( 'click.ve-target', init.onEditSectionLinkClick.bind( init, 'source' ) );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Check whether a jQuery event represents a plain left click, without\n\t\t * any modifiers or a programmatically triggered click.\n\t\t *\n\t\t * This is a duplicate of a function in ve.utils, because this file runs\n\t\t * before any of VE core or OOui has been loaded.\n\t\t *\n\t\t * @param {jQuery.Event} e\n\t\t * @return {boolean} Whether it was an unmodified left click\n\t\t */\n\t\tisUnmodifiedLeftClick: function ( e ) {\n\t\t\treturn e && ( (\n\t\t\t\te.which && e.which === 1 && !( e.shiftKey || e.altKey || e.ctrlKey || e.metaKey )\n\t\t\t) || e.isTrigger );\n\t\t},\n\n\t\t/**\n\t\t * Handle click events on an edit tab\n\t\t *\n\t\t * @param {string} mode Edit mode, 'visual' or 'source'\n\t\t * @param {Event} e Event\n\t\t */\n\t\tonEditTabClick: function ( mode, e ) {\n\t\t\tif ( !init.isUnmodifiedLeftClick( e ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( !active && mode === 'source' && !init.isWikitextAvailable() ) {\n\t\t\t\t// We're not active so we don't need to manage a switch, and\n\t\t\t\t// we don't have source mode available so we don't need to\n\t\t\t\t// activate VE. Just follow the link.\n\t\t\t\treturn;\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t\tif ( isLoading ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst section = $( e.target ).closest( '#ca-addsection' ).length ? 'new' : null;\n\n\t\t\tif ( active ) {\n\t\t\t\ttargetPromise.then( ( target ) => {\n\t\t\t\t\tif ( target.getDefaultMode() === 'source' ) {\n\t\t\t\t\t\tif ( mode === 'visual' ) {\n\t\t\t\t\t\t\ttarget.switchToVisualEditor();\n\t\t\t\t\t\t} else if ( mode === 'source' ) {\n\t\t\t\t\t\t\t// Requested section may have changed --\n\t\t\t\t\t\t\t// switchToWikitextSection will do nothing if the\n\t\t\t\t\t\t\t// section is unchanged.\n\t\t\t\t\t\t\ttarget.switchToWikitextSection( section );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if ( target.getDefaultMode() === 'visual' ) {\n\t\t\t\t\t\tif ( mode === 'source' ) {\n\t\t\t\t\t\t\tif ( section ) {\n\t\t\t\t\t\t\t\t// switching from visual via the \"add section\" tab\n\t\t\t\t\t\t\t\ttarget.switchToWikitextSection( section );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttarget.editSource();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Visual-to-visual doesn't need to do anything,\n\t\t\t\t\t\t// because we don't have any section concerns. Just\n\t\t\t\t\t\t// no-op it.\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tconst link = $( e.target ).closest( 'a' )[ 0 ];\n\t\t\t\tconst linkUrl = link && link.href ? new URL( link.href ) : undefined;\n\t\t\t\tif ( section !== null ) {\n\t\t\t\t\tinit.activateVe( mode, linkUrl, section );\n\t\t\t\t} else {\n\t\t\t\t\t// Do not pass `section` to handle switching from section editing in WikiEditor if needed\n\t\t\t\t\tinit.activateVe( mode, linkUrl );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Activate VE\n\t\t *\n\t\t * @param {string} mode Target mode: 'visual' or 'source'\n\t\t * @param {URL} [linkUrl] URL to navigate to, potentially with extra parameters\n\t\t * @param {string} [section]\n\t\t */\n\t\tactivateVe: function ( mode, linkUrl, section ) {\n\t\t\tconst wikitext = $( '#wpTextbox1' ).textSelection( 'getContents' ),\n\t\t\t\tmodified = mw.config.get( 'wgAction' ) === 'submit' ||\n\t\t\t\t\t(\n\t\t\t\t\t\tmw.config.get( 'wgAction' ) === 'edit' &&\n\t\t\t\t\t\twikitext !== initialWikitext\n\t\t\t\t\t);\n\n\t\t\tif ( section === undefined ) {\n\t\t\t\tconst sectionVal = $( 'input[name=wpSection]' ).val();\n\t\t\t\tsection = sectionVal !== '' && sectionVal !== undefined ? sectionVal : null;\n\t\t\t}\n\n\t\t\t// Close any open jQuery.UI dialogs (e.g. WikiEditor's find and replace)\n\t\t\tif ( $.fn.dialog ) {\n\t\t\t\t$( '.ui-dialog-content' ).dialog( 'close' );\n\t\t\t}\n\n\t\t\t// Release the edit warning on #wpTextbox1 which was setup in mediawiki.action.edit.editWarning.js\n\t\t\t$( window ).off( 'beforeunload.editwarning' );\n\t\t\tactivatePageTarget( mode, section, modified, linkUrl );\n\t\t},\n\n\t\t/**\n\t\t * Handle section edit links being clicked\n\t\t *\n\t\t * @param {string} mode Edit mode\n\t\t * @param {jQuery.Event} e Click event\n\t\t * @param {string} [section] Override edit section, taken from link URL if not specified\n\t\t */\n\t\tonEditSectionLinkClick: function ( mode, e, section ) {\n\t\t\tconst link = $( e.target ).closest( 'a' )[ 0 ];\n\t\t\tif ( !link || !link.href ) {\n\t\t\t\t// Not a real link, probably added by a gadget or another extension (T328094)\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst linkUrl = new URL( link.href );\n\t\t\tconst title = mw.Title.newFromText( linkUrl.searchParams.get( 'title' ) || '' );\n\n\t\t\tif (\n\t\t\t\t// Modified click (e.g. ctrl+click)\n\t\t\t\t!init.isUnmodifiedLeftClick( e ) ||\n\t\t\t\t// Not an edit action\n\t\t\t\t!( linkUrl.searchParams.has( 'action' ) || linkUrl.searchParams.has( 'veaction' ) ) ||\n\t\t\t\t// Edit target is on another host (e.g. commons file)\n\t\t\t\tlinkUrl.host !== location.host ||\n\t\t\t\t// Title param doesn't match current page\n\t\t\t\ttitle && title.getPrefixedText() !== new mw.Title( mw.config.get( 'wgRelevantPageName' ) ).getPrefixedText()\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t\tif ( isLoading ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttrackActivateStart( { type: 'section', mechanism: section === 'new' ? 'new' : 'click', mode }, linkUrl );\n\n\t\t\tif ( !active ) {\n\t\t\t\t// Replace the current state with one that is tagged as ours, to prevent the\n\t\t\t\t// back button from breaking when used to exit VE. FIXME: there should be a better\n\t\t\t\t// way to do this. See also similar code in the DesktopArticleTarget constructor.\n\t\t\t\thistory.replaceState( { tag: 'visualeditor' }, '', currentUrl );\n\t\t\t\t// Use linkUrl to preserve the 'section' parameter and others like 'editintro' (T56029)\n\t\t\t\thistory.pushState( { tag: 'visualeditor' }, '', linkUrl );\n\t\t\t\t// Update URL instance\n\t\t\t\tcurrentUrl = linkUrl;\n\n\t\t\t\t// Use section from URL\n\t\t\t\tif ( section === undefined ) {\n\t\t\t\t\tsection = getSectionFromUrl( linkUrl );\n\t\t\t\t}\n\t\t\t\tconst tPromise = getTarget( mode, section );\n\t\t\t\tactivateTarget( mode, section, tPromise );\n\t\t\t}\n\t\t},\n\n\t\tonCategoryEditLinkClick: function ( e ) {\n\t\t\tif ( !init.isUnmodifiedLeftClick( e ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t\tif ( isLoading ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// should perhaps have a new 'type' for 'categories' added?\n\t\t\ttrackActivateStart( { type: 'page', mechanism: 'click', mode: 'visual' } );\n\t\t\tif ( currentUrl.searchParams.get( 'action' ) !== 'edit' && !( currentUrl.searchParams.get( 'veaction' ) in veactionToMode ) ) {\n\t\t\t\tif ( history.pushState ) {\n\t\t\t\t\t// Replace the current state with one that is tagged as ours, to prevent the\n\t\t\t\t\t// back button from breaking when used to exit VE. FIXME: there should be a better\n\t\t\t\t\t// way to do this. See also similar code in the DesktopArticleTarget constructor.\n\t\t\t\t\thistory.replaceState( { tag: 'visualeditor' }, document.title, currentUrl );\n\t\t\t\t\t// Set veaction to edit\n\t\t\t\t\thistory.pushState( { tag: 'visualeditor' }, document.title, veEditUrl );\n\t\t\t\t}\n\n\t\t\t\t// Update mw.Uri instance\n\t\t\t\tcurrentUrl = veEditUrl;\n\t\t\t}\n\t\t\tinit.disableWelcomeDialog();\n\t\t\tactivateTarget( 'visual', null, getTarget( 'visual', null ).then( ( target ) => {\n\t\t\t\ttarget.once( 'surfaceReady', () => {\n\t\t\t\t\tconst windowAction = ve.ui.actionFactory.create( 'window', target.getSurface() );\n\t\t\t\t\twindowAction.open( 'meta', { page: 'categories' } );\n\t\t\t\t} );\n\t\t\t\treturn target;\n\t\t\t} ) );\n\t\t},\n\n\t\t/**\n\t\t * Check whether the welcome dialog should be shown.\n\t\t *\n\t\t * The welcome dialog can be disabled in configuration; or by calling disableWelcomeDialog();\n\t\t * or using a query string parameter; or if we've recorded that we've already shown it before\n\t\t * in a user preference, local storage or a cookie.\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tshouldShowWelcomeDialog: function () {\n\t\t\treturn !(\n\t\t\t\t// Disabled in config?\n\t\t\t\t!mw.config.get( 'wgVisualEditorConfig' ).showBetaWelcome ||\n\t\t\t\t// Disabled for the current request?\n\t\t\t\tthis.isWelcomeDialogSuppressed() ||\n\t\t\t\t// Joining a collab session\n\t\t\t\tcurrentUrl.searchParams.has( 'collabSession' ) ||\n\t\t\t\t// Hidden using preferences, local storage or cookie?\n\t\t\t\tcheckPreferenceOrStorage( 'visualeditor-hidebetawelcome', 've-beta-welcome-dialog' )\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Check whether the welcome dialog is temporarily disabled.\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisWelcomeDialogSuppressed: function () {\n\t\t\treturn !!(\n\t\t\t\t// Disabled by calling disableWelcomeDialog()?\n\t\t\t\twelcomeDialogDisabled ||\n\t\t\t\t// Hidden using URL parameter?\n\t\t\t\tnew URL( location.href ).searchParams.has( 'vehidebetadialog' ) ||\n\t\t\t\t// Check for deprecated hidewelcomedialog parameter (T249954)\n\t\t\t\tnew URL( location.href ).searchParams.has( 'hidewelcomedialog' )\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Record that we've already shown the welcome dialog to this user, so that it won't be shown\n\t\t * to them again.\n\t\t *\n\t\t * Uses a preference for logged-in users; uses local storage or a cookie for anonymous users.\n\t\t */\n\t\tstopShowingWelcomeDialog: function () {\n\t\t\tsetPreferenceOrStorage( 'visualeditor-hidebetawelcome', 've-beta-welcome-dialog' );\n\t\t},\n\n\t\t/**\n\t\t * Prevent the welcome dialog from being shown on this page view only.\n\t\t *\n\t\t * Causes shouldShowWelcomeDialog() to return false, but doesn't save anything to preferences\n\t\t * or local storage, so future page views are not affected.\n\t\t */\n\t\tdisableWelcomeDialog: function () {\n\t\t\twelcomeDialogDisabled = true;\n\t\t},\n\n\t\t/**\n\t\t * Check whether the user education popups (ve.ui.MWEducationPopupWidget) should be shown.\n\t\t *\n\t\t * The education popups can be disabled by calling disableWelcomeDialog(), or if we've\n\t\t * recorded that we've already shown it before in a user preference, local storage or a cookie.\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tshouldShowEducationPopups: function () {\n\t\t\treturn !(\n\t\t\t\t// Disabled by calling disableEducationPopups()?\n\t\t\t\teducationPopupsDisabled ||\n\t\t\t\t// Hidden using preferences, local storage, or cookie?\n\t\t\t\tcheckPreferenceOrStorage( 'visualeditor-hideusered', 've-hideusered' )\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Record that we've already shown the education popups to this user, so that it won't be\n\t\t * shown to them again.\n\t\t *\n\t\t * Uses a preference for logged-in users; uses local storage or a cookie for anonymous users.\n\t\t */\n\t\tstopShowingEducationPopups: function () {\n\t\t\tsetPreferenceOrStorage( 'visualeditor-hideusered', 've-hideusered' );\n\t\t},\n\n\t\t/**\n\t\t * Prevent the education popups from being shown on this page view only.\n\t\t *\n\t\t * Causes shouldShowEducationPopups() to return false, but doesn't save anything to\n\t\t * preferences or local storage, so future page views are not affected.\n\t\t */\n\t\tdisableEducationPopups: function () {\n\t\t\teducationPopupsDisabled = true;\n\t\t}\n\t};\n\n\t/**\n\t * Check if a URL doesn't contain any params which would prevent VE from loading, e.g. 'undo'\n\t *\n\t * @param {URL} url\n\t * @return {boolean} URL contains no unsupported params\n\t */\n\tfunction isSupportedEditPage( url ) {\n\t\treturn configData.unsupportedEditParams.every( ( param ) => !url.searchParams.has( param ) );\n\t}\n\n\tinit.isSingleEditTab = conf.useSingleEditTab && tabPreference !== 'multi-tab';\n\n\t// On a view page, extend the current URL so extra parameters are carried over\n\t// On a non-view page, use viewUrl\n\tveEditUrl = new URL( pageCanLoadEditor ? currentUrl : viewUrl );\n\tif ( oldId ) {\n\t\tveEditUrl.searchParams.set( 'oldid', oldId );\n\t}\n\tveEditUrl.searchParams.delete( 'veaction' );\n\tveEditUrl.searchParams.delete( 'action' );\n\tif ( init.isSingleEditTab ) {\n\t\tveEditUrl.searchParams.set( 'action', 'edit' );\n\t\tveEditSourceUrl = veEditUrl;\n\t} else {\n\t\tveEditSourceUrl = new URL( veEditUrl );\n\t\tveEditUrl.searchParams.set( 'veaction', 'edit' );\n\t\tveEditSourceUrl.searchParams.set( 'veaction', 'editsource' );\n\t}\n\n\t// Whether VisualEditor should be available for the current user, page, wiki, mediawiki skin,\n\t// browser etc.\n\tinit.isAvailable = VisualEditorSupportCheck();\n\t// Extensions can disable VE in certain circumstances using the VisualEditorBeforeEditor hook (T174180)\n\n\tconst enabledForUser = (\n\t\t// User has 'visualeditor-enable' preference enabled (for alpha opt-in)\n\t\t// User has 'visualeditor-betatempdisable' preference disabled\n\t\t// User has 'visualeditor-autodisable' preference disabled\n\t\t( conf.enableBetaFeature ? enable : !tempdisable ) && !autodisable\n\t);\n\n\t// Partially duplicated in includes/Services/VisualEditorAvailabilityLookup::isAvailable\n\tinit.isVisualAvailable = ( url = currentUrl ) => (\n\t\tinit.isAvailable &&\n\n\t\t// If forced by the URL parameter, skip the namespace check (T221892) and preference check\n\t\t( url.searchParams.get( 'veaction' ) === 'edit' || (\n\t\t\t// Only in enabled namespaces\n\t\t\tconf.namespaces.includes( new mw.Title( mw.config.get( 'wgRelevantPageName' ) ).getNamespaceId() ) &&\n\n\t\t\t// Enabled per user preferences\n\t\t\tenabledForUser\n\t\t) ) &&\n\n\t\t// Only if the current page isn't using unsupported URL parameters\n\t\tisSupportedEditPage( url ) &&\n\n\t\t// Only for pages with a supported content model\n\t\tObject.prototype.hasOwnProperty.call( conf.contentModels, mw.config.get( 'wgPageContentModel' ) ) &&\n\n\t\t// Adding a section is not supported in visual mode\n\t\tgetSectionFromUrl( url ) !== 'new'\n\t);\n\n\t// Partially duplicated in includes/Hooks.php#isWikitextAvailable\n\tinit.isWikitextAvailable = ( url = currentUrl ) => (\n\t\tinit.isAvailable &&\n\n\t\t// If forced by the URL parameter, skip the checks (T239796)\n\t\t( url.searchParams.get( 'veaction' ) === 'editsource' || (\n\t\t\t// Enabled on site\n\t\t\tconf.enableWikitext &&\n\n\t\t\t// User preference\n\t\t\tmw.user.options.get( 'visualeditor-newwikitext' )\n\t\t) ) &&\n\n\t\t// Only on wikitext pages\n\t\tmw.config.get( 'wgPageContentModel' ) === 'wikitext'\n\t);\n\n\tfunction getAvailableModes() {\n\t\tconst availableModes = [];\n\t\tif ( init.isVisualAvailable() ) {\n\t\t\tavailableModes.push( 'visual' );\n\t\t}\n\t\tif ( init.isWikitextAvailable() ) {\n\t\t\tavailableModes.push( 'source' );\n\t\t}\n\t\treturn availableModes;\n\t}\n\n\t// FIXME: We should do this more elegantly\n\tinit.setEditorPreference = setEditorPreference;\n\n\tinit.updateTabs = updateTabs;\n\n\t// Note: Though VisualEditor itself only needed this exposure for a very small reason\n\t// (namely to access the old init.unsupportedList from the unit tests...) this has become one\n\t// of the nicest ways to easily detect whether the VisualEditor initialisation code is present.\n\t//\n\t// The VE global was once available always, but now that platform integration initialisation\n\t// is properly separated, it doesn't exist until the platform loads VisualEditor core.\n\t//\n\t// Most of mw.libs.ve is considered subject to change and private.  An exception is that\n\t// mw.libs.ve.isVisualAvailable is public, and indicates whether the VE editor itself can be loaded\n\t// on this page. See above for why it may be false.\n\tmw.libs.ve = $.extend( mw.libs.ve || {}, init );\n\n\tif ( init.isVisualAvailable() ) {\n\t\t$( 'html' ).addClass( 've-available' );\n\t} else {\n\t\t$( 'html' ).addClass( 've-not-available' );\n\t\t// Don't return here because we do want the skin setup to consistently happen\n\t\t// for e.g. \"Edit\" > \"Edit source\" even when VE is not available.\n\t}\n\n\t/**\n\t * Get the edit mode for the given URL\n\t *\n\t * @param {URL} url Edit URL\n\t * @return {string|null} 'visual' or 'source', null if the editor is not being loaded\n\t */\n\tfunction getEditModeFromUrl( url ) {\n\t\tif ( mw.config.get( 'wgDiscussionToolsStartNewTopicTool' ) ) {\n\t\t\t// Avoid conflicts with DiscussionTools\n\t\t\treturn null;\n\t\t}\n\t\tif ( isViewPage && init.isAvailable ) {\n\t\t\t// On view pages if veaction is correctly set\n\t\t\tconst mode = veactionToMode[ url.searchParams.get( 'veaction' ) ] ||\n\t\t\t\t// Always load VE visual mode if collabSession is set\n\t\t\t\t( url.searchParams.has( 'collabSession' ) ? 'visual' : null );\n\t\t\tif ( mode && getAvailableModes().includes( mode ) ) {\n\t\t\t\treturn mode;\n\t\t\t}\n\t\t}\n\t\t// Edit pages\n\t\tif ( isEditPage && isSupportedEditPage( url ) ) {\n\t\t\t// User has disabled VE, or we are in view source only mode, or we have landed here with posted data\n\t\t\tif ( !enabledForUser || $( '#ca-viewsource' ).length || mw.config.get( 'wgAction' ) === 'submit' ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn getAvailableEditPageEditor();\n\t\t}\n\t\treturn null;\n\t}\n\n\t$( () => {\n\t\t$targetContainer = $(\n\t\t\tdocument.querySelector( '[data-mw-ve-target-container]' ) ||\n\t\t\tdocument.getElementById( 'content' )\n\t\t);\n\t\tif ( pageCanLoadEditor ) {\n\t\t\t$targetContainer.addClass( 've-init-mw-desktopArticleTarget-targetContainer' );\n\t\t}\n\n\t\tlet showWikitextWelcome = true;\n\t\tconst numEditButtons = $( '#ca-edit, #ca-ve-edit' ).length,\n\t\t\tsection = getSectionFromUrl( currentUrl );\n\n\t\tconst requiredSkinElements =\n\t\t\t$targetContainer.length &&\n\t\t\t$( '#mw-content-text' ).length &&\n\t\t\t// A link to open the editor is technically not necessary if it's going to open itself\n\t\t\t( isEditPage || numEditButtons );\n\n\t\tif ( currentUrl.searchParams.get( 'action' ) === 'edit' && $( '#wpTextbox1' ).length ) {\n\t\t\tinitialWikitext = $( '#wpTextbox1' ).textSelection( 'getContents' );\n\t\t}\n\n\t\tif ( ( init.isVisualAvailable() || init.isWikitextAvailable() ) &&\n\t\t\tpageCanLoadEditor &&\n\t\t\tpageIsProbablyEditable &&\n\t\t\t!requiredSkinElements\n\t\t) {\n\t\t\tmw.log.warn(\n\t\t\t\t'Your skin is incompatible with VisualEditor. ' +\n\t\t\t\t'See https://www.mediawiki.org/wiki/Extension:VisualEditor/Skin_requirements for the requirements.'\n\t\t\t);\n\t\t\t// If the edit buttons are not there it's likely a browser extension or gadget for anonymous user\n\t\t\t// has removed them. We're not interested in errors from this scenario so don't log.\n\t\t\t// If they exist log the error so we can address the problem.\n\t\t\tif ( numEditButtons > 0 ) {\n\t\t\t\tconst err = new Error( 'Incompatible with VisualEditor' );\n\t\t\t\terr.name = 'VeIncompatibleSkinWarning';\n\t\t\t\tmw.errorLogger.logError( err, 'error.visualeditor' );\n\t\t\t}\n\t\t} else if ( init.isAvailable ) {\n\t\t\tconst mode = getEditModeFromUrl( currentUrl );\n\t\t\tif ( mode ) {\n\t\t\t\tshowWikitextWelcome = false;\n\t\t\t\ttrackActivateStart( {\n\t\t\t\t\ttype: section === null ? 'page' : 'section',\n\t\t\t\t\tmechanism: ( section === 'new' || !mw.config.get( 'wgArticleId' ) ) ? 'url-new' : 'url',\n\t\t\t\t\tmode\n\t\t\t\t} );\n\t\t\t\tactivateTarget( mode, section );\n\t\t\t} else if (\n\t\t\t\tinit.isVisualAvailable() &&\n\t\t\t\tpageCanLoadEditor &&\n\t\t\t\tinit.isSingleEditTab\n\t\t\t) {\n\t\t\t\t// In single edit tab mode we never have an edit tab\n\t\t\t\t// with accesskey 'v' so create one\n\t\t\t\t$( document.body ).append(\n\t\t\t\t\t$( '<a>' )\n\t\t\t\t\t\t// veEditUrl is safe\n\t\t\t\t\t\t// eslint-disable-next-line local/no-unsanitized-href\n\t\t\t\t\t\t.attr( { accesskey: mw.msg( 'accesskey-ca-ve-edit' ), href: veEditUrl } )\n\t\t\t\t\t\t// Accesskey fires a click event\n\t\t\t\t\t\t.on( 'click.ve-target', init.onEditTabClick.bind( init, 'visual' ) )\n\t\t\t\t\t\t.addClass( 'oo-ui-element-hidden' )\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Add the switch button to WikiEditor on edit pages\n\t\t\tif (\n\t\t\t\tinit.isVisualAvailable() &&\n\t\t\t\tisEditPage &&\n\t\t\t\t$( '#wpTextbox1' ).length\n\t\t\t) {\n\t\t\t\tmw.loader.load( 'ext.visualEditor.switching' );\n\t\t\t\tmw.hook( 'wikiEditor.toolbarReady' ).add( ( $textarea ) => {\n\t\t\t\t\tmw.loader.using( 'ext.visualEditor.switching' ).then( () => {\n\t\t\t\t\t\tconst showPopup = currentUrl.searchParams.has( 'veswitched' ) && !mw.user.options.get( 'visualeditor-hidesourceswitchpopup' ),\n\t\t\t\t\t\t\ttoolFactory = new OO.ui.ToolFactory(),\n\t\t\t\t\t\t\ttoolGroupFactory = new OO.ui.ToolGroupFactory();\n\n\t\t\t\t\t\ttoolFactory.register( mw.libs.ve.MWEditModeVisualTool );\n\t\t\t\t\t\ttoolFactory.register( mw.libs.ve.MWEditModeSourceTool );\n\t\t\t\t\t\tconst switchToolbar = new OO.ui.Toolbar( toolFactory, toolGroupFactory, {\n\t\t\t\t\t\t\tclasses: [ 've-init-mw-editSwitch' ]\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tswitchToolbar.on( 'switchEditor', ( m ) => {\n\t\t\t\t\t\t\tif ( m === 'visual' ) {\n\t\t\t\t\t\t\t\t$( '#wpTextbox1' ).trigger( 'wikiEditor-switching-visualeditor' );\n\t\t\t\t\t\t\t\tinit.activateVe( 'visual' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tswitchToolbar.setup( [ {\n\t\t\t\t\t\t\tname: 'editMode',\n\t\t\t\t\t\t\ttype: 'list',\n\t\t\t\t\t\t\ticon: 'edit',\n\t\t\t\t\t\t\ttitle: mw.msg( 'visualeditor-mweditmode-tooltip' ),\n\t\t\t\t\t\t\tlabel: mw.msg( 'visualeditor-mweditmode-tooltip' ),\n\t\t\t\t\t\t\tinvisibleLabel: true,\n\t\t\t\t\t\t\tinclude: [ 'editModeVisual', 'editModeSource' ]\n\t\t\t\t\t\t} ] );\n\n\t\t\t\t\t\tconst popup = new mw.libs.ve.SwitchPopupWidget( 'source' );\n\n\t\t\t\t\t\tswitchToolbar.tools.editModeVisual.toolGroup.$element.append( popup.$element );\n\t\t\t\t\t\tswitchToolbar.emit( 'updateState' );\n\n\t\t\t\t\t\t$textarea.wikiEditor( 'addToToolbar', {\n\t\t\t\t\t\t\tsection: 'secondary',\n\t\t\t\t\t\t\tgroup: 'default',\n\t\t\t\t\t\t\ttools: {\n\t\t\t\t\t\t\t\tveEditSwitch: {\n\t\t\t\t\t\t\t\t\ttype: 'element',\n\t\t\t\t\t\t\t\t\telement: switchToolbar.$element\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tpopup.toggle( showPopup );\n\n\t\t\t\t\t\t// Duplicate of this code in ve.init.mw.DesktopArticleTarget.js\n\t\t\t\t\t\t// eslint-disable-next-line no-jquery/no-class-state\n\t\t\t\t\t\tif ( $( '#ca-edit' ).hasClass( 'visualeditor-showtabdialog' ) ) {\n\t\t\t\t\t\t\t$( '#ca-edit' ).removeClass( 'visualeditor-showtabdialog' );\n\t\t\t\t\t\t\t// Set up a temporary window manager\n\t\t\t\t\t\t\tconst windowManager = new OO.ui.WindowManager();\n\t\t\t\t\t\t\t$( OO.ui.getTeleportTarget() ).append( windowManager.$element );\n\t\t\t\t\t\t\tconst editingTabDialog = new mw.libs.ve.EditingTabDialog();\n\t\t\t\t\t\t\twindowManager.addWindows( [ editingTabDialog ] );\n\t\t\t\t\t\t\twindowManager.openWindow( editingTabDialog )\n\t\t\t\t\t\t\t\t.closed.then( ( data ) => {\n\t\t\t\t\t\t\t\t\t// Detach the temporary window manager\n\t\t\t\t\t\t\t\t\twindowManager.destroy();\n\n\t\t\t\t\t\t\t\t\tif ( data && data.action === 'prefer-ve' ) {\n\t\t\t\t\t\t\t\t\t\tlocation.href = veEditUrl;\n\t\t\t\t\t\t\t\t\t} else if ( data && data.action === 'multi-tab' ) {\n\t\t\t\t\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t} );\n\n\t\t\t\t// Remember that the user wanted wikitext, at least this time\n\t\t\t\tmw.libs.ve.setEditorPreference( 'wikitext' );\n\n\t\t\t\t// If the user has loaded WikiEditor, clear any auto-save state they\n\t\t\t\t// may have from a previous VE session\n\t\t\t\t// We don't have access to the VE session storage methods, but invalidating\n\t\t\t\t// the docstate is sufficient to prevent the data from being used.\n\t\t\t\tmw.storage.session.remove( 've-docstate' );\n\t\t\t}\n\n\t\t\tinit.setupEditLinks();\n\t\t}\n\n\t\tif (\n\t\t\tpageCanLoadEditor &&\n\t\t\tshowWikitextWelcome &&\n\t\t\t// At least one editor is available (T201928)\n\t\t\t( init.isVisualAvailable() || init.isWikitextAvailable() || $( '#wpTextbox1' ).length ) &&\n\t\t\tisEditPage &&\n\t\t\tinit.shouldShowWelcomeDialog() &&\n\t\t\t// Not on protected pages\n\t\t\tpageIsProbablyEditable\n\t\t) {\n\t\t\tmw.loader.using( 'ext.visualEditor.welcome' ).then( () => {\n\t\t\t\t// Check shouldShowWelcomeDialog() again: any code that might have called\n\t\t\t\t// stopShowingWelcomeDialog() wouldn't have had an opportunity to do that\n\t\t\t\t// yet by the first time we checked\n\t\t\t\tif ( !init.shouldShowWelcomeDialog() ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst windowManager = new OO.ui.WindowManager();\n\t\t\t\tconst welcomeDialog = new mw.libs.ve.WelcomeDialog();\n\t\t\t\t$( OO.ui.getTeleportTarget() ).append( windowManager.$element );\n\t\t\t\twindowManager.addWindows( [ welcomeDialog ] );\n\t\t\t\twindowManager.openWindow(\n\t\t\t\t\twelcomeDialog,\n\t\t\t\t\t{\n\t\t\t\t\t\tswitchable: init.isVisualAvailable(),\n\t\t\t\t\t\teditor: 'source'\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t\t.closed.then( ( data ) => {\n\t\t\t\t\t\twindowManager.destroy();\n\t\t\t\t\t\tif ( data && data.action === 'switch-ve' ) {\n\t\t\t\t\t\t\tinit.activateVe( 'visual' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\tinit.stopShowingWelcomeDialog();\n\t\t\t} );\n\t\t}\n\n\t\tif ( currentUrl.searchParams.has( 'venotify' ) ) {\n\t\t\tcurrentUrl.searchParams.delete( 'venotify' );\n\t\t\t// Get rid of the ?venotify= from the URL\n\t\t\thistory.replaceState( null, '', currentUrl );\n\t\t}\n\t} );\n}() );\n","{\n    \"unsupportedEditParams\": [\n        \"undo\",\n        \"undoafter\",\n        \"preview\"\n    ]\n}"],
"names": [],
"mappings": "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"
}
},
{"offset":{"line":34,"column":0},"map":{
"version": 3,
"file": "/w/load.php?lang=ru&modules=ext.visualEditor.core.utils.parsing%7Cext.visualEditor.desktopArticleTarget.init%7Cext.visualEditor.progressBarWidget%2CsupportCheck%2CtargetLoader%2CtempWikitextEditorWidget%2Ctrack%2Cve&skin=vector&version=u9zxi",
"sources": ["/w/extensions/VisualEditor/modules/ve-mw/preinit/ve.init.mw.ProgressBarWidget.js"],
"sourcesContent": ["/*!\n * VisualEditor progress bar widget\n *\n * @copyright See AUTHORS.txt\n * @license The MIT License (MIT); see LICENSE.txt\n */\n\nmw.libs.ve = mw.libs.ve || {};\n\n/**\n * Progress bar widget\n *\n * This widget can be used to show a progress bar\n * while VE libraries are still loading.\n *\n * It has a similar API to OO.ui.ProgressBarWidget, but is designed to\n * be loaded before any core VE code or dependencies, e.g. OOUI.\n *\n * @class\n * @constructor\n */\nmw.libs.ve.ProgressBarWidget = function VeUiMwProgressBarWidget() {\n\tthis.progressStep = 0;\n\tthis.progressSteps = [\n\t\t// [ percentage, delay ]\n\t\t[ 30, 3000 ],\n\t\t[ 70, 2000 ],\n\t\t[ 100, 1000 ]\n\t];\n\t// Stylesheets might not have processed yet, so manually set starting width to 0\n\tthis.$bar = $( '<div>' ).addClass( 've-init-mw-progressBarWidget-bar' ).css( 'width', 0 );\n\tthis.$element = $( '<div>' ).addClass( 've-init-mw-progressBarWidget' ).append( this.$bar );\n};\n\nmw.libs.ve.ProgressBarWidget.prototype.setLoadingProgress = function ( target, duration ) {\n\tconst $bar = this.$bar.stop();\n\t$bar.css( 'transition', 'width ' + duration + 'ms ease-in' );\n\tsetTimeout( () => {\n\t\t$bar.css( 'width', target + '%' );\n\t} );\n};\n\nmw.libs.ve.ProgressBarWidget.prototype.incrementLoadingProgress = function () {\n\tconst step = this.progressSteps[ this.progressStep ];\n\tif ( step ) {\n\t\tthis.setLoadingProgress( step[ 0 ], step[ 1 ] );\n\t\tthis.progressStep++;\n\t}\n};\n\nmw.libs.ve.ProgressBarWidget.prototype.clearLoading = function () {\n\tthis.progressStep = 0;\n\tthis.setLoadingProgress( 0, 0 );\n};\n"],
"names": [],
"mappings": "8GAOA,EAAE,CAAC,IAAI,CAAC,EAAG,CAAE,EAAE,CAAC,IAAI,CAAC,EAAG,EAAG,CAAC,CAAC,CAc7B,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,iBAAkB,CAAE,SAAS,uBAAuB,CAAC,CAAE,CACjE,IAAI,CAAC,YAAa,CAAE,CAAC,CACrB,IAAI,CAAC,aAAc,CAAE,CAEpB,CAAE,EAAE,CAAE,IAAK,CAAC,CACZ,CAAE,EAAE,CAAE,IAAK,CAAC,CACZ,CAAE,GAAG,CAAE,IAAK,CACb,CAAC,CAED,IAAI,CAAC,IAAK,CAAE,CAAC,CAAE,OAAQ,CAAC,CAAC,QAAQ,CAAE,kCAAmC,CAAC,CAAC,GAAG,CAAE,OAAO,CAAE,CAAE,CAAC,CACzF,IAAI,CAAC,QAAS,CAAE,CAAC,CAAE,OAAQ,CAAC,CAAC,QAAQ,CAAE,8BAA+B,CAAC,CAAC,MAAM,CAAE,IAAI,CAAC,IAAK,CAAC,CAC5F,CAAC,CAED,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,SAAS,CAAC,kBAAmB,CAAE,QAAS,CAAE,MAAM,CAAE,QAAS,CAAE,CACzF,MAAM,IAAK,CAAE,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAC7B,IAAI,CAAC,GAAG,CAAE,YAAY,CAAE,QAAS,CAAE,QAAS,CAAE,YAAa,CAAC,CAC5D,UAAU,CAAE,CAAC,CAAE,EAAG,CACjB,IAAI,CAAC,GAAG,CAAE,OAAO,CAAE,MAAO,CAAE,GAAI,CAAC,CAClC,CAAE,CAAC,CACJ,CAAC,CAED,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,SAAS,CAAC,wBAAyB,CAAE,QAAS,CAAC,CAAE,CAC7E,MAAM,IAAK,CAAE,IAAI,CAAC,aAAa,CAAE,IAAI,CAAC,YAAa,CAAC,CACpD,EAAG,CAAE,IAAK,CAAE,CACX,IAAI,CAAC,kBAAkB,CAAE,IAAI,CAAE,CAAE,CAAC,CAAE,IAAI,CAAE,CAAE,CAAE,CAAC,CAC/C,IAAI,CAAC,YAAY,EAAE,CACpB,CACD,CAAC,CAED,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAC,SAAS,CAAC,YAAa,CAAE,QAAS,CAAC,CAAE,CACjE,IAAI,CAAC,YAAa,CAAE,CAAC,CACrB,IAAI,CAAC,kBAAkB,CAAE,CAAC,CAAE,CAAE,CAAC,CAChC,CAAC"
}
},
{"offset":{"line":36,"column":0},"map":{
"version": 3,
"file": "/w/load.php?lang=ru&modules=ext.visualEditor.core.utils.parsing%7Cext.visualEditor.desktopArticleTarget.init%7Cext.visualEditor.progressBarWidget%2CsupportCheck%2CtargetLoader%2CtempWikitextEditorWidget%2Ctrack%2Cve&skin=vector&version=u9zxi",
"sources": ["/w/extensions/VisualEditor/lib/ve/src/init/ve.init.SupportCheck.js"],
"sourcesContent": ["/*!\n * VisualEditor initialization support checker.\n *\n * @copyright See AUTHORS.txt\n */\n\n( function () {\n\t/**\n\t * Check whether the environment has the needed features to load VisualEditor.\n\t * This considers every ES5 feature, support for contentEditable itself, those\n\t * specific DOM features we use, and SVG support for the user interface. As we\n\t * use this to check for feature compatibility this file must be ES3-parsable.\n\t *\n\t * @method VisualEditorSupportCheck\n\t * @memberof ve\n\t * @return {boolean} True if the environment should support VisualEditor.\n\t */\n\twindow.VisualEditorSupportCheck = function () {\n\t\treturn (\n\t\t\t/* ES6 */\n\t\t\t( function () {\n\t\t\t\ttry {\n\t\t\t\t\t// eslint-disable-next-line no-new, no-new-func\n\t\t\t\t\tnew Function( '(a = 0) => a' );\n\t\t\t\t\treturn true;\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}() ) &&\n\n\t\t\t/* ES6 RegExp.prototype.flags */\n\t\t\t/./g.flags === 'g' &&\n\n\t\t\t// TODO: Most of the below checks can probably be removed as they are supported in all ES6 browsers.\n\n\t\t\t/* contentEditable */\n\t\t\t!!( 'contentEditable' in document.createElement( 'div' ) ) &&\n\n\t\t\t/* createElementNS */\n\t\t\t!!document.createElementNS &&\n\n\t\t\t/* DOMParser */\n\t\t\t( function () {\n\t\t\t\tlet doc;\n\t\t\t\ttry {\n\t\t\t\t\tdoc = new DOMParser().parseFromString( '<body></body>', 'text/html' );\n\t\t\t\t} catch ( e ) {}\n\t\t\t\treturn doc instanceof HTMLDocument;\n\t\t\t}() ) &&\n\n\t\t\t/* classList */\n\t\t\t!!(\n\t\t\t\t( 'classList' in document.createElement( '_' ) ) ||\n\t\t\t\t( 'classList' in document.createElementNS( 'http://www.w3.org/2000/svg ', 'g' ) )\n\t\t\t) &&\n\n\t\t\t/* SVG */\n\t\t\t!!( 'createSVGRect' in document.createElementNS( 'http://www.w3.org/2000/svg', 'svg' ) )\n\t\t);\n\t};\n}() );\n"],
"names": [],
"mappings": "yGAMA,CAAE,QAAS,CAAC,CAAE,CAWb,MAAM,CAAC,wBAAyB,CAAE,QAAS,CAAC,CAAE,CAC7C,MAAO,CAEN,CAAE,QAAS,CAAC,CAAE,CACb,GAAI,CAEH,IAAI,QAAQ,CAAE,cAAe,CAAC,CAC9B,OAAO,IAAI,CACZ,CAAE,KAAM,CAAE,CAAE,CAAE,CACb,OAAO,KAAK,CACb,CACD,CAAC,CAAC,CAAE,CAAE,EAGN,IAAI,CAAC,KAAM,GAAI,GAAI,EAKnB,CAAC,CAAC,CAAE,iBAAkB,GAAG,QAAQ,CAAC,aAAa,CAAE,KAAM,CAAE,CAAE,EAG3D,CAAC,CAAC,QAAQ,CAAC,eAAgB,EAG3B,CAAE,QAAS,CAAC,CAAE,CACb,IAAI,GAAG,CACP,GAAI,CACH,GAAI,CAAE,IAAI,SAAS,CAAC,CAAC,CAAC,eAAe,CAAE,eAAe,CAAE,WAAY,CAAC,CACtE,CAAE,KAAM,CAAE,CAAE,CAAE,CAAC,CACf,OAAO,IAAI,WAAW,YAAY,CACnC,CAAC,CAAC,CAAE,CAAE,EAGN,CAAC,CAAC,CACD,CAAE,WAAY,GAAG,QAAQ,CAAC,aAAa,CAAE,GAAI,CAAE,CAAE,EACjD,CAAE,WAAY,GAAG,QAAQ,CAAC,eAAe,CAAE,6BAA6B,CAAE,GAAI,CAAE,CACjF,CAAE,EAGF,CAAC,CAAC,CAAE,eAAgB,GAAG,QAAQ,CAAC,eAAe,CAAE,4BAA4B,CAAE,KAAM,CAAE,CACxF,CAAC,CACF,CAAC,CACF,CAAC,CAAC,CAAE,CAAC"
}
},
{"offset":{"line":38,"column":0},"map":{
"version": 3,
"file": "/w/load.php?lang=ru&modules=ext.visualEditor.core.utils.parsing%7Cext.visualEditor.desktopArticleTarget.init%7Cext.visualEditor.progressBarWidget%2CsupportCheck%2CtargetLoader%2CtempWikitextEditorWidget%2Ctrack%2Cve&skin=vector&version=u9zxi",
"sources": ["/w/extensions/VisualEditor/modules/ve-mw/preinit/ve.utils.parsoid.js","/w/extensions/VisualEditor/modules/ve-mw/preinit/ve.utils.client.js","/w/extensions/VisualEditor/modules/ve-mw/preinit/ve.init.mw.ArticleTargetLoader.js","/w/extensions/VisualEditor/modules/ve-mw/preinit/ve.init.mw.ArticleTargetSaver.js"],
"sourcesContent": ["/*!\n * Parsoid utilities.\n *\n * @copyright See AUTHORS.txt\n */\n\nmw.libs.ve = mw.libs.ve || {};\n\n/**\n * Decode a URI component into a mediawiki article title\n *\n * N.B. Illegal article titles can result from fairly reasonable input (e.g. \"100%25beef\");\n * see https://phabricator.wikimedia.org/T137847 .\n *\n * @param {string} s String to decode\n * @param {boolean} [preserveUnderscores=false] Don't convert underscores to spaces\n * @return {string} Decoded string, or original string if decodeURIComponent failed\n */\nmw.libs.ve.decodeURIComponentIntoArticleTitle = function ( s, preserveUnderscores ) {\n\ttry {\n\t\ts = decodeURIComponent( s );\n\t} catch ( e ) {\n\t\treturn s;\n\t}\n\tif ( preserveUnderscores ) {\n\t\treturn s;\n\t}\n\treturn s.replace( /_/g, ' ' );\n};\n\n/**\n * Unwrap Parsoid sections\n *\n * data-mw-section-id attributes are copied to the first child (the heading) during\n * this step so that we can place the cursor in the correct place when section editing.\n * These attributes **must be removed** before being sent back to Parsoid to avoid\n * unnecessary re-serialization.\n *\n * @param {HTMLElement} element Parent element, e.g. document body\n * @param {string} [keepSection] Section to keep\n */\nmw.libs.ve.unwrapParsoidSections = function ( element, keepSection ) {\n\tArray.prototype.forEach.call( element.querySelectorAll( 'section[data-mw-section-id]' ), ( section ) => {\n\t\tconst parent = section.parentNode,\n\t\t\tsectionId = section.getAttribute( 'data-mw-section-id' );\n\t\t// Copy section ID to first child (should be a heading)\n\t\t// Pseudo-sections (with negative section IDs) may not have a heading\n\t\tif ( sectionId !== null && +sectionId > 0 ) {\n\t\t\tsection.firstChild.setAttribute( 'data-mw-section-id', sectionId );\n\t\t}\n\t\tif ( keepSection !== undefined && sectionId === keepSection ) {\n\t\t\treturn;\n\t\t}\n\t\twhile ( section.firstChild ) {\n\t\t\tparent.insertBefore( section.firstChild, section );\n\t\t}\n\t\tparent.removeChild( section );\n\t} );\n};\n\n/**\n * Strip legacy (non-HTML5) IDs; typically found as section IDs inside\n * headings.\n *\n * @param {HTMLElement} element Parent element, e.g. document body\n */\nmw.libs.ve.stripParsoidFallbackIds = function ( element ) {\n\tArray.prototype.forEach.call( element.querySelectorAll( 'span[typeof=\"mw:FallbackId\"][id]:empty' ), ( legacySpan ) => {\n\t\tlegacySpan.parentNode.removeChild( legacySpan );\n\t} );\n};\n\nmw.libs.ve.restbaseIdRegExp = /^mw[a-zA-Z0-9\\-_]{2,6}$/;\n\nmw.libs.ve.stripRestbaseIds = function ( doc ) {\n\tconst restbaseIdRegExp = mw.libs.ve.restbaseIdRegExp;\n\tArray.prototype.forEach.call( doc.querySelectorAll( '[id^=\"mw\"]' ), ( element ) => {\n\t\tif ( restbaseIdRegExp.test( element.id ) ) {\n\t\t\telement.removeAttribute( 'id' );\n\t\t}\n\t} );\n};\n\n/**\n * Re-duplicate deduplicated TemplateStyles, for correct rendering when editing a section or\n * when templates are removed during the edit.\n *\n * @param {HTMLElement} element Parent element, e.g. document body\n */\nmw.libs.ve.reduplicateStyles = function ( element ) {\n\tArray.prototype.forEach.call( element.querySelectorAll( 'link[rel~=\"mw-deduplicated-inline-style\"]' ), ( link ) => {\n\t\tconst href = link.getAttribute( 'href' );\n\t\tif ( !href || !href.startsWith( 'mw-data:' ) ) {\n\t\t\treturn;\n\t\t}\n\t\tconst key = href.slice( 'mw-data:'.length );\n\t\tconst style = element.querySelector( 'style[data-mw-deduplicate=\"' + key + '\"]' );\n\t\tif ( !style ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst newStyle = link.ownerDocument.createElement( 'style' );\n\t\tnewStyle.setAttribute( 'data-mw-deduplicate', key );\n\n\t\t// Copy content from the old `style` node (for rendering)\n\t\tfor ( let i = 0; i < style.childNodes.length; i++ ) {\n\t\t\tnewStyle.appendChild( style.childNodes[ i ].cloneNode( true ) );\n\t\t}\n\t\t// Copy attributes from the old `link` node (for selser)\n\t\tArray.prototype.forEach.call( link.attributes, ( attr ) => {\n\t\t\tif ( attr.name !== 'rel' && attr.name !== 'href' ) {\n\t\t\t\tnewStyle.setAttribute( attr.name, attr.value );\n\t\t\t}\n\t\t} );\n\n\t\tlink.parentNode.replaceChild( newStyle, link );\n\t} );\n\n\tArray.prototype.forEach.call( element.querySelectorAll( 'style[data-mw-deduplicate]:empty' ), ( style ) => {\n\t\tconst key = style.getAttribute( 'data-mw-deduplicate' );\n\t\tconst firstStyle = element.querySelector( 'style[data-mw-deduplicate=\"' + key + '\"]' );\n\t\tif ( !firstStyle || firstStyle === style ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Copy content from the first matching `style` node (for rendering)\n\t\tfor ( let i = 0; i < firstStyle.childNodes.length; i++ ) {\n\t\t\tstyle.appendChild( firstStyle.childNodes[ i ].cloneNode( true ) );\n\t\t}\n\t} );\n};\n\n/**\n * De-duplicate TemplateStyles, like Parsoid does.\n *\n * @param {HTMLElement} element Parent element, e.g. document body\n */\nmw.libs.ve.deduplicateStyles = function ( element ) {\n\t/**\n\t * Check whether `node` is in a fosterable position. (Nodes in these positions may be moved\n\t * elsewhere in the DOM by the HTML5 parsing algorithm, if they don't have the right tag name.)\n\t * https://html.spec.whatwg.org/#appropriate-place-for-inserting-a-node\n\t *\n\t * @private\n\t * @param {Node|null} node\n\t * @return {boolean}\n\t */\n\tfunction isFosterablePosition( node ) {\n\t\tconst fosterablePositions = [ 'table', 'thead', 'tbody', 'tfoot', 'tr' ];\n\t\treturn node && fosterablePositions.includes( node.parentNode.nodeName.toLowerCase() );\n\t}\n\n\tconst styleTagKeys = {};\n\n\tArray.prototype.forEach.call( element.querySelectorAll( 'style[data-mw-deduplicate]' ), ( style ) => {\n\t\tconst key = style.getAttribute( 'data-mw-deduplicate' );\n\n\t\tif ( !styleTagKeys[ key ] ) {\n\t\t\t// Not a dupe\n\t\t\tstyleTagKeys[ key ] = true;\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !isFosterablePosition( style ) ) {\n\t\t\t// Dupe - replace with a placeholder <link> reference\n\t\t\tconst link = style.ownerDocument.createElement( 'link' );\n\t\t\tlink.setAttribute( 'rel', 'mw-deduplicated-inline-style' );\n\t\t\t// eslint-disable-next-line local/no-unsanitized-href\n\t\t\tlink.setAttribute( 'href', 'mw-data:' + key );\n\n\t\t\t// Copy attributes from the old `link` node (for selser)\n\t\t\tArray.prototype.forEach.call( style.attributes, ( attr ) => {\n\t\t\t\tif ( attr.name !== 'rel' && attr.name !== 'data-mw-deduplicate' ) {\n\t\t\t\t\tlink.setAttribute( attr.name, attr.value );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tstyle.parentNode.replaceChild( link, style );\n\t\t} else {\n\t\t\t// Duplicate style tag found in fosterable position.\n\t\t\t// Not deduping it (to avoid corruption when the resulting HTML is parsed: T299767),\n\t\t\t// but emptying out the style tag for consistency with Parsoid.\n\t\t\t// Parsoid says it does this for performance reasons.\n\t\t\tstyle.innerHTML = '';\n\t\t}\n\t} );\n};\n\n/**\n * Fix fragment links which should be relative to the current document\n *\n * This prevents these links from trying to navigate to another page,\n * or open in a new window.\n *\n * Call this after ve.targetLinksToNewWindow, as it removes the target attribute.\n * Call this after LinkCache.styleParsoidElements, as it breaks that method by including the query string.\n *\n * @param {HTMLElement} container Parent element, e.g. document body\n * @param {mw.Title} docTitle Current title, only links to this title will be normalized\n * @param {string} [prefix] Prefix to add to fragment and target ID to avoid collisions\n */\nmw.libs.ve.fixFragmentLinks = function ( container, docTitle, prefix ) {\n\tconst docTitleText = docTitle.getPrefixedText();\n\tprefix = prefix || '';\n\tArray.prototype.forEach.call( container.querySelectorAll( 'a[href*=\"#\"]' ), ( el ) => {\n\t\tlet fragment = null;\n\t\tif ( el.getAttribute( 'href' ).startsWith( '#' ) ) {\n\t\t\t// Legacy parser\n\t\t\tfragment = el.getAttribute( 'href' ).slice( 1 );\n\t\t} else {\n\t\t\t// Parsoid HTML\n\t\t\tconst targetData = mw.libs.ve.getTargetDataFromHref( el.href, el.ownerDocument );\n\n\t\t\tif ( targetData.isInternal ) {\n\t\t\t\tconst title = mw.Title.newFromText( targetData.title );\n\t\t\t\tif ( title && title.getPrefixedText() === docTitleText ) {\n\t\t\t\t\tfragment = new URL( el.href ).hash.slice( 1 );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( fragment !== null ) {\n\t\t\tif ( !fragment ) {\n\t\t\t\t// Special case for empty fragment, even if prefix set\n\t\t\t\tel.setAttribute( 'href', '#' );\n\t\t\t} else {\n\t\t\t\tif ( prefix ) {\n\t\t\t\t\tconst target = container.querySelector( '#' + $.escapeSelector( fragment ) );\n\t\t\t\t\t// There may be multiple links to a specific target, so check the target\n\t\t\t\t\t// hasn't already been fixed (in which case it would be null)\n\t\t\t\t\tif ( target ) {\n\t\t\t\t\t\ttarget.setAttribute( 'id', prefix + fragment );\n\t\t\t\t\t\ttarget.setAttribute( 'data-mw-id-fixed', '' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// This utility doesn't need to enforce href safety, that\n\t\t\t\t// is up to the user when building the DOM nodes originally\n\t\t\t\t// eslint-disable-next-line local/no-unsanitized-href\n\t\t\t\tel.setAttribute( 'href', '#' + prefix + fragment );\n\t\t\t}\n\t\t\tel.removeAttribute( 'target' );\n\t\t}\n\t} );\n\t// Remove any section heading anchors which weren't fixed above (T218492)\n\tArray.prototype.forEach.call( container.querySelectorAll( 'h1, h2, h3, h4, h5, h6' ), ( el ) => {\n\t\tif ( el.hasAttribute( 'id' ) && !el.hasAttribute( 'data-mw-id-fixed' ) ) {\n\t\t\tel.removeAttribute( 'id' );\n\t\t}\n\t} );\n};\n\n/**\n * @typedef {Object} TargetData\n * @memberof mw.libs.ve\n * @property {string} title The title of the internal link (if the href is internal)\n * @property {boolean} isInternal True if the href pointed to the local wiki, false if href is external\n */\n\n/**\n * Parse URL to get title it points to.\n *\n * @param {string} href\n * @param {HTMLDocument} doc Document whose base URL to use\n * @return {mw.libs.ve.TargetData} Information about the given href\n */\nmw.libs.ve.getTargetDataFromHref = function ( href, doc ) {\n\tfunction regexEscape( str ) {\n\t\treturn str.replace( /([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1' );\n\t}\n\n\tfunction returnExternalData() {\n\t\treturn { isInternal: false };\n\t}\n\n\tfunction returnInternalData( titleish ) {\n\t\t// This value doesn't necessarily come from Parsoid (and it might not have the \"./\" prefix), but\n\t\t// this method will work fine.\n\t\tconst data = mw.libs.ve.parseParsoidResourceName( titleish );\n\t\tdata.isInternal = true;\n\t\treturn data;\n\t}\n\n\tlet url;\n\ttry {\n\t\turl = new URL( href, doc.baseURI );\n\t} catch ( e ) {\n\t\t// An invalid URL was provided (e.g. `https://`)\n\t\treturn returnExternalData();\n\t}\n\n\t// Equivalent to `ve.init.platform.getExternalLinkUrlProtocolsRegExp()`, which can not be called here\n\tconst externalLinkUrlProtocolsRegExp = new RegExp( '^(' + mw.config.get( 'wgUrlProtocols' ) + ')', 'i' );\n\t// We don't want external links that don't start with a registered external URL protocol\n\t// (to avoid generating 'javascript:' URLs), so treat it as internal\n\tif ( !externalLinkUrlProtocolsRegExp.test( url.toString() ) ) {\n\t\treturn returnInternalData( url.toString() );\n\t}\n\n\t// Strip red link query parameters\n\tif ( url.searchParams.get( 'action' ) === 'edit' && url.searchParams.get( 'redlink' ) === '1' ) {\n\t\turl.searchParams.delete( 'action' );\n\t\turl.searchParams.delete( 'redlink' );\n\t}\n\t// Count remaining query parameters\n\tconst keys = [];\n\turl.searchParams.forEach( ( val, key ) => {\n\t\tkeys.push( key );\n\t} );\n\tconst queryLength = keys.length;\n\n\tconst relativeHref = url.toString().replace( /^https?:/i, '' );\n\t// Check if this matches the server's script path (as used by red links)\n\tconst scriptBase = new URL( mw.config.get( 'wgScript' ), doc.baseURI ).toString().replace( /^https?:/i, '' );\n\tif ( relativeHref.startsWith( scriptBase ) ) {\n\t\tif ( queryLength === 1 && url.searchParams.get( 'title' ) ) {\n\t\t\treturn returnInternalData( url.searchParams.get( 'title' ) + url.hash );\n\t\t}\n\t}\n\n\t// Check if this matches the server's article path\n\tconst articleBase = new URL( mw.config.get( 'wgArticlePath' ), doc.baseURI ).toString().replace( /^https?:/i, '' );\n\tconst articleBaseRegex = new RegExp( regexEscape( articleBase ).replace( regexEscape( '$1' ), '(.*)' ) );\n\tconst matches = relativeHref.match( articleBaseRegex );\n\tif ( matches ) {\n\t\tif ( queryLength === 0 && matches && !matches[ 1 ].split( '#' )[ 0 ].includes( '?' ) ) {\n\t\t\t// Take the relative path\n\t\t\treturn returnInternalData( matches[ 1 ] );\n\t\t}\n\t}\n\n\t// Doesn't match any of the known URL patterns, or has extra parameters\n\treturn returnExternalData();\n};\n\n/**\n * Encode a page title into a Parsoid resource name.\n *\n * @param {string} title\n * @return {string}\n */\nmw.libs.ve.encodeParsoidResourceName = function ( title ) {\n\t// Parsoid: Sanitizer::sanitizeTitleURI, Env::makeLink\n\tconst idx = title.indexOf( '#' );\n\tlet anchor = null;\n\tif ( idx !== -1 ) {\n\t\tanchor = title.slice( idx + 1 );\n\t\ttitle = title.slice( 0, idx );\n\t}\n\tlet encodedTitle = title.replace( /[%? [\\]#|<>]/g, ( match ) => mw.util.wikiUrlencode( match ) );\n\tif ( anchor !== null ) {\n\t\tencodedTitle += '#' + mw.util.escapeIdForLink( anchor );\n\t}\n\treturn './' + encodedTitle;\n};\n\n/**\n * @typedef ParsedResource\n * @memberof mw.libs.ve\n * @property {string} title Full page title in text form (with namespace, and spaces instead of underscores)\n */\n\n/**\n * Split Parsoid resource name into the href prefix and the page title.\n *\n * @param {string} resourceName Resource name, from a `href` or `resource` attribute\n * @return {mw.libs.ve.ParsedResource} Parsed resource name\n */\nmw.libs.ve.parseParsoidResourceName = function ( resourceName ) {\n\t// Resource names are always prefixed with './' to prevent the MediaWiki namespace from being\n\t// interpreted as a URL protocol, consider e.g. 'href=\"./File:Foo.png\"'.\n\t// (We accept input without the prefix, so this can also take plain page titles.)\n\tconst matches = resourceName.match( /^(\\.\\/|)(.*)$/ );\n\treturn {\n\t\t// '%' and '?' are valid in page titles, but normally URI-encoded. This also changes underscores\n\t\t// to spaces.\n\t\ttitle: mw.libs.ve.decodeURIComponentIntoArticleTitle( matches[ 2 ] )\n\t};\n};\n\n/**\n * Extract the page title from a Parsoid resource name.\n *\n * @param {string} resourceName Resource name, from a `href` or `resource` attribute\n * @return {string} Full page title in text form (with namespace, and spaces instead of underscores)\n */\nmw.libs.ve.normalizeParsoidResourceName = function ( resourceName ) {\n\treturn mw.libs.ve.parseParsoidResourceName( resourceName ).title;\n};\n","/*!\n * Pre-init client utilities.\n *\n * @copyright See AUTHORS.txt\n */\n\nmw.libs.ve = mw.libs.ve || {};\n\n/**\n * Smoothly scroll the window to a specific vertical position\n *\n * @param {number} scrollTop Vertical position to scroll to\n */\nmw.libs.ve.smoothScrollTo = function ( scrollTop ) {\n\t// Support for CSS `scroll-behavior: smooth;` and JS `window.scroll( { behavior: 'smooth' } )`\n\t// is correlated:\n\t// * https://caniuse.com/css-scroll-behavior\n\t// * https://caniuse.com/mdn-api_window_scroll_options_behavior_parameter\n\tconst supportsSmoothScroll = 'scrollBehavior' in document.documentElement.style;\n\tif ( supportsSmoothScroll ) {\n\t\twindow.scroll( {\n\t\t\ttop: scrollTop,\n\t\t\tbehavior: 'smooth'\n\t\t} );\n\t} else {\n\t\t// Support: Safari < 15.4, Chrome < 61\n\t\tlet scrollContainer;\n\t\tif ( OO && OO.ui ) {\n\t\t\t// Use getRootScrollableElement if OOUI has loaded\n\t\t\t// Support: Chrome < 60\n\t\t\tscrollContainer = OO.ui.Element.static.getRootScrollableElement( document.body );\n\t\t} else {\n\t\t\tscrollContainer = document.documentElement;\n\t\t}\n\n\t\t$( scrollContainer ).animate( { scrollTop } );\n\t}\n};\n","/*!\n * VisualEditor MediaWiki ArticleTargetLoader.\n *\n * @copyright See AUTHORS.txt\n * @license The MIT License (MIT); see LICENSE.txt\n */\n\n// TODO: ve.now and ve.track should be moved to mw.libs.ve\n/* global ve */\n\n/**\n * Target loader.\n *\n * Light-weight loader that loads ResourceLoader modules for VisualEditor\n * and HTML and page data from the API. Also handles plugin registration.\n *\n * @class mw.libs.ve.targetLoader\n * @singleton\n * @hideconstructor\n */\n( function () {\n\tmw.libs.ve = mw.libs.ve || {};\n\n\tconst conf = mw.config.get( 'wgVisualEditorConfig' ),\n\t\tpluginCallbacks = [],\n\t\tmodules = [\n\t\t\t'ext.visualEditor.articleTarget',\n\t\t\t// Add modules from $wgVisualEditorPluginModules\n\t\t\t...conf.pluginModules.filter( mw.loader.getState )\n\t\t];\n\n\tconst url = new URL( location.href );\n\n\tmw.libs.ve.initialUrl = url;\n\n\t// Provide the new wikitext editor\n\tif (\n\t\tmw.user.options.get( 'visualeditor-newwikitext' ) ||\n\t\turl.searchParams.get( 'veaction' ) === 'editsource'\n\t) {\n\t\tmodules.push( 'ext.visualEditor.mwwikitext' );\n\t}\n\n\t// Collab\n\tif (\n\t\tmw.user.options.get( 'visualeditor-collab' ) ||\n\t\turl.searchParams.has( 'collabSession' )\n\t) {\n\t\tmodules.push( 'ext.visualEditor.collab' );\n\t}\n\n\t// A/B test enrollment for edit check (T389231)\n\t// Note: this happens here rather than inside editcheck so that the bucket will\n\t// get logged for EditAttemptStep init events\n\tif ( conf.editCheck && conf.editCheckABTest ) {\n\t\tlet inABTest;\n\t\tif ( mw.user.isAnon() ) {\n\t\t\t// can't just use mw.user.sessionId() because we need this to last across sessions\n\t\t\tconst token = mw.cookie.get( 'VEECid', '', mw.user.generateRandomSessionId() );\n\t\t\t// Store the token so our state is consistent across pages\n\t\t\tmw.cookie.set( 'VEECid', token, { path: '/', expires: 90 * 86400, prefix: '' } );\n\t\t\tinABTest = parseInt( token.slice( 0, 8 ), 16 ) % 2 === 1;\n\t\t} else {\n\t\t\tinABTest = mw.user.getId() % 2 === 1;\n\t\t}\n\t\tconf.editCheckABTestGroup = inABTest ? 'test' : 'control';\n\t\t// Communicate the bucket to instrumentation:\n\t\tmw.config.set(\n\t\t\t'wgVisualEditorEditCheckABTestBucket',\n\t\t\t'2025-09-editcheck-' + conf.editCheckABTest + '-' + ( inABTest ? 'test' : 'control' )\n\t\t);\n\t}\n\n\tconst editCheck = conf.editCheck || !!url.searchParams.get( 'ecenable' ) || !!window.MWVE_FORCE_EDIT_CHECK_ENABLED;\n\tif ( conf.editCheckTagging || editCheck ) {\n\t\tmodules.push( 'ext.visualEditor.editCheck' );\n\t}\n\n\tconst namespaces = mw.config.get( 'wgNamespaceIds' );\n\t// Load signature tool if *any* namespace supports it.\n\t// It will be shown disabled on namespaces that don't support it.\n\tif (\n\t\tObject.keys( namespaces ).some( ( name ) => mw.Title.wantSignaturesNamespace( namespaces[ name ] ) )\n\t) {\n\t\tmodules.push( 'ext.visualEditor.mwsignature' );\n\t}\n\n\tmw.libs.ve.targetLoader = {\n\t\t/**\n\t\t * Add a plugin module or callback.\n\t\t *\n\t\t * If a module name is passed, that module will be loaded alongside the other modules.\n\t\t *\n\t\t * If a callback is passed, it will be executed after the modules have loaded. The callback\n\t\t * may optionally return a jQuery.Promise; if it does, loading won't be complete until\n\t\t * that promise is resolved.\n\t\t *\n\t\t * @param {string|Function} plugin Plugin module name or callback\n\t\t */\n\t\taddPlugin: function ( plugin ) {\n\t\t\tif ( typeof plugin === 'string' ) {\n\t\t\t\tmodules.push( plugin );\n\t\t\t} else {\n\t\t\t\tpluginCallbacks.push( plugin );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Load modules needed for VisualEditor, as well as plugins.\n\t\t *\n\t\t * This loads the base VE modules as well as any registered plugin modules.\n\t\t * Once those are loaded, any registered plugin callbacks are executed,\n\t\t * and we wait for all promises returned by those callbacks to resolve.\n\t\t *\n\t\t * @param {string} mode Initial editor mode, for tracking\n\t\t * @return {jQuery.Promise} Promise resolved when the loading process is complete\n\t\t */\n\t\tloadModules: function ( mode ) {\n\t\t\tmw.hook( 've.loadModules' ).fire( this.addPlugin.bind( this ) );\n\t\t\tve.track( 'trace.moduleLoad.enter', { mode } );\n\t\t\treturn mw.loader.using( modules )\n\t\t\t\t.then( () => {\n\t\t\t\t\tve.track( 'trace.moduleLoad.exit', { mode } );\n\t\t\t\t\tpluginCallbacks.push( ve.init.platform.getInitializedPromise.bind( ve.init.platform ) );\n\t\t\t\t\t// Execute plugin callbacks and collect promises\n\t\t\t\t\treturn $.when( ...pluginCallbacks.map( ( callback ) => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\treturn callback();\n\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\tmw.log.warn( 'Failed to load VE plugin:', e );\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\t\t\t\t\t} ) );\n\t\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * Creates an OOUI checkbox inside an inline field layout\n\t\t *\n\t\t * @param {Object[]} checkboxesDef Checkbox definitions from the API\n\t\t * @param {Object} [widgetConfig] Additional widget config\n\t\t * @return {Object} Result object with checkboxFields (OO.ui.FieldLayout[]) and\n\t\t *  checkboxesByName (keyed object of OO.ui.CheckboxInputWidget).\n\t\t */\n\t\tcreateCheckboxFields: function ( checkboxesDef, widgetConfig ) {\n\t\t\tconst checkboxFields = [],\n\t\t\t\tcheckboxesByName = {};\n\n\t\t\tif ( checkboxesDef ) {\n\t\t\t\tObject.keys( checkboxesDef ).forEach( ( name ) => {\n\t\t\t\t\tconst options = checkboxesDef[ name ];\n\t\t\t\t\tlet accessKey = null,\n\t\t\t\t\t\ttitle = null;\n\n\t\t\t\t\t// The messages documented below are just the ones defined in core.\n\t\t\t\t\t// Extensions may add other checkboxes.\n\t\t\t\t\tif ( options.tooltip ) {\n\t\t\t\t\t\t// The following messages are used here:\n\t\t\t\t\t\t// * accesskey-minoredit\n\t\t\t\t\t\t// * accesskey-watch\n\t\t\t\t\t\taccessKey = mw.message( 'accesskey-' + options.tooltip ).text();\n\t\t\t\t\t\t// The following messages are used here:\n\t\t\t\t\t\t// * tooltip-minoredit\n\t\t\t\t\t\t// * tooltip-watch\n\t\t\t\t\t\ttitle = mw.message( 'tooltip-' + options.tooltip ).text();\n\t\t\t\t\t}\n\t\t\t\t\tif ( options[ 'title-message' ] ) {\n\t\t\t\t\t\t// Not used in core\n\t\t\t\t\t\t// eslint-disable-next-line mediawiki/msg-doc\n\t\t\t\t\t\ttitle = mw.message( options[ 'title-message' ] ).text();\n\t\t\t\t\t}\n\t\t\t\t\t// The following messages are used here:\n\t\t\t\t\t// * minoredit\n\t\t\t\t\t// * watchthis\n\t\t\t\t\tconst $label = mw.message( options[ 'label-message' ] ).parseDom();\n\n\t\t\t\t\tconst config = $.extend( {\n\t\t\t\t\t\taccessKey,\n\t\t\t\t\t\t// The following classes are used here:\n\t\t\t\t\t\t// * ve-ui-mwSaveDialog-checkbox-wpMinoredit\n\t\t\t\t\t\t// * ve-ui-mwSaveDialog-checkbox-wpWatchthis\n\t\t\t\t\t\t// * ve-ui-mwSaveDialog-checkbox-wpWatchlistExpiry\n\t\t\t\t\t\tclasses: [ 've-ui-mwSaveDialog-checkbox-' + name ]\n\t\t\t\t\t}, widgetConfig );\n\n\t\t\t\t\tlet checkbox;\n\t\t\t\t\tswitch ( options.class ) {\n\t\t\t\t\t\tcase 'OOUI\\\\DropdownInputWidget':\n\t\t\t\t\t\t\tcheckbox = new OO.ui.DropdownInputWidget( $.extend( config, {\n\t\t\t\t\t\t\t\tvalue: options.default,\n\t\t\t\t\t\t\t\toptions: options.options\n\t\t\t\t\t\t\t} ) );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tcheckbox = new OO.ui.CheckboxInputWidget( $.extend( config, {\n\t\t\t\t\t\t\t\tselected: options.default\n\t\t\t\t\t\t\t} ) );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcheckboxFields.push(\n\t\t\t\t\t\tnew OO.ui.FieldLayout( checkbox, {\n\t\t\t\t\t\t\talign: 'inline',\n\t\t\t\t\t\t\tlabel: $label,\n\t\t\t\t\t\t\ttitle,\n\t\t\t\t\t\t\tinvisibleLabel: !!options.invisibleLabel,\n\t\t\t\t\t\t\t// * ve-ui-mwSaveDialog-field-wpMinoredit\n\t\t\t\t\t\t\t// * ve-ui-mwSaveDialog-field-wpWatchthis\n\t\t\t\t\t\t\t// * ve-ui-mwSaveDialog-field-wpWatchlistExpiry\n\t\t\t\t\t\t\tclasses: [ 've-ui-mwSaveDialog-field-' + name ]\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\t\t\t\t\tcheckboxesByName[ name ] = checkbox;\n\t\t\t\t} );\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tcheckboxFields,\n\t\t\t\tcheckboxesByName\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Request the page data and various metadata from the MediaWiki API (which will use\n\t\t * Parsoid or RESTBase).\n\t\t *\n\t\t * @param {string} mode Target mode: 'visual' or 'source'\n\t\t * @param {string} pageName Page name to request, in prefixed DB key form (underscores instead of spaces)\n\t\t * @param {Object} [options]\n\t\t * @param {boolean} [options.sessionStore] Store result in session storage (by page+mode+section) for auto-save\n\t\t * @param {null|string} [options.section] Section to edit; number, 'T-'-prefixed, null or 'new' (currently just source mode)\n\t\t * @param {number} [options.oldId] Old revision ID. Current if omitted.\n\t\t * @param {string} [options.targetName] Optional target name for tracking\n\t\t * @param {boolean} [options.modified] The page has been modified before loading (e.g. in source mode)\n\t\t * @param {string} [options.wikitext] Wikitext to convert to HTML. The original document is fetched if undefined.\n\t\t * @param {string} [options.editintro] Name of a page to use as edit intro message\n\t\t * @param {string} [options.preload] Name of a page to use as preloaded content if pageName is empty\n\t\t * @param {string[]} [options.preloadparams] Parameters to substitute into preload if it's used\n\t\t * @return {jQuery.Promise} Abortable promise resolved with a JSON object\n\t\t */\n\t\trequestPageData: function ( mode, pageName, options = {} ) {\n\t\t\tif ( mode === 'visual' && options.section === 'new' ) {\n\t\t\t\tthrow new Error( 'Adding new section is not supported in visual mode' );\n\t\t\t}\n\t\t\tconst apiRequest = mode === 'source' ?\n\t\t\t\tthis.requestWikitext.bind( this, pageName, options ) :\n\t\t\t\tthis.requestParsoidData.bind( this, pageName, options );\n\n\t\t\tif ( options.sessionStore ) {\n\t\t\t\tlet sessionState;\n\t\t\t\ttry {\n\t\t\t\t\t// ve.init.platform.getSessionObject is not available yet\n\t\t\t\t\tsessionState = JSON.parse( mw.storage.session.get( 've-docstate' ) );\n\t\t\t\t} catch ( e ) {}\n\n\t\t\t\tif ( sessionState ) {\n\t\t\t\t\tconst request = sessionState.request || {};\n\t\t\t\t\t// Check true section editing is in use\n\t\t\t\t\tconst enableVisualSectionEditing = conf.enableVisualSectionEditing;\n\t\t\t\t\tconst section = request.mode === 'source' || enableVisualSectionEditing === true || enableVisualSectionEditing === options.targetName ?\n\t\t\t\t\t\toptions.section : null;\n\t\t\t\t\t// Check the requested page, mode and section match the stored one\n\t\t\t\t\tif (\n\t\t\t\t\t\trequest.pageName === pageName &&\n\t\t\t\t\t\trequest.mode === mode &&\n\t\t\t\t\t\trequest.section === section\n\t\t\t\t\t\t// NB we don't cache by oldid so that cached results can be recovered\n\t\t\t\t\t\t// even if the page has been since edited\n\t\t\t\t\t) {\n\t\t\t\t\t\tconst dataPromise = $.Deferred().resolve( {\n\t\t\t\t\t\t\tvisualeditor: $.extend(\n\t\t\t\t\t\t\t\t{ content: mw.storage.session.get( 've-dochtml' ) },\n\t\t\t\t\t\t\t\tsessionState.response,\n\t\t\t\t\t\t\t\t{ recovered: true }\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t} ).promise();\n\t\t\t\t\t\t// If the document hasn't been edited since the user first loaded it, recover\n\t\t\t\t\t\t// their changes automatically.\n\t\t\t\t\t\tif ( sessionState.response.oldid === mw.config.get( 'wgCurRevisionId' ) ) {\n\t\t\t\t\t\t\treturn dataPromise;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Otherwise, prompt them if they want to recover, or reload the document\n\t\t\t\t\t\t\t// to see the latest version\n\t\t\t\t\t\t\t// This prompt will throw off all of our timing data, so just disable tracking\n\t\t\t\t\t\t\t// for this session\n\t\t\t\t\t\t\tve.track = function () {};\n\t\t\t\t\t\t\treturn mw.loader.using( 'oojs-ui-windows' ).then( () => OO.ui.confirm( mw.msg( 'visualeditor-autosave-modified-prompt-message' ), {\n\t\t\t\t\t\t\t\ttitle: mw.msg( 'visualeditor-autosave-modified-prompt-title' ),\n\t\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t\t{ action: 'accept', label: mw.msg( 'visualeditor-autosave-modified-prompt-accept' ), flags: [ 'primary', 'progressive' ] },\n\t\t\t\t\t\t\t\t\t{ action: 'reject', label: mw.msg( 'visualeditor-autosave-modified-prompt-reject' ), flags: 'destructive' }\n\t\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\t).then( ( confirmed ) => {\n\t\t\t\t\t\t\t\tif ( confirmed ) {\n\t\t\t\t\t\t\t\t\treturn dataPromise;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// If they requested the latest version, invalidate the autosave state\n\t\t\t\t\t\t\t\t\tmw.storage.session.remove( 've-docstate' );\n\t\t\t\t\t\t\t\t\treturn apiRequest();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn apiRequest();\n\t\t},\n\n\t\t/**\n\t\t * Request the page HTML and various metadata from the MediaWiki API (which will use\n\t\t * Parsoid or RESTBase).\n\t\t *\n\t\t * @param {string} pageName See #requestPageData\n\t\t * @param {Object} [options] See #requestPageData\n\t\t * @param {boolean} [noRestbase=false] Don't query RESTBase directly\n\t\t * @param {boolean} [noMetadata=false] Don't fetch document metadata when querying RESTBase. Metadata\n\t\t *  is not required for some use cases, e.g. diffing.\n\t\t * @return {jQuery.Promise} Abortable promise resolved with a JSON object\n\t\t */\n\t\trequestParsoidData: function ( pageName, options = {}, noRestbase = false, noMetadata = false ) {\n\t\t\tconst section = options.section !== undefined ? options.section : null,\n\t\t\t\tuseRestbase = !noRestbase && ( conf.fullRestbaseUrl || conf.restbaseUrl ) && section === null;\n\n\t\t\tconst data = {\n\t\t\t\taction: 'visualeditor',\n\t\t\t\tpaction: useRestbase ? 'metadata' : 'parse',\n\t\t\t\tpage: pageName,\n\t\t\t\tbadetag: options.badetag,\n\t\t\t\tuselang: mw.config.get( 'wgUserLanguage' ),\n\t\t\t\teditintro: options.editintro,\n\t\t\t\tpreload: options.preload,\n\t\t\t\tpreloadparams: options.preloadparams,\n\t\t\t\tformatversion: 2\n\t\t\t};\n\n\t\t\t// Only request the API to explicitly load the currently visible revision if we're restoring\n\t\t\t// from oldid. Otherwise we should load the latest version. This prevents us from editing an\n\t\t\t// old version if an edit was made while the user was viewing the page and/or the user is\n\t\t\t// seeing (slightly) stale cache.\n\t\t\tif ( options.oldId !== undefined ) {\n\t\t\t\tdata.oldid = options.oldId;\n\t\t\t}\n\t\t\t// Load DOM\n\t\t\tconst start = ve.now();\n\t\t\tve.track( 'trace.apiLoad.enter', { mode: 'visual' } );\n\n\t\t\tlet apiXhr, apiPromise;\n\t\t\tlet switched = false,\n\t\t\t\tfromEditedState = false;\n\t\t\tif ( !useRestbase && options.wikitext !== undefined ) {\n\t\t\t\t// Non-RESTBase custom wikitext parse\n\t\t\t\tdata.paction = 'parse';\n\t\t\t\tdata.stash = true;\n\t\t\t\tswitched = true;\n\t\t\t\tfromEditedState = options.modified;\n\t\t\t\tdata.wikitext = options.wikitext;\n\t\t\t\tdata.section = options.section;\n\t\t\t\tdata.oldid = options.oldId;\n\t\t\t\tapiXhr = new mw.Api().post( data );\n\t\t\t} else {\n\t\t\t\tif ( useRestbase && noMetadata ) {\n\t\t\t\t\tapiPromise = $.Deferred().resolve( { visualeditor: {} } ).promise();\n\t\t\t\t} else {\n\t\t\t\t\tapiXhr = new mw.Api().get( data );\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( !apiPromise ) {\n\t\t\t\tapiPromise = apiXhr.then( ( response ) => {\n\t\t\t\t\tve.track( 'trace.apiLoad.exit', { mode: 'visual' } );\n\t\t\t\t\tmw.track( 'timing.ve.' + options.targetName + '.performance.system.apiLoad',\n\t\t\t\t\t\tve.now() - start );\n\t\t\t\t\tif ( response.visualeditor ) {\n\t\t\t\t\t\tresponse.visualeditor.switched = switched;\n\t\t\t\t\t\tresponse.visualeditor.fromEditedState = fromEditedState;\n\t\t\t\t\t}\n\t\t\t\t\treturn response;\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tlet dataPromise, abort;\n\t\t\tif ( useRestbase ) {\n\t\t\t\tve.track( 'trace.restbaseLoad.enter', { mode: 'visual' } );\n\n\t\t\t\tconst headers = {\n\t\t\t\t\t// Should be synchronised with DirectParsoidClient.php\n\t\t\t\t\tAccept: 'text/html; charset=utf-8; profile=\"https://www.mediawiki.org/wiki/Specs/HTML/2.8.0\"',\n\t\t\t\t\t'Accept-Language': mw.config.get( 'wgVisualEditor' ).pageLanguageCode,\n\t\t\t\t\t'Api-User-Agent': 'VisualEditor-MediaWiki/' + mw.config.get( 'wgVersion' )\n\t\t\t\t};\n\n\t\t\t\tlet restbaseXhr, pageHtmlUrl;\n\t\t\t\t// Convert specified Wikitext to HTML\n\t\t\t\tif (\n\t\t\t\t\t// wikitext can be an empty string\n\t\t\t\t\toptions.wikitext !== undefined &&\n\t\t\t\t\t// eslint-disable-next-line no-jquery/no-global-selector\n\t\t\t\t\t!$( '[name=wpSection]' ).val()\n\t\t\t\t) {\n\t\t\t\t\tif ( conf.fullRestbaseUrl ) {\n\t\t\t\t\t\tpageHtmlUrl = conf.fullRestbaseUrl + 'v1/transform/wikitext/to/html/';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpageHtmlUrl = conf.restbaseUrl.replace( 'v1/page/html/', 'v1/transform/wikitext/to/html/' );\n\t\t\t\t\t}\n\t\t\t\t\tswitched = true;\n\t\t\t\t\tfromEditedState = options.modified;\n\t\t\t\t\twindow.onbeforeunload = null;\n\t\t\t\t\t$( window ).off( 'beforeunload' );\n\t\t\t\t\trestbaseXhr = $.ajax( {\n\t\t\t\t\t\turl: pageHtmlUrl + encodeURIComponent( pageName ) +\n\t\t\t\t\t\t\t( data.oldid === undefined ? '' : '/' + data.oldid ),\n\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\ttitle: pageName,\n\t\t\t\t\t\t\twikitext: options.wikitext,\n\t\t\t\t\t\t\tstash: 'true'\n\t\t\t\t\t\t},\n\t\t\t\t\t\theaders,\n\t\t\t\t\t\tdataType: 'text'\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\t// Fetch revision\n\t\t\t\t\tif ( conf.fullRestbaseUrl ) {\n\t\t\t\t\t\tpageHtmlUrl = conf.fullRestbaseUrl + 'v1/page/html/';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpageHtmlUrl = conf.restbaseUrl;\n\t\t\t\t\t}\n\t\t\t\t\trestbaseXhr = $.ajax( {\n\t\t\t\t\t\turl: pageHtmlUrl + encodeURIComponent( pageName ) +\n\t\t\t\t\t\t\t( data.oldid === undefined ? '' : '/' + data.oldid ) +\n\t\t\t\t\t\t\t'?redirect=false&stash=true',\n\t\t\t\t\t\ttype: 'GET',\n\t\t\t\t\t\theaders,\n\t\t\t\t\t\tdataType: 'text'\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tconst restbasePromise = restbaseXhr.then(\n\t\t\t\t\t( response, status, jqxhr ) => {\n\t\t\t\t\t\tve.track( 'trace.restbaseLoad.exit', { mode: 'visual' } );\n\t\t\t\t\t\tmw.track( 'timing.ve.' + options.targetName + '.performance.system.restbaseLoad',\n\t\t\t\t\t\t\tve.now() - start );\n\t\t\t\t\t\treturn [ response, jqxhr.getResponseHeader( 'etag' ) ];\n\t\t\t\t\t},\n\t\t\t\t\t( xhr, code, _ ) => {\n\t\t\t\t\t\tif ( xhr.status === 404 ) {\n\t\t\t\t\t\t\t// Page does not exist, so let the user start with a blank document.\n\t\t\t\t\t\t\treturn $.Deferred().resolve( [ '', undefined ] ).promise();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmw.log.warn( 'RESTBase load failed: ' + xhr.statusText );\n\t\t\t\t\t\t\treturn $.Deferred().reject( code, xhr, _ ).promise();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tdataPromise = $.when( apiPromise, restbasePromise )\n\t\t\t\t\t.then( ( apiData, restbaseData ) => {\n\t\t\t\t\t\tif ( apiData.visualeditor ) {\n\t\t\t\t\t\t\tif ( restbaseData[ 0 ] || !apiData.visualeditor.content ) {\n\t\t\t\t\t\t\t\t// If we have actual content loaded, use it.\n\t\t\t\t\t\t\t\t// Otherwise, allow fallback content if present.\n\t\t\t\t\t\t\t\t// If no fallback content, this will give us an empty string for\n\t\t\t\t\t\t\t\t// content, which is desirable.\n\t\t\t\t\t\t\t\tapiData.visualeditor.content = restbaseData[ 0 ];\n\t\t\t\t\t\t\t\tapiData.visualeditor.etag = restbaseData[ 1 ];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tapiData.visualeditor.switched = switched;\n\t\t\t\t\t\t\tapiData.visualeditor.fromEditedState = fromEditedState;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn apiData;\n\t\t\t\t\t} );\n\t\t\t\tabort = function () {\n\t\t\t\t\tif ( apiXhr ) {\n\t\t\t\t\t\tapiXhr.abort();\n\t\t\t\t\t}\n\t\t\t\t\trestbaseXhr.abort();\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tdataPromise = apiPromise;\n\t\t\t\tif ( apiXhr ) {\n\t\t\t\t\tabort = apiXhr.abort;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn dataPromise.then( ( resp ) => {\n\t\t\t\t// Adapted from RESTBase mwUtil.parseETag()\n\t\t\t\tconst etagRegexp = /^(?:W\\/)?\"?([^\"/]+)(?:\\/([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}))(?:\\/([^\"]+))?\"?$/;\n\n\t\t\t\t// `etag` is expected to be undefined when creating a new page.\n\t\t\t\t// We can detect that case by `content` being empty, and not retry.\n\t\t\t\tif ( useRestbase && resp.visualeditor.content && (\n\t\t\t\t\t!resp.visualeditor.etag ||\n\t\t\t\t\t!etagRegexp.test( resp.visualeditor.etag )\n\t\t\t\t) ) {\n\t\t\t\t\t// Direct request to RESTBase returned a mangled or missing etag.\n\t\t\t\t\t// Retry via the MediaWiki API.\n\t\t\t\t\treturn mw.libs.ve.targetLoader.requestParsoidData(\n\t\t\t\t\t\tpageName,\n\t\t\t\t\t\t$.extend( {}, options, { badetag: resp.visualeditor.etag || '' } ),\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tresp.veMode = 'visual';\n\t\t\t\treturn resp;\n\t\t\t} ).promise( { abort } );\n\t\t},\n\n\t\t/**\n\t\t * Request the page wikitext and various metadata from the MediaWiki API.\n\t\t *\n\t\t * @param {string} pageName See #requestPageData\n\t\t * @param {Object} [options] See #requestPageData\n\t\t * @return {jQuery.Promise} Abortable promise resolved with a JSON object\n\t\t */\n\t\trequestWikitext: function ( pageName, options = {} ) {\n\t\t\tconst data = {\n\t\t\t\taction: 'visualeditor',\n\t\t\t\tpaction: 'wikitext',\n\t\t\t\tpage: pageName,\n\t\t\t\tuselang: mw.config.get( 'wgUserLanguage' ),\n\t\t\t\teditintro: options.editintro,\n\t\t\t\tpreload: options.preload,\n\t\t\t\tpreloadparams: options.preloadparams,\n\t\t\t\tformatversion: 2\n\t\t\t};\n\n\t\t\t// section should never really be undefined, but check just in case\n\t\t\tif ( options.section !== null && options.section !== undefined ) {\n\t\t\t\tdata.section = options.section;\n\t\t\t}\n\n\t\t\tif ( options.oldId !== undefined ) {\n\t\t\t\tdata.oldid = options.oldId;\n\t\t\t}\n\n\t\t\tconst dataPromise = new mw.Api().get( data );\n\t\t\treturn dataPromise.then( ( resp ) => {\n\t\t\t\tresp.veMode = 'source';\n\t\t\t\treturn resp;\n\t\t\t} ).promise( { abort: dataPromise.abort } );\n\t\t}\n\t};\n}() );\n","/*!\n * VisualEditor MediaWiki ArticleTargetSaver.\n *\n * @copyright See AUTHORS.txt\n * @license The MIT License (MIT); see LICENSE.txt\n */\n\n/**\n * Target saver.\n *\n * Light-weight saver.\n *\n * @class mw.libs.ve.targetSaver\n * @singleton\n * @hideconstructor\n */\n( function () {\n\tmw.libs.ve = mw.libs.ve || {};\n\n\tmw.libs.ve.targetSaver = {\n\t\t/**\n\t\t * Preload the library required for deflating so the user doesn't\n\t\t * have to wait when postHtml is called.\n\t\t */\n\t\tpreloadDeflate: function () {\n\t\t\tmw.loader.load( 'mediawiki.deflate' );\n\t\t},\n\n\t\t/**\n\t\t * Compress a string with deflate.\n\t\t *\n\t\t * @param {string} html HTML to deflate\n\t\t * @return {jQuery.Promise} Promise resolved with deflated HTML\n\t\t */\n\t\tdeflate: function ( html ) {\n\t\t\treturn mw.loader.using( 'mediawiki.deflate' ).then( () => mw.deflateAsync( html ) );\n\n\t\t},\n\n\t\t/**\n\t\t * Get HTML to send to Parsoid.\n\t\t *\n\t\t * If the document was generated from scratch (e.g. inside VisualEditor's converter), the\n\t\t * source document can be passed in to transplant the head tag, as well as the attributes\n\t\t * on the html and body tags.\n\t\t *\n\t\t * @param {HTMLDocument} newDoc Document generated by ve.dm.Converter. Will be modified.\n\t\t * @param {HTMLDocument} [oldDoc] Old document to copy attributes from.\n\t\t * @return {string} Full HTML document\n\t\t */\n\t\tgetHtml: function ( newDoc, oldDoc ) {\n\t\t\tfunction copyAttributes( from, to ) {\n\t\t\t\tArray.prototype.forEach.call( from.attributes, ( attr ) => {\n\t\t\t\t\tto.setAttribute( attr.name, attr.value );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tif ( oldDoc ) {\n\t\t\t\t// Copy the head from the old document\n\t\t\t\tfor ( let i = 0, len = oldDoc.head.childNodes.length; i < len; i++ ) {\n\t\t\t\t\tnewDoc.head.appendChild( oldDoc.head.childNodes[ i ].cloneNode( true ) );\n\t\t\t\t}\n\t\t\t\t// Copy attributes from the old document for the html, head and body\n\t\t\t\tcopyAttributes( oldDoc.documentElement, newDoc.documentElement );\n\t\t\t\tcopyAttributes( oldDoc.head, newDoc.head );\n\t\t\t\tcopyAttributes( oldDoc.body, newDoc.body );\n\t\t\t}\n\n\t\t\t// Filter out junk that may have been added by browser plugins\n\t\t\t$( newDoc )\n\t\t\t\t.find( [\n\t\t\t\t\t'script', // T54884, T65229, T96533, T103430\n\t\t\t\t\t'noscript', // T144891\n\t\t\t\t\t'object', // T65229\n\t\t\t\t\t'style:not( [ data-mw ] ):not( [ data-mw-deduplicate ] )', // T55252, but allow <style data-mw(-deduplicate)/> e.g. TemplateStyles T188143\n\t\t\t\t\t'embed', // T53521, T54791, T65121\n\t\t\t\t\t'a[href^=\"javascript:\"]', // T200971\n\t\t\t\t\t'img[src^=\"data:\"]', // T192392\n\t\t\t\t\t'div[id=\"myEventWatcherDiv\"]', // T53423\n\t\t\t\t\t'div[id=\"sendToInstapaperResults\"]', // T63776\n\t\t\t\t\t'div[id=\"kloutify\"]', // T69006\n\t\t\t\t\t'div[id^=\"mittoHidden\"]', // T70900\n\t\t\t\t\t'div.hon.certificateLink', // HON (T209619)\n\t\t\t\t\t'div.donut-container', // Web of Trust (T189148)\n\t\t\t\t\t'div.shield-container' // Web of Trust (T297862)\n\t\t\t\t].join( ',' ) )\n\t\t\t\t.each( ( j, el ) => {\n\t\t\t\t\tfunction truncate( text, l ) {\n\t\t\t\t\t\treturn text.length > l ? text.slice( 0, l ) + '…' : text;\n\t\t\t\t\t}\n\t\t\t\t\tconst errorMessage = 'DOM content matching deny list found:\\n' + truncate( el.outerHTML, 100 ) +\n\t\t\t\t\t\t'\\nContext:\\n' + truncate( el.parentNode.outerHTML, 200 );\n\t\t\t\t\tmw.log.error( errorMessage );\n\t\t\t\t\tconst err = new Error( errorMessage );\n\t\t\t\t\terr.name = 'VeDomDenyListWarning';\n\t\t\t\t\tmw.errorLogger.logError( err, 'error.visualeditor' );\n\t\t\t\t\t$( el ).remove();\n\t\t\t\t} );\n\n\t\t\t// data-mw-section-id is copied to headings by mw.libs.ve.unwrapParsoidSections\n\t\t\t// Remove these to avoid triggering selser.\n\t\t\t$( newDoc ).find( '[data-mw-section-id]:not( section )' ).removeAttr( 'data-mw-section-id' );\n\n\t\t\t// Deduplicate styles (we re-duplicated them in ve.init.mw.Target.static.parseDocument)\n\t\t\t// to let selser recognize the nodes and avoid dirty diffs.\n\t\t\tmw.libs.ve.deduplicateStyles( newDoc.body );\n\n\t\t\t// Add doctype manually\n\t\t\t// ve.properOuterHtml is loaded separately in ve.utils.parsing.js\n\t\t\t// eslint-disable-next-line no-undef\n\t\t\treturn '<!doctype html>' + ve.properOuterHtml( newDoc.documentElement );\n\t\t},\n\n\t\t/**\n\t\t * Serialize and deflate an HTML document\n\t\t *\n\t\t * @param {HTMLDocument} doc Document generated by ve.dm.Converter. Will be modified.\n\t\t * @param {HTMLDocument} [oldDoc] Old document to copy attributes from.\n\t\t * @return {jQuery.Promise} Promise resolved with deflated HTML\n\t\t */\n\t\tdeflateDoc: function ( doc, oldDoc ) {\n\t\t\treturn this.deflate( this.getHtml( doc, oldDoc ) );\n\t\t},\n\n\t\t/**\n\t\t * Post an HTML document to the API.\n\t\t *\n\t\t * Serializes the document to HTML, deflates it, then passes to #postHtml.\n\t\t *\n\t\t * @param {HTMLDocument} doc Document to save\n\t\t * @param {Object} [extraData] Extra data to send to the API\n\t\t * @param {Object} [options]\n\t\t * @return {jQuery.Promise} Promise which resolves if the post was successful\n\t\t */\n\t\tsaveDoc: function ( doc, extraData, options ) {\n\t\t\treturn this.deflateDoc( doc ).then( ( html ) => this.postHtml(\n\t\t\t\thtml,\n\t\t\t\tnull,\n\t\t\t\textraData,\n\t\t\t\toptions\n\t\t\t) );\n\t\t},\n\n\t\t/**\n\t\t * Post wikitext to the API.\n\t\t *\n\t\t * By default uses action=visualeditoredit, paction=save.\n\t\t *\n\t\t * @param {string} wikitext Wikitext to post. Deflating is optional but recommended.\n\t\t * @param {Object} [extraData] Extra data to send to the API\n\t\t * @param {Object} [options]\n\t\t * @param {mw.Api} [options.api] Api to use\n\t\t * @param {Function} [options.now] Function returning current time in milliseconds for tracking, e.g. ve.now\n\t\t * @param {Function} [options.track] Tracking function\n\t\t * @param {string} [options.eventName] Event name for tracking\n\t\t * @return {jQuery.Promise} Promise which resolves with API save data, or rejects with error details\n\t\t */\n\t\tpostWikitext: function ( wikitext, extraData, options ) {\n\t\t\treturn this.postContent( $.extend( { wikitext }, extraData ), options );\n\t\t},\n\n\t\t/**\n\t\t * Post HTML to the API.\n\t\t *\n\t\t * By default uses action=visualeditoredit, paction=save.\n\t\t *\n\t\t * @param {string} html HTML to post. Deflating is optional but recommended.\n\t\t *  Should be included for retries even if a cache key is provided.\n\t\t * @param {string} [cacheKey] Optional cache key of HTML stashed on server.\n\t\t * @param {Object} [extraData] Extra data to send to the API\n\t\t * @param {Object} [options]\n\t\t * @return {jQuery.Promise} Promise which resolves with API save data, or rejects with error details\n\t\t */\n\t\tpostHtml: function ( html, cacheKey, extraData = {}, options = {} ) {\n\t\t\tlet data;\n\t\t\tif ( cacheKey ) {\n\t\t\t\tdata = $.extend( { cachekey: cacheKey }, extraData );\n\t\t\t} else {\n\t\t\t\tdata = $.extend( { html }, extraData );\n\t\t\t}\n\t\t\treturn this.postContent( data, options ).then(\n\t\t\t\tnull,\n\t\t\t\t( code, response ) => {\n\t\t\t\t\t// This cache key is evidently bad, clear it\n\t\t\t\t\tif ( options.onCacheKeyFail ) {\n\t\t\t\t\t\toptions.onCacheKeyFail();\n\t\t\t\t\t}\n\t\t\t\t\tif ( code === 'badcachekey' ) {\n\t\t\t\t\t\t// If the cache key failed, try again without the cache key\n\t\t\t\t\t\treturn this.postHtml(\n\t\t\t\t\t\t\thtml,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\textraData,\n\t\t\t\t\t\t\toptions\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\t// Failed for some other reason - let caller handle it.\n\t\t\t\t\treturn $.Deferred().reject( code, response ).promise();\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Post content to the API, using mw.Api#postWithToken to retry automatically when encountering\n\t\t * a 'badtoken' error.\n\t\t *\n\t\t * By default uses action=visualeditoredit, paction=save.\n\t\t *\n\t\t * @param {string} data Content data\n\t\t * @param {Object} [options]\n\t\t * @param {mw.Api} [options.api] Api to use\n\t\t * @param {Function} [options.now] Function returning current time in milliseconds for tracking, e.g. ve.now\n\t\t * @param {Function} [options.track] Tracking function\n\t\t * @param {string} [options.eventName] Event name for tracking\n\t\t * @return {jQuery.Promise} Promise which resolves with API save data, or rejects with error details\n\t\t */\n\t\tpostContent: function ( data, options = {} ) {\n\t\t\tconst api = options.api || new mw.Api();\n\n\t\t\tlet start;\n\t\t\tif ( options.now ) {\n\t\t\t\tstart = options.now();\n\t\t\t}\n\n\t\t\tdata = $.extend(\n\t\t\t\t{\n\t\t\t\t\taction: 'visualeditoredit',\n\t\t\t\t\tpaction: 'save',\n\t\t\t\t\tuseskin: mw.config.get( 'skin' ),\n\t\t\t\t\t// Same as OO.ui.isMobile()\n\t\t\t\t\tmobileformat: !!mw.config.get( 'wgMFMode' ),\n\t\t\t\t\tformatversion: 2,\n\t\t\t\t\terrorformat: 'html',\n\t\t\t\t\terrorlang: mw.config.get( 'wgUserLanguage' ),\n\t\t\t\t\terrorsuselocal: true\n\t\t\t\t},\n\t\t\t\tdata\n\t\t\t);\n\n\t\t\tconst action = data.action;\n\n\t\t\tconst request = api.postWithToken( 'csrf', data, {\n\t\t\t\tcontentType: 'multipart/form-data',\n\t\t\t\ttrackEditAttemptStepSessionId: true\n\t\t\t} );\n\n\t\t\treturn request.then(\n\t\t\t\t( response, jqxhr ) => {\n\t\t\t\t\tconst responseData = response[ action ];\n\n\t\t\t\t\t// Log data about the request if eventName was set\n\t\t\t\t\tif ( options.track && options.eventName ) {\n\t\t\t\t\t\tconst eventData = {\n\t\t\t\t\t\t\tbytes: require( 'mediawiki.String' ).byteLength( jqxhr.responseText ),\n\t\t\t\t\t\t\tduration: options.now() - start\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst fullEventName = 'performance.system.' + options.eventName +\n\t\t\t\t\t\t\t( responseData.cachekey ? '.withCacheKey' : '.withoutCacheKey' );\n\t\t\t\t\t\toptions.track( fullEventName, eventData );\n\t\t\t\t\t}\n\n\t\t\t\t\tlet error;\n\t\t\t\t\tif ( !responseData ) {\n\t\t\t\t\t\terror = {\n\t\t\t\t\t\t\tcode: 'invalidresponse',\n\t\t\t\t\t\t\thtml: mw.message( 'api-clientside-error-invalidresponse' ).parse()\n\t\t\t\t\t\t};\n\t\t\t\t\t} else if ( responseData.result !== 'success' ) {\n\t\t\t\t\t\t// This should only happen when saving an edit and getting a captcha from ConfirmEdit\n\t\t\t\t\t\t// extension (`data.result === 'error'`). It's a silly special case...\n\t\t\t\t\t\treturn $.Deferred().reject( 'no-error-no-success', response ).promise();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// paction specific errors\n\t\t\t\t\t\tswitch ( responseData.paction ) {\n\t\t\t\t\t\t\tcase 'save':\n\t\t\t\t\t\t\tcase 'serialize':\n\t\t\t\t\t\t\t\tif ( typeof responseData.content !== 'string' ) {\n\t\t\t\t\t\t\t\t\terror = {\n\t\t\t\t\t\t\t\t\t\tcode: 'invalidcontent',\n\t\t\t\t\t\t\t\t\t\thtml: mw.message( 'api-clientside-error-invalidresponse' ).parse()\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'diff':\n\t\t\t\t\t\t\t\tif ( typeof responseData.diff !== 'string' ) {\n\t\t\t\t\t\t\t\t\terror = {\n\t\t\t\t\t\t\t\t\t\tcode: 'invalidcontent',\n\t\t\t\t\t\t\t\t\t\thtml: mw.message( 'api-clientside-error-invalidresponse' ).parse()\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( error ) {\n\t\t\t\t\t\t// Use the same format as API errors\n\t\t\t\t\t\treturn $.Deferred().reject( error.code, { errors: [ error ] } ).promise();\n\t\t\t\t\t}\n\t\t\t\t\treturn responseData;\n\t\t\t\t},\n\t\t\t\t( code, response ) => {\n\t\t\t\t\tconst responseText = OO.getProp( response, 'xhr', 'responseText' );\n\n\t\t\t\t\tif ( responseText && options.track && options.eventName ) {\n\t\t\t\t\t\tconst eventData = {\n\t\t\t\t\t\t\tbytes: require( 'mediawiki.String' ).byteLength( responseText ),\n\t\t\t\t\t\t\tduration: options.now() - start\n\t\t\t\t\t\t};\n\t\t\t\t\t\tlet fullEventName;\n\t\t\t\t\t\tif ( code === 'badcachekey' ) {\n\t\t\t\t\t\t\tfullEventName = 'performance.system.' + options.eventName + '.badCacheKey';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfullEventName = 'performance.system.' + options.eventName + '.withoutCacheKey';\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions.track( fullEventName, eventData );\n\t\t\t\t\t}\n\t\t\t\t\treturn $.Deferred().reject( code, response ).promise();\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t};\n}() );\n"],
"names": [],
"mappings": "yGAMA,EAAE,CAAC,IAAI,CAAC,EAAG,CAAE,EAAE,CAAC,IAAI,CAAC,EAAG,EAAG,CAAC,CAAC,CAY7B,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,kCAAmC,CAAE,QAAS,CAAE,CAAC,CAAE,mBAAoB,CAAE,CACnF,GAAI,CACH,CAAE,CAAE,kBAAkB,CAAE,CAAE,CAAC,CAC5B,CAAE,KAAM,CAAE,CAAE,CAAE,CACb,OAAO,CAAC,CACT,CACA,EAAG,CAAE,mBAAoB,CAAE,CAC1B,OAAO,CAAC,CACT,CACA,OAAO,CAAC,CAAC,OAAO,CAAE,IAAI,CAAE,GAAI,CAAC,CAC9B,CAAC,CAaD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,qBAAsB,CAAE,QAAS,CAAE,OAAO,CAAE,WAAY,CAAE,CACpE,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAE,OAAO,CAAC,gBAAgB,CAAE,6BAA8B,CAAC,CAAE,CAAE,OAAQ,CAAE,EAAG,CACvG,MAAM,MAAO,CAAE,OAAO,CAAC,UAAU,CAChC,SAAU,CAAE,OAAO,CAAC,YAAY,CAAE,oBAAqB,CAAC,CAGzD,EAAG,CAAE,SAAU,GAAI,IAAK,EAAG,CAAC,SAAU,CAAE,CAAE,CAAE,CAC3C,OAAO,CAAC,UAAU,CAAC,YAAY,CAAE,oBAAoB,CAAE,SAAU,CAAC,CACnE,CACA,EAAG,CAAE,WAAY,GAAI,SAAU,EAAG,SAAU,GAAI,WAAY,CAAE,CAC7D,MAAM,CACP,CACA,KAAM,CAAE,OAAO,CAAC,UAAW,CAAE,CAC5B,MAAM,CAAC,YAAY,CAAE,OAAO,CAAC,UAAU,CAAE,OAAQ,CAAC,CACnD,CACA,MAAM,CAAC,WAAW,CAAE,OAAQ,CAAC,CAC9B,CAAE,CAAC,CACJ,CAAC,CAQD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,uBAAwB,CAAE,QAAS,CAAE,OAAQ,CAAE,CACzD,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAE,OAAO,CAAC,gBAAgB,CAAE,wCAAyC,CAAC,CAAE,CAAE,UAAW,CAAE,EAAG,CACrH,UAAU,CAAC,UAAU,CAAC,WAAW,CAAE,UAAW,CAAC,CAChD,CAAE,CAAC,CACJ,CAAC,CAED,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,gBAAiB,CAAE,yBAAyB,CAEvD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,gBAAiB,CAAE,QAAS,CAAE,GAAI,CAAE;AAC9C,MAAM,gBAAiB,CAAE,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,gBAAgB,CACpD,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAE,GAAG,CAAC,gBAAgB,CAAE,YAAa,CAAC,CAAE,CAAE,OAAQ,CAAE,EAAG,CAClF,EAAG,CAAE,gBAAgB,CAAC,IAAI,CAAE,OAAO,CAAC,EAAG,CAAE,CAAE,CAC1C,OAAO,CAAC,eAAe,CAAE,IAAK,CAAC,CAChC,CACD,CAAE,CAAC,CACJ,CAAC,CAQD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,iBAAkB,CAAE,QAAS,CAAE,OAAQ,CAAE,CACnD,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAE,OAAO,CAAC,gBAAgB,CAAE,2CAA4C,CAAC,CAAE,CAAE,IAAK,CAAE,EAAG,CAClH,MAAM,IAAK,CAAE,IAAI,CAAC,YAAY,CAAE,MAAO,CAAC,CACxC,EAAG,CAAE,CAAC,IAAK,EAAG,CAAC,IAAI,CAAC,UAAU,CAAE,UAAW,CAAE,CAAE,CAC9C,MAAM,CACP,CACA,MAAM,GAAI,CAAE,IAAI,CAAC,KAAK,CAAE,UAAU,CAAC,MAAO,CAAC,CAC3C,MAAM,KAAM,CAAE,OAAO,CAAC,aAAa,CAAE,6BAA8B,CAAE,GAAI,CAAE,IAAK,CAAC,CACjF,EAAG,CAAE,CAAC,KAAM,CAAE,CACb,MAAM,CACP,CAEA,MAAM,QAAS,CAAE,IAAI,CAAC,aAAa,CAAC,aAAa,CAAE,OAAQ,CAAC,CAC5D,QAAQ,CAAC,YAAY,CAAE,qBAAqB,CAAE,GAAI,CAAC,CAGnD,GAAI,CAAE,IAAI,CAAE,CAAE,CAAC,CAAE,CAAE,CAAE,KAAK,CAAC,UAAU,CAAC,MAAM,CAAE,CAAC,EAAG,CAAE,CACnD,QAAQ,CAAC,WAAW,CAAE,KAAK,CAAC,UAAU,CAAE,CAAE,CAAC,CAAC,SAAS,CAAE,IAAK,CAAE,CAAC,CAChE,CAEA,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAE,IAAI,CAAC,UAAU,CAAE,CAAE,IAAK,CAAE,EAAG,CAC1D,EAAG,CAAE,IAAI,CAAC,IAAK,GAAI,KAAM,EAAG,IAAI,CAAC,IAAK,GAAI,MAAO,CAAE,CAClD,QAAQ,CAAC,YAAY,CAAE,IAAI,CAAC,IAAI,CAAE,IAAI,CAAC,KAAM,CAAC,CAC/C,CACD,CAAE,CAAC,CAEH,IAAI,CAAC,UAAU,CAAC,YAAY,CAAE,QAAQ,CAAE,IAAK,CAAC,CAC/C,CAAE,CAAC,CAEH,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAE,OAAO,CAAC,gBAAgB,CAAE,kCAAmC,CAAC,CAAE,CAAE,KAAM,CAAE,EAAG;AAC1G,MAAM,GAAI,CAAE,KAAK,CAAC,YAAY,CAAE,qBAAsB,CAAC,CACvD,MAAM,UAAW,CAAE,OAAO,CAAC,aAAa,CAAE,6BAA8B,CAAE,GAAI,CAAE,IAAK,CAAC,CACtF,EAAG,CAAE,CAAC,UAAW,EAAG,UAAW,GAAI,KAAM,CAAE,CAC1C,MAAM,CACP,CAGA,GAAI,CAAE,IAAI,CAAE,CAAE,CAAC,CAAE,CAAE,CAAE,UAAU,CAAC,UAAU,CAAC,MAAM,CAAE,CAAC,EAAG,CAAE,CACxD,KAAK,CAAC,WAAW,CAAE,UAAU,CAAC,UAAU,CAAE,CAAE,CAAC,CAAC,SAAS,CAAE,IAAK,CAAE,CAAC,CAClE,CACD,CAAE,CAAC,CACJ,CAAC,CAOD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,iBAAkB,CAAE,QAAS,CAAE,OAAQ,CAAE,CAUnD,SAAS,oBAAoB,CAAE,IAAK,CAAE,CACrC,MAAM,mBAAoB,CAAE,CAAE,OAAO,CAAE,OAAO,CAAE,OAAO,CAAE,OAAO,CAAE,IAAK,CAAC,CACxE,OAAO,IAAK,EAAG,mBAAmB,CAAC,QAAQ,CAAE,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAE,CAAC,CACtF,CAEA,MAAM,YAAa,CAAE,CAAC,CAAC,CAEvB,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAE,OAAO,CAAC,gBAAgB,CAAE,4BAA6B,CAAC,CAAE,CAAE,KAAM,CAAE,EAAG,CACpG,MAAM,GAAI,CAAE,KAAK,CAAC,YAAY,CAAE,qBAAsB,CAAC,CAEvD,EAAG,CAAE,CAAC,YAAY,CAAE,GAAI,CAAE,CAAE,CAE3B,YAAY,CAAE,GAAI,CAAE,CAAE,IAAI,CAC1B,MAAM,CACP,CAEA,EAAG,CAAE,CAAC,oBAAoB,CAAE,KAAM,CAAE,CAAE,CAErC,MAAM,IAAK,CAAE,KAAK,CAAC,aAAa,CAAC,aAAa,CAAE,MAAO,CAAC,CACxD,IAAI,CAAC,YAAY,CAAE,KAAK,CAAE,8BAA+B,CAAC,CAE1D,IAAI,CAAC,YAAY,CAAE,MAAM,CAAE,UAAW,CAAE,GAAI,CAAC,CAG7C,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAE,KAAK,CAAC,UAAU,CAAE,CAAE,IAAK,CAAE,EAAG,CAC3D,EAAG,CAAE,IAAI,CAAC,IAAK,GAAI,KAAM,EAAG,IAAI,CAAC,IAAK,GAAI,qBAAsB,CAAE;AACjE,IAAI,CAAC,YAAY,CAAE,IAAI,CAAC,IAAI,CAAE,IAAI,CAAC,KAAM,CAAC,CAC3C,CACD,CAAE,CAAC,CAEH,KAAK,CAAC,UAAU,CAAC,YAAY,CAAE,IAAI,CAAE,KAAM,CAAC,CAC7C,CAAE,IAAK,CAKN,KAAK,CAAC,SAAU,CAAE,EAAE,CACrB,CACD,CAAE,CAAC,CACJ,CAAC,CAeD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,gBAAiB,CAAE,QAAS,CAAE,SAAS,CAAE,QAAQ,CAAE,MAAO,CAAE,CACtE,MAAM,YAAa,CAAE,QAAQ,CAAC,eAAe,CAAC,CAAC,CAC/C,MAAO,CAAE,MAAO,EAAG,EAAE,CACrB,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAE,SAAS,CAAC,gBAAgB,CAAE,cAAe,CAAC,CAAE,CAAE,EAAG,CAAE,EAAG,CACrF,IAAI,QAAS,CAAE,IAAI,CACnB,EAAG,CAAE,EAAE,CAAC,YAAY,CAAE,MAAO,CAAC,CAAC,UAAU,CAAE,GAAI,CAAE,CAAE,CAElD,QAAS,CAAE,EAAE,CAAC,YAAY,CAAE,MAAO,CAAC,CAAC,KAAK,CAAE,CAAE,CAAC,CAChD,CAAE,IAAK,CAEN,MAAM,UAAW,CAAE,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,qBAAqB,CAAE,EAAE,CAAC,IAAI,CAAE,EAAE,CAAC,aAAc,CAAC,CAEhF,EAAG,CAAE,UAAU,CAAC,UAAW,CAAE,CAC5B,MAAM,KAAM,CAAE,EAAE,CAAC,KAAK,CAAC,WAAW,CAAE,UAAU,CAAC,KAAM,CAAC,CACtD,EAAG,CAAE,KAAM,EAAG,KAAK,CAAC,eAAe,CAAC,CAAE,GAAI,YAAa,CAAE,CACxD,QAAS,CAAE,IAAI,GAAG,CAAE,EAAE,CAAC,IAAK,CAAC,CAAC,IAAI,CAAC,KAAK,CAAE,CAAE,CAAC,CAC9C,CACD,CACD,CAEA,EAAG,CAAE,QAAS,GAAI,IAAK,CAAE,CACxB,EAAG,CAAE,CAAC,QAAS,CAAE,CAEhB,EAAE,CAAC,YAAY,CAAE,MAAM,CAAE,GAAI,CAAC,CAC/B,CAAE,IAAK,CACN,EAAG,CAAE,MAAO,CAAE,CACb,MAAM,MAAO,CAAE,SAAS,CAAC,aAAa,CAAE,GAAI,CAAE,CAAC,CAAC,cAAc,CAAE,QAAS,CAAE,CAAC,CAG5E,EAAG,CAAE,MAAO,CAAE,CACb,MAAM,CAAC,YAAY,CAAE,IAAI,CAAE,MAAO,CAAE,QAAS,CAAC,CAC9C,MAAM,CAAC,YAAY,CAAE,kBAAkB,CAAE,EAAG,CAAC,CAC9C,CACD,CAIA,EAAE,CAAC,YAAY,CAAE,MAAM,CAAE,GAAI,CAAE,MAAO,CAAE,QAAS,CAAC,CACnD,CACA,EAAE,CAAC,eAAe,CAAE,QAAS,CAAC;AAC/B,CACD,CAAE,CAAC,CAEH,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAE,SAAS,CAAC,gBAAgB,CAAE,wBAAyB,CAAC,CAAE,CAAE,EAAG,CAAE,EAAG,CAC/F,EAAG,CAAE,EAAE,CAAC,YAAY,CAAE,IAAK,CAAE,EAAG,CAAC,EAAE,CAAC,YAAY,CAAE,kBAAmB,CAAE,CAAE,CACxE,EAAE,CAAC,eAAe,CAAE,IAAK,CAAC,CAC3B,CACD,CAAE,CAAC,CACJ,CAAC,CAgBD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,qBAAsB,CAAE,QAAS,CAAE,IAAI,CAAE,GAAI,CAAE,CACzD,SAAS,WAAW,CAAE,GAAI,CAAE,CAC3B,OAAO,GAAG,CAAC,OAAO,CAAE,wBAAwB,CAAE,MAAO,CAAC,CACvD,CAEA,SAAS,kBAAkB,CAAC,CAAE,CAC7B,MAAO,CAAE,UAAU,CAAE,KAAM,CAAC,CAC7B,CAEA,SAAS,kBAAkB,CAAE,QAAS,CAAE,CAGvC,MAAM,IAAK,CAAE,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,wBAAwB,CAAE,QAAS,CAAC,CAC5D,IAAI,CAAC,UAAW,CAAE,IAAI,CACtB,OAAO,IAAI,CACZ,CAEA,IAAI,GAAG,CACP,GAAI,CACH,GAAI,CAAE,IAAI,GAAG,CAAE,IAAI,CAAE,GAAG,CAAC,OAAQ,CAAC,CACnC,CAAE,KAAM,CAAE,CAAE,CAAE,CAEb,OAAO,kBAAkB,CAAC,CAAC,CAC5B,CAGA,MAAM,8BAA+B,CAAE,IAAI,MAAM,CAAE,IAAK,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,gBAAiB,CAAE,CAAE,GAAG,CAAE,GAAI,CAAC,CAGxG,EAAG,CAAE,CAAC,8BAA8B,CAAC,IAAI,CAAE,GAAG,CAAC,QAAQ,CAAC,CAAE,CAAE,CAAE,CAC7D,OAAO,kBAAkB,CAAE,GAAG,CAAC,QAAQ,CAAC,CAAE,CAAC,CAC5C,CAGA,EAAG,CAAE,GAAG,CAAC,YAAY,CAAC,GAAG,CAAE,QAAS,CAAE,GAAI,MAAO,EAAG,GAAG,CAAC,YAAY,CAAC,GAAG,CAAE,SAAU,CAAE,GAAI,GAAI,CAAE,CAC/F,GAAG,CAAC,YAAY,CAAC,MAAM,CAAE,QAAS,CAAC,CACnC,GAAG,CAAC,YAAY,CAAC,MAAM,CAAE,SAAU,CAAC,CACrC,CAEA,MAAM,IAAK,CAAE,CAAC,CAAC,CACf,GAAG,CAAC,YAAY,CAAC,OAAO,CAAE,CAAE,GAAG,CAAE,GAAI,CAAE,EAAG,CACzC,IAAI,CAAC,IAAI,CAAE,GAAI,CAAC,CACjB,CAAE,CAAC;AACH,MAAM,WAAY,CAAE,IAAI,CAAC,MAAM,CAE/B,MAAM,YAAa,CAAE,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAE,WAAW,CAAE,EAAG,CAAC,CAE9D,MAAM,UAAW,CAAE,IAAI,GAAG,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,UAAW,CAAC,CAAE,GAAG,CAAC,OAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAE,WAAW,CAAE,EAAG,CAAC,CAC5G,EAAG,CAAE,YAAY,CAAC,UAAU,CAAE,UAAW,CAAE,CAAE,CAC5C,EAAG,CAAE,WAAY,GAAI,CAAE,EAAG,GAAG,CAAC,YAAY,CAAC,GAAG,CAAE,OAAQ,CAAE,CAAE,CAC3D,OAAO,kBAAkB,CAAE,GAAG,CAAC,YAAY,CAAC,GAAG,CAAE,OAAQ,CAAE,CAAE,GAAG,CAAC,IAAK,CAAC,CACxE,CACD,CAGA,MAAM,WAAY,CAAE,IAAI,GAAG,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,eAAgB,CAAC,CAAE,GAAG,CAAC,OAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAE,WAAW,CAAE,EAAG,CAAC,CAClH,MAAM,gBAAiB,CAAE,IAAI,MAAM,CAAE,WAAW,CAAE,WAAY,CAAC,CAAC,OAAO,CAAE,WAAW,CAAE,IAAK,CAAC,CAAE,MAAO,CAAE,CAAC,CACxG,MAAM,OAAQ,CAAE,YAAY,CAAC,KAAK,CAAE,gBAAiB,CAAC,CACtD,EAAG,CAAE,OAAQ,CAAE,CACd,EAAG,CAAE,WAAY,GAAI,CAAE,EAAG,OAAQ,EAAG,CAAC,OAAO,CAAE,CAAE,CAAC,CAAC,KAAK,CAAE,GAAI,CAAC,CAAE,CAAE,CAAC,CAAC,QAAQ,CAAE,GAAI,CAAE,CAAE,CAEtF,OAAO,kBAAkB,CAAE,OAAO,CAAE,CAAE,CAAE,CAAC,CAC1C,CACD,CAGA,OAAO,kBAAkB,CAAC,CAAC,CAC5B,CAAC,CAQD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,yBAA0B,CAAE,QAAS,CAAE,KAAM,CAAE,CAEzD,MAAM,GAAI,CAAE,KAAK,CAAC,OAAO,CAAE,GAAI,CAAC,CAChC,IAAI,MAAO,CAAE,IAAI,CACjB,EAAG,CAAE,GAAI,GAAI,CAAC,CAAE,CAAE,CACjB,MAAO,CAAE,KAAK,CAAC,KAAK,CAAE,GAAI,CAAE,CAAE,CAAC,CAC/B,KAAM,CAAE,KAAK,CAAC,KAAK,CAAE,CAAC,CAAE,GAAI,CAAC,CAC9B,CACA,IAAI,YAAa,CAAE,KAAK,CAAC,OAAO,CAAE,eAAe,CAAE,CAAE,KAAM,CAAE,EAAG,EAAE,CAAC,IAAI,CAAC,aAAa,CAAE,KAAM,CAAE,CAAC,CAChG,EAAG,CAAE,MAAO,GAAI,IAAK,CAAE;AACtB,YAAa,EAAG,GAAI,CAAE,EAAE,CAAC,IAAI,CAAC,eAAe,CAAE,MAAO,CAAC,CACxD,CACA,MAAO,IAAK,CAAE,YAAY,CAC3B,CAAC,CAcD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,wBAAyB,CAAE,QAAS,CAAE,YAAa,CAAE,CAI/D,MAAM,OAAQ,CAAE,YAAY,CAAC,KAAK,CAAE,eAAgB,CAAC,CACrD,MAAO,CAGN,KAAK,CAAE,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,kCAAkC,CAAE,OAAO,CAAE,CAAE,CAAE,CACpE,CAAC,CACF,CAAC,CAQD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,4BAA6B,CAAE,QAAS,CAAE,YAAa,CAAE,CACnE,OAAO,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,wBAAwB,CAAE,YAAa,CAAC,CAAC,KAAK,CACjE,CAAC;AC7XD,EAAE,CAAC,IAAI,CAAC,EAAG,CAAE,EAAE,CAAC,IAAI,CAAC,EAAG,EAAG,CAAC,CAAC,CAO7B,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,cAAe,CAAE,QAAS,CAAE,SAAU,CAAE,CAKlD,MAAM,oBAAqB,CAAE,gBAAiB,GAAG,QAAQ,CAAC,eAAe,CAAC,KAAK,CAC/E,EAAG,CAAE,oBAAqB,CAAE,CAC3B,MAAM,CAAC,MAAM,CAAE,CACd,GAAG,CAAE,SAAS,CACd,QAAQ,CAAE,QACX,CAAE,CAAC,CACJ,CAAE,IAAK,CAEN,IAAI,eAAe,CACnB,EAAG,CAAE,EAAG,EAAG,EAAE,CAAC,EAAG,CAAE,CAGlB,eAAgB,CAAE,EAAE,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,wBAAwB,CAAE,QAAQ,CAAC,IAAK,CAAC,CACjF,CAAE,IAAK,CACN,eAAgB,CAAE,QAAQ,CAAC,eAAe,CAC3C,CAEA,CAAC,CAAE,eAAgB,CAAC,CAAC,OAAO,CAAE,CAAE,SAAU,CAAE,CAAC,CAC9C,CACD,CAAC;ACjBD,CAAE,QAAS,CAAC,CAAE,CACb,EAAE,CAAC,IAAI,CAAC,EAAG,CAAE,EAAE,CAAC,IAAI,CAAC,EAAG,EAAG,CAAC,CAAC,CAE7B,MAAM,IAAK,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,sBAAuB,CAAC,CACnD,eAAgB,CAAE,CAAC,CAAC,CACpB,OAAQ,CAAE,CACT,gCAAgC,CAEhC,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAE,EAAE,CAAC,MAAM,CAAC,QAAS,CAClD,CAAC,CAEF,MAAM,GAAI,CAAE,IAAI,GAAG,CAAE,QAAQ,CAAC,IAAK,CAAC,CAEpC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,UAAW,CAAE,GAAG,CAG3B,EAAG,CACF,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAE,0BAA2B,CAAE,EAClD,GAAG,CAAC,YAAY,CAAC,GAAG,CAAE,UAAW,CAAE,GAAI,YACxC,CAAE,CACD,OAAO,CAAC,IAAI,CAAE,6BAA8B,CAAC,CAC9C,CAGA,EAAG,CACF,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAE,qBAAsB,CAAE,EAC7C,GAAG,CAAC,YAAY,CAAC,GAAG,CAAE,eAAgB,CACvC,CAAE,CACD,OAAO,CAAC,IAAI,CAAE,yBAA0B,CAAC,CAC1C,CAKA,EAAG,CAAE,IAAI,CAAC,SAAU,EAAG,IAAI,CAAC,eAAgB,CAAE,CAC7C,IAAI,QAAQ,CACZ,EAAG,CAAE,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,CAAE,CAAE,CAEvB,MAAM,KAAM,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,QAAQ,CAAE,EAAE,CAAE,EAAE,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAE,CAAC,CAE9E,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,QAAQ,CAAE,KAAK,CAAE,CAAE,IAAI,CAAE,GAAG,CAAE,OAAO,CAAE,EAAG,CAAE,KAAK,CAAE,MAAM,CAAE,EAAG,CAAE,CAAC,CAChF,QAAS,CAAE,QAAQ,CAAE,KAAK,CAAC,KAAK,CAAE,CAAC,CAAE,CAAE,CAAC,CAAE,EAAG,CAAE,CAAE,CAAE,GAAI,CAAC,CACzD,CAAE,IAAK,CACN,QAAS,CAAE,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,CAAE,CAAE,CAAE,GAAI,CAAC,CACrC,CACA,IAAI,CAAC,oBAAqB,CAAE,QAAS,CAAE,MAAO,CAAE,SAAS,CAEzD,EAAE,CAAC,MAAM,CAAC,GAAG,CACZ,qCAAqC,CACrC,oBAAqB,CAAE,IAAI,CAAC,eAAgB,CAAE,GAAI,CAAE,CAAE,QAAS,CAAE,MAAO,CAAE,SAAU;AACrF,CAAC,CACF,CAEA,MAAM,SAAU,CAAE,IAAI,CAAC,SAAU,EAAG,CAAC,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,CAAE,UAAW,CAAE,EAAG,CAAC,CAAC,MAAM,CAAC,6BAA6B,CAClH,EAAG,CAAE,IAAI,CAAC,gBAAiB,EAAG,SAAU,CAAE,CACzC,OAAO,CAAC,IAAI,CAAE,4BAA6B,CAAC,CAC7C,CAEA,MAAM,UAAW,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,gBAAiB,CAAC,CAGpD,EAAG,CACF,MAAM,CAAC,IAAI,CAAE,UAAW,CAAC,CAAC,IAAI,CAAE,CAAE,IAAK,CAAE,EAAG,EAAE,CAAC,KAAK,CAAC,uBAAuB,CAAE,UAAU,CAAE,IAAK,CAAE,CAAE,CACpG,CAAE,CACD,OAAO,CAAC,IAAI,CAAE,8BAA+B,CAAC,CAC/C,CAEA,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,YAAa,CAAE,CAYzB,SAAS,CAAE,QAAS,CAAE,MAAO,CAAE,CAC9B,EAAG,CAAE,OAAO,MAAO,GAAI,QAAS,CAAE,CACjC,OAAO,CAAC,IAAI,CAAE,MAAO,CAAC,CACvB,CAAE,IAAK,CACN,eAAe,CAAC,IAAI,CAAE,MAAO,CAAC,CAC/B,CACD,CAAC,CAYD,WAAW,CAAE,QAAS,CAAE,IAAK,CAAE,CAC9B,EAAE,CAAC,IAAI,CAAE,gBAAiB,CAAC,CAAC,IAAI,CAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAE,IAAK,CAAE,CAAC,CAC/D,EAAE,CAAC,KAAK,CAAE,wBAAwB,CAAE,CAAE,IAAK,CAAE,CAAC,CAC9C,OAAO,EAAE,CAAC,MAAM,CAAC,KAAK,CAAE,OAAQ,CAC/B,CAAC,IAAI,CAAE,CAAC,CAAE,EAAG,CACZ,EAAE,CAAC,KAAK,CAAE,uBAAuB,CAAE,CAAE,IAAK,CAAE,CAAC,CAC7C,eAAe,CAAC,IAAI,CAAE,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,qBAAqB,CAAC,IAAI,CAAE,EAAE,CAAC,IAAI,CAAC,QAAS,CAAE,CAAC,CAEvF,OAAO,CAAC,CAAC,IAAI,CAAE,GAAG,eAAe,CAAC,GAAG,CAAE,CAAE,QAAS,CAAE,EAAG,CACtD,GAAI,CACH,OAAO,QAAQ,CAAC,CAAC,CAClB,CAAE,KAAM,CAAE,CAAE,CAAE,CACb,EAAE,CAAC,GAAG,CAAC,IAAI,CAAE,2BAA2B,CAAE,CAAE,CAAC,CAC7C,OAAO,IAAI,CACZ,CACD,CAAE,CAAE,CAAC,CACN,CAAE,CAAC,CACL,CAAC,CAUD,oBAAoB,CAAE,QAAS,CAAE,aAAa,CAAE,YAAa,CAAE;AAC9D,MAAM,cAAe,CAAE,CAAC,CAAC,CACxB,gBAAiB,CAAE,CAAC,CAAC,CAEtB,EAAG,CAAE,aAAc,CAAE,CACpB,MAAM,CAAC,IAAI,CAAE,aAAc,CAAC,CAAC,OAAO,CAAE,CAAE,IAAK,CAAE,EAAG,CACjD,MAAM,OAAQ,CAAE,aAAa,CAAE,IAAK,CAAC,CACrC,IAAI,SAAU,CAAE,IAAI,CACnB,KAAM,CAAE,IAAI,CAIb,EAAG,CAAE,OAAO,CAAC,OAAQ,CAAE,CAItB,SAAU,CAAE,EAAE,CAAC,OAAO,CAAE,YAAa,CAAE,OAAO,CAAC,OAAQ,CAAC,CAAC,IAAI,CAAC,CAAC,CAI/D,KAAM,CAAE,EAAE,CAAC,OAAO,CAAE,UAAW,CAAE,OAAO,CAAC,OAAQ,CAAC,CAAC,IAAI,CAAC,CAAC,CAC1D,CACA,EAAG,CAAE,OAAO,CAAE,eAAgB,CAAE,CAAE,CAGjC,KAAM,CAAE,EAAE,CAAC,OAAO,CAAE,OAAO,CAAE,eAAgB,CAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CACxD,CAIA,MAAM,MAAO,CAAE,EAAE,CAAC,OAAO,CAAE,OAAO,CAAE,eAAgB,CAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAElE,MAAM,MAAO,CAAE,CAAC,CAAC,MAAM,CAAE,CACxB,SAAS,CAKT,OAAO,CAAE,CAAE,8BAA+B,CAAE,IAAK,CAClD,CAAC,CAAE,YAAa,CAAC,CAEjB,IAAI,QAAQ,CACZ,MAAO,CAAE,OAAO,CAAC,KAAM,CAAE,CACxB,IAAK,2BAA2B,CAC/B,QAAS,CAAE,IAAI,EAAE,CAAC,EAAE,CAAC,mBAAmB,CAAE,CAAC,CAAC,MAAM,CAAE,MAAM,CAAE,CAC3D,KAAK,CAAE,OAAO,CAAC,OAAO,CACtB,OAAO,CAAE,OAAO,CAAC,OAClB,CAAE,CAAE,CAAC,CACL,KAAK,CAEN,OAAO,CACN,QAAS,CAAE,IAAI,EAAE,CAAC,EAAE,CAAC,mBAAmB,CAAE,CAAC,CAAC,MAAM,CAAE,MAAM,CAAE,CAC3D,QAAQ,CAAE,OAAO,CAAC,OACnB,CAAE,CAAE,CAAC,CACL,KAAK,CACP,CAEA,cAAc,CAAC,IAAI,CAClB,IAAI,EAAE,CAAC,EAAE,CAAC,WAAW,CAAE,QAAQ,CAAE,CAChC,KAAK,CAAE,QAAQ,CACf,KAAK,CAAE,MAAM,CACb,KAAK,CACL,cAAc,CAAE,CAAC,CAAC,OAAO,CAAC,cAAc,CAIxC,OAAO,CAAE,CAAE,2BAA4B,CAAE,IAAK,CAC/C,CAAE,CACH,CAAC;AACD,gBAAgB,CAAE,IAAK,CAAE,CAAE,QAAQ,CACpC,CAAE,CAAC,CACJ,CACA,MAAO,CACN,cAAc,CACd,gBACD,CAAC,CACF,CAAC,CAoBD,eAAe,CAAE,QAAS,CAAE,IAAI,CAAE,QAAQ,CAAE,OAAQ,CAAE,CAAC,CAAE,CAAE,CAC1D,EAAG,CAAE,IAAK,GAAI,QAAS,EAAG,OAAO,CAAC,OAAQ,GAAI,KAAM,CAAE,CACrD,MAAM,IAAI,KAAK,CAAE,oDAAqD,CAAC,CACxE,CACA,MAAM,UAAW,CAAE,IAAK,GAAI,QAAS,CACpC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAE,IAAI,CAAE,QAAQ,CAAE,OAAQ,CAAE,CACrD,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAE,IAAI,CAAE,QAAQ,CAAE,OAAQ,CAAC,CAExD,EAAG,CAAE,OAAO,CAAC,YAAa,CAAE,CAC3B,IAAI,YAAY,CAChB,GAAI,CAEH,YAAa,CAAE,IAAI,CAAC,KAAK,CAAE,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAE,aAAc,CAAE,CAAC,CACrE,CAAE,KAAM,CAAE,CAAE,CAAE,CAAC,CAEf,EAAG,CAAE,YAAa,CAAE,CACnB,MAAM,OAAQ,CAAE,YAAY,CAAC,OAAQ,EAAG,CAAC,CAAC,CAE1C,MAAM,0BAA2B,CAAE,IAAI,CAAC,0BAA0B,CAClE,MAAM,OAAQ,CAAE,OAAO,CAAC,IAAK,GAAI,QAAS,EAAG,0BAA2B,GAAI,IAAK,EAAG,0BAA2B,GAAI,OAAO,CAAC,UAAW,CACrI,OAAO,CAAC,OAAQ,CAAE,IAAI,CAEvB,EAAG,CACF,OAAO,CAAC,QAAS,GAAI,QAAS,EAC9B,OAAO,CAAC,IAAK,GAAI,IAAK,EACtB,OAAO,CAAC,OAAQ,GAAI,OAGrB,CAAE,CACD,MAAM,WAAY,CAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAE,CACzC,YAAY,CAAE,CAAC,CAAC,MAAM,CACrB,CAAE,OAAO,CAAE,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAE,YAAa,CAAE,CAAC,CACnD,YAAY,CAAC,QAAQ,CACrB,CAAE,SAAS,CAAE,IAAK,CACnB,CACD,CAAE,CAAC,CAAC,OAAO,CAAC,CAAC;AAGb,EAAG,CAAE,YAAY,CAAC,QAAQ,CAAC,KAAM,GAAI,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,iBAAkB,CAAE,CAAE,CACzE,OAAO,WAAW,CACnB,CAAE,IAAK,CAKN,EAAE,CAAC,KAAM,CAAE,QAAS,CAAC,CAAE,CAAC,CAAC,CACzB,OAAO,EAAE,CAAC,MAAM,CAAC,KAAK,CAAE,iBAAkB,CAAC,CAAC,IAAI,CAAE,CAAC,CAAE,EAAG,EAAE,CAAC,EAAE,CAAC,OAAO,CAAE,EAAE,CAAC,GAAG,CAAE,+CAAgD,CAAC,CAAE,CACjI,KAAK,CAAE,EAAE,CAAC,GAAG,CAAE,6CAA8C,CAAC,CAC9D,OAAO,CAAE,CACR,CAAE,MAAM,CAAE,QAAQ,CAAE,KAAK,CAAE,EAAE,CAAC,GAAG,CAAE,8CAA+C,CAAC,CAAE,KAAK,CAAE,CAAE,SAAS,CAAE,aAAc,CAAE,CAAC,CAC1H,CAAE,MAAM,CAAE,QAAQ,CAAE,KAAK,CAAE,EAAE,CAAC,GAAG,CAAE,8CAA+C,CAAC,CAAE,KAAK,CAAE,aAAc,CAC3G,CAAE,CACH,CAAC,CAAC,IAAI,CAAE,CAAE,SAAU,CAAE,EAAG,CACxB,EAAG,CAAE,SAAU,CAAE,CAChB,OAAO,WAAW,CACnB,CAAE,IAAK,CAEN,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAE,aAAc,CAAC,CAC1C,OAAO,UAAU,CAAC,CAAC,CACpB,CACD,CAAE,CAAE,CAAC,CACN,CACD,CACD,CACD,CAEA,OAAO,UAAU,CAAC,CAAC,CACpB,CAAC,CAaD,kBAAkB,CAAE,QAAS,CAAE,QAAQ,CAAE,OAAQ,CAAE,CAAC,CAAC,CAAE,UAAW,CAAE,KAAK,CAAE,UAAW,CAAE,KAAM,CAAE,CAC/F,MAAM,OAAQ,CAAE,OAAO,CAAC,OAAQ,GAAI,SAAU,CAAE,OAAO,CAAC,OAAQ,CAAE,IAAI,CACrE,WAAY,CAAE,CAAC,UAAW,EAAG,CAAE,IAAI,CAAC,eAAgB,EAAG,IAAI,CAAC,WAAY,CAAE,EAAG,OAAQ,GAAI,IAAI,CAE9F,MAAM,IAAK,CAAE,CACZ,MAAM,CAAE,cAAc,CACtB,OAAO,CAAE,WAAY,CAAE,UAAW,CAAE,OAAO,CAC3C,IAAI,CAAE,QAAQ,CACd,OAAO,CAAE,OAAO,CAAC,OAAO;AACxB,OAAO,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,gBAAiB,CAAC,CAC1C,SAAS,CAAE,OAAO,CAAC,SAAS,CAC5B,OAAO,CAAE,OAAO,CAAC,OAAO,CACxB,aAAa,CAAE,OAAO,CAAC,aAAa,CACpC,aAAa,CAAE,CAChB,CAAC,CAMD,EAAG,CAAE,OAAO,CAAC,KAAM,GAAI,SAAU,CAAE,CAClC,IAAI,CAAC,KAAM,CAAE,OAAO,CAAC,KAAK,CAC3B,CAEA,MAAM,KAAM,CAAE,EAAE,CAAC,GAAG,CAAC,CAAC,CACtB,EAAE,CAAC,KAAK,CAAE,qBAAqB,CAAE,CAAE,IAAI,CAAE,QAAS,CAAE,CAAC,CAErD,IAAI,MAAM,CAAE,UAAU,CACtB,IAAI,QAAS,CAAE,KAAK,CACnB,eAAgB,CAAE,KAAK,CACxB,EAAG,CAAE,CAAC,WAAY,EAAG,OAAO,CAAC,QAAS,GAAI,SAAU,CAAE,CAErD,IAAI,CAAC,OAAQ,CAAE,OAAO,CACtB,IAAI,CAAC,KAAM,CAAE,IAAI,CACjB,QAAS,CAAE,IAAI,CACf,eAAgB,CAAE,OAAO,CAAC,QAAQ,CAClC,IAAI,CAAC,QAAS,CAAE,OAAO,CAAC,QAAQ,CAChC,IAAI,CAAC,OAAQ,CAAE,OAAO,CAAC,OAAO,CAC9B,IAAI,CAAC,KAAM,CAAE,OAAO,CAAC,KAAK,CAC1B,MAAO,CAAE,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAE,IAAK,CAAC,CACnC,CAAE,IAAK,CACN,EAAG,CAAE,WAAY,EAAG,UAAW,CAAE,CAChC,UAAW,CAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAE,CAAE,YAAY,CAAE,CAAC,CAAE,CAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CACpE,CAAE,IAAK,CACN,MAAO,CAAE,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAE,IAAK,CAAC,CAClC,CACD,CACA,EAAG,CAAE,CAAC,UAAW,CAAE,CAClB,UAAW,CAAE,MAAM,CAAC,IAAI,CAAE,CAAE,QAAS,CAAE,EAAG,CACzC,EAAE,CAAC,KAAK,CAAE,oBAAoB,CAAE,CAAE,IAAI,CAAE,QAAS,CAAE,CAAC,CACpD,EAAE,CAAC,KAAK,CAAE,YAAa,CAAE,OAAO,CAAC,UAAW,CAAE,6BAA6B,CAC1E,EAAE,CAAC,GAAG,CAAC,CAAE,CAAE,KAAM,CAAC,CACnB,EAAG,CAAE,QAAQ,CAAC,YAAa,CAAE,CAC5B,QAAQ,CAAC,YAAY,CAAC,QAAS,CAAE,QAAQ,CACzC,QAAQ,CAAC,YAAY,CAAC,eAAgB,CAAE,eAAe;AACxD,CACA,OAAO,QAAQ,CAChB,CAAE,CAAC,CACJ,CAEA,IAAI,WAAW,CAAE,KAAK,CACtB,EAAG,CAAE,WAAY,CAAE,CAClB,EAAE,CAAC,KAAK,CAAE,0BAA0B,CAAE,CAAE,IAAI,CAAE,QAAS,CAAE,CAAC,CAE1D,MAAM,OAAQ,CAAE,CAEf,MAAM,CAAE,qFAAqF,CAC7F,iBAAiB,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,gBAAiB,CAAC,CAAC,gBAAgB,CACrE,gBAAgB,CAAE,yBAA0B,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,WAAY,CAC1E,CAAC,CAED,IAAI,WAAW,CAAE,WAAW,CAE5B,EAAG,CAEF,OAAO,CAAC,QAAS,GAAI,SAAU,EAE/B,CAAC,CAAC,CAAE,kBAAmB,CAAC,CAAC,GAAG,CAAC,CAC9B,CAAE,CACD,EAAG,CAAE,IAAI,CAAC,eAAgB,CAAE,CAC3B,WAAY,CAAE,IAAI,CAAC,eAAgB,CAAE,gCAAgC,CACtE,CAAE,IAAK,CACN,WAAY,CAAE,IAAI,CAAC,WAAW,CAAC,OAAO,CAAE,eAAe,CAAE,gCAAiC,CAAC,CAC5F,CACA,QAAS,CAAE,IAAI,CACf,eAAgB,CAAE,OAAO,CAAC,QAAQ,CAClC,MAAM,CAAC,cAAe,CAAE,IAAI,CAC5B,CAAC,CAAE,MAAO,CAAC,CAAC,GAAG,CAAE,cAAe,CAAC,CACjC,WAAY,CAAE,CAAC,CAAC,IAAI,CAAE,CACrB,GAAG,CAAE,WAAY,CAAE,kBAAkB,CAAE,QAAS,CAAE,CACjD,CAAE,IAAI,CAAC,KAAM,GAAI,SAAU,CAAE,EAAG,CAAE,GAAI,CAAE,IAAI,CAAC,KAAM,CAAC,CACrD,IAAI,CAAE,MAAM,CACZ,IAAI,CAAE,CACL,KAAK,CAAE,QAAQ,CACf,QAAQ,CAAE,OAAO,CAAC,QAAQ,CAC1B,KAAK,CAAE,MACR,CAAC,CACD,OAAO,CACP,QAAQ,CAAE,MACX,CAAE,CAAC,CACJ,CAAE,IAAK,CAEN,EAAG,CAAE,IAAI,CAAC,eAAgB,CAAE,CAC3B,WAAY,CAAE,IAAI,CAAC,eAAgB,CAAE,eAAe;AACrD,CAAE,IAAK,CACN,WAAY,CAAE,IAAI,CAAC,WAAW,CAC/B,CACA,WAAY,CAAE,CAAC,CAAC,IAAI,CAAE,CACrB,GAAG,CAAE,WAAY,CAAE,kBAAkB,CAAE,QAAS,CAAE,CACjD,CAAE,IAAI,CAAC,KAAM,GAAI,SAAU,CAAE,EAAG,CAAE,GAAI,CAAE,IAAI,CAAC,KAAM,CAAE,CACrD,4BAA4B,CAC7B,IAAI,CAAE,KAAK,CACX,OAAO,CACP,QAAQ,CAAE,MACX,CAAE,CAAC,CACJ,CACA,MAAM,eAAgB,CAAE,WAAW,CAAC,IAAI,CACvC,CAAE,QAAQ,CAAE,MAAM,CAAE,KAAM,CAAE,EAAG,CAC9B,EAAE,CAAC,KAAK,CAAE,yBAAyB,CAAE,CAAE,IAAI,CAAE,QAAS,CAAE,CAAC,CACzD,EAAE,CAAC,KAAK,CAAE,YAAa,CAAE,OAAO,CAAC,UAAW,CAAE,kCAAkC,CAC/E,EAAE,CAAC,GAAG,CAAC,CAAE,CAAE,KAAM,CAAC,CACnB,MAAO,CAAE,QAAQ,CAAE,KAAK,CAAC,iBAAiB,CAAE,MAAO,CAAE,CAAC,CACvD,CAAC,CACD,CAAE,GAAG,CAAE,IAAI,CAAE,CAAE,CAAE,EAAG,CACnB,EAAG,CAAE,GAAG,CAAC,MAAO,GAAI,GAAI,CAAE,CAEzB,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAE,CAAE,EAAE,CAAE,SAAU,CAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAC3D,CAAE,IAAK,CACN,EAAE,CAAC,GAAG,CAAC,IAAI,CAAE,wBAAyB,CAAE,GAAG,CAAC,UAAW,CAAC,CACxD,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAE,IAAI,CAAE,GAAG,CAAE,CAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CACrD,CACD,CACD,CAAC,CAED,WAAY,CAAE,CAAC,CAAC,IAAI,CAAE,UAAU,CAAE,eAAgB,CACjD,CAAC,IAAI,CAAE,CAAE,OAAO,CAAE,YAAa,CAAE,EAAG,CACnC,EAAG,CAAE,OAAO,CAAC,YAAa,CAAE,CAC3B,EAAG,CAAE,YAAY,CAAE,CAAE,CAAE,EAAG,CAAC,OAAO,CAAC,YAAY,CAAC,OAAQ,CAAE,CAKzD,OAAO,CAAC,YAAY,CAAC,OAAQ,CAAE,YAAY,CAAE,CAAE,CAAC,CAChD,OAAO,CAAC,YAAY,CAAC,IAAK,CAAE,YAAY,CAAE,CAAE,CAAC,CAC9C,CACA,OAAO,CAAC,YAAY,CAAC,QAAS,CAAE,QAAQ,CACxC,OAAO,CAAC,YAAY,CAAC,eAAgB,CAAE,eAAe;AACvD,CACA,OAAO,OAAO,CACf,CAAE,CAAC,CACJ,KAAM,CAAE,QAAS,CAAC,CAAE,CACnB,EAAG,CAAE,MAAO,CAAE,CACb,MAAM,CAAC,KAAK,CAAC,CAAC,CACf,CACA,WAAW,CAAC,KAAK,CAAC,CAAC,CACpB,CAAC,CACF,CAAE,IAAK,CACN,WAAY,CAAE,UAAU,CACxB,EAAG,CAAE,MAAO,CAAE,CACb,KAAM,CAAE,MAAM,CAAC,KAAK,CACrB,CACD,CAEA,OAAO,WAAW,CAAC,IAAI,CAAE,CAAE,IAAK,CAAE,EAAG,CAEpC,MAAM,UAAW,CAAE,0GAA0G,CAI7H,EAAG,CAAE,WAAY,EAAG,IAAI,CAAC,YAAY,CAAC,OAAQ,EAAG,CAChD,CAAC,IAAI,CAAC,YAAY,CAAC,IAAK,EACxB,CAAC,UAAU,CAAC,IAAI,CAAE,IAAI,CAAC,YAAY,CAAC,IAAK,CAC1C,CAAE,CAAE,CAGH,OAAO,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,kBAAkB,CAChD,QAAQ,CACR,CAAC,CAAC,MAAM,CAAE,CAAC,CAAC,CAAE,OAAO,CAAE,CAAE,OAAO,CAAE,IAAI,CAAC,YAAY,CAAC,IAAK,EAAG,EAAG,CAAE,CAAC,CAClE,IACD,CAAC,CACF,CAEA,IAAI,CAAC,MAAO,CAAE,QAAQ,CACtB,OAAO,IAAI,CACZ,CAAE,CAAC,CAAC,OAAO,CAAE,CAAE,KAAM,CAAE,CAAC,CACzB,CAAC,CASD,eAAe,CAAE,QAAS,CAAE,QAAQ,CAAE,OAAQ,CAAE,CAAC,CAAE,CAAE,CACpD,MAAM,IAAK,CAAE,CACZ,MAAM,CAAE,cAAc,CACtB,OAAO,CAAE,UAAU,CACnB,IAAI,CAAE,QAAQ,CACd,OAAO,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,gBAAiB,CAAC,CAC1C,SAAS,CAAE,OAAO,CAAC,SAAS,CAC5B,OAAO,CAAE,OAAO,CAAC,OAAO,CACxB,aAAa,CAAE,OAAO,CAAC,aAAa,CACpC,aAAa,CAAE,CAChB,CAAC,CAGD,EAAG,CAAE,OAAO,CAAC,OAAQ,GAAI,IAAK,EAAG,OAAO,CAAC,OAAQ,GAAI,SAAU,CAAE,CAChE,IAAI,CAAC,OAAQ,CAAE,OAAO,CAAC,OAAO,CAC/B,CAEA,EAAG,CAAE,OAAO,CAAC,KAAM,GAAI,SAAU,CAAE,CAClC,IAAI,CAAC,KAAM,CAAE,OAAO,CAAC,KAAK,CAC3B,CAEA,MAAM,WAAY,CAAE,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAE,IAAK,CAAC;AAC5C,OAAO,WAAW,CAAC,IAAI,CAAE,CAAE,IAAK,CAAE,EAAG,CACpC,IAAI,CAAC,MAAO,CAAE,QAAQ,CACtB,OAAO,IAAI,CACZ,CAAE,CAAC,CAAC,OAAO,CAAE,CAAE,KAAK,CAAE,WAAW,CAAC,KAAM,CAAE,CAAC,CAC5C,CACD,CAAC,CACF,CAAC,CAAC,CAAE,CAAC;AC9gBL,CAAE,QAAS,CAAC,CAAE,CACb,EAAE,CAAC,IAAI,CAAC,EAAG,CAAE,EAAE,CAAC,IAAI,CAAC,EAAG,EAAG,CAAC,CAAC,CAE7B,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,WAAY,CAAE,CAKxB,cAAc,CAAE,QAAS,CAAC,CAAE,CAC3B,EAAE,CAAC,MAAM,CAAC,IAAI,CAAE,mBAAoB,CAAC,CACtC,CAAC,CAQD,OAAO,CAAE,QAAS,CAAE,IAAK,CAAE,CAC1B,OAAO,EAAE,CAAC,MAAM,CAAC,KAAK,CAAE,mBAAoB,CAAC,CAAC,IAAI,CAAE,CAAC,CAAE,EAAG,EAAE,CAAC,YAAY,CAAE,IAAK,CAAE,CAAC,CAEpF,CAAC,CAaD,OAAO,CAAE,QAAS,CAAE,MAAM,CAAE,MAAO,CAAE,CACpC,SAAS,cAAc,CAAE,IAAI,CAAE,EAAG,CAAE,CACnC,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAE,IAAI,CAAC,UAAU,CAAE,CAAE,IAAK,CAAE,EAAG,CAC1D,EAAE,CAAC,YAAY,CAAE,IAAI,CAAC,IAAI,CAAE,IAAI,CAAC,KAAM,CAAC,CACzC,CAAE,CAAC,CACJ,CAEA,EAAG,CAAE,MAAO,CAAE,CAEb,GAAI,CAAE,IAAI,CAAE,CAAE,CAAC,CAAE,GAAI,CAAE,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAE,CAAE,CAAE,GAAG,CAAE,CAAC,EAAG,CAAE,CACpE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAE,MAAM,CAAC,IAAI,CAAC,UAAU,CAAE,CAAE,CAAC,CAAC,SAAS,CAAE,IAAK,CAAE,CAAC,CACzE,CAEA,cAAc,CAAE,MAAM,CAAC,eAAe,CAAE,MAAM,CAAC,eAAgB,CAAC,CAChE,cAAc,CAAE,MAAM,CAAC,IAAI,CAAE,MAAM,CAAC,IAAK,CAAC,CAC1C,cAAc,CAAE,MAAM,CAAC,IAAI,CAAE,MAAM,CAAC,IAAK,CAAC,CAC3C,CAGA,CAAC,CAAE,MAAO,CACT,CAAC,IAAI,CAAE,CACN,QAAQ,CACR,UAAU,CACV,QAAQ,CACR,yDAAyD,CACzD,OAAO,CACP,wBAAwB,CACxB,mBAAmB,CACnB,6BAA6B,CAC7B,mCAAmC,CACnC,oBAAoB,CACpB,wBAAwB,CACxB,yBAAyB,CACzB,qBAAqB;AACrB,sBACD,CAAC,CAAC,IAAI,CAAE,GAAI,CAAE,CACd,CAAC,IAAI,CAAE,CAAE,CAAC,CAAE,EAAG,CAAE,EAAG,CACnB,SAAS,QAAQ,CAAE,IAAI,CAAE,CAAE,CAAE,CAC5B,OAAO,IAAI,CAAC,MAAO,CAAE,CAAE,CAAE,IAAI,CAAC,KAAK,CAAE,CAAC,CAAE,CAAE,CAAE,CAAE,GAAI,CAAE,IAAI,CACzD,CACA,MAAM,YAAa,CAAE,yCAA0C,CAAE,QAAQ,CAAE,EAAE,CAAC,SAAS,CAAE,GAAI,CAAE,CAC9F,cAAe,CAAE,QAAQ,CAAE,EAAE,CAAC,UAAU,CAAC,SAAS,CAAE,GAAI,CAAC,CAC1D,EAAE,CAAC,GAAG,CAAC,KAAK,CAAE,YAAa,CAAC,CAC5B,MAAM,GAAI,CAAE,IAAI,KAAK,CAAE,YAAa,CAAC,CACrC,GAAG,CAAC,IAAK,CAAE,sBAAsB,CACjC,EAAE,CAAC,WAAW,CAAC,QAAQ,CAAE,GAAG,CAAE,oBAAqB,CAAC,CACpD,CAAC,CAAE,EAAG,CAAC,CAAC,MAAM,CAAC,CAAC,CACjB,CAAE,CAAC,CAIJ,CAAC,CAAE,MAAO,CAAC,CAAC,IAAI,CAAE,qCAAsC,CAAC,CAAC,UAAU,CAAE,oBAAqB,CAAC,CAI5F,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,iBAAiB,CAAE,MAAM,CAAC,IAAK,CAAC,CAK3C,MAAO,iBAAkB,CAAE,EAAE,CAAC,eAAe,CAAE,MAAM,CAAC,eAAgB,CAAC,CACxE,CAAC,CASD,UAAU,CAAE,QAAS,CAAE,GAAG,CAAE,MAAO,CAAE,CACpC,OAAO,IAAI,CAAC,OAAO,CAAE,IAAI,CAAC,OAAO,CAAE,GAAG,CAAE,MAAO,CAAE,CAAC,CACnD,CAAC,CAYD,OAAO,CAAE,QAAS,CAAE,GAAG,CAAE,SAAS,CAAE,OAAQ,CAAE,CAC7C,OAAO,IAAI,CAAC,UAAU,CAAE,GAAI,CAAC,CAAC,IAAI,CAAE,CAAE,IAAK,CAAE,EAAG,IAAI,CAAC,QAAQ,CAC5D,IAAI,CACJ,IAAI,CACJ,SAAS,CACT,OACD,CAAE,CAAC,CACJ,CAAC,CAgBD,YAAY,CAAE,QAAS,CAAE,QAAQ,CAAE,SAAS,CAAE,OAAQ,CAAE,CACvD,OAAO,IAAI,CAAC,WAAW,CAAE,CAAC,CAAC,MAAM,CAAE,CAAE,QAAS,CAAC,CAAE,SAAU,CAAC,CAAE,OAAQ,CAAC,CACxE,CAAC,CAcD,QAAQ,CAAE,QAAS,CAAE,IAAI,CAAE,QAAQ,CAAE,SAAU,CAAE,CAAC,CAAC,CAAE,OAAQ,CAAE,CAAC,CAAE,CAAE;AACnE,IAAI,IAAI,CACR,EAAG,CAAE,QAAS,CAAE,CACf,IAAK,CAAE,CAAC,CAAC,MAAM,CAAE,CAAE,QAAQ,CAAE,QAAS,CAAC,CAAE,SAAU,CAAC,CACrD,CAAE,IAAK,CACN,IAAK,CAAE,CAAC,CAAC,MAAM,CAAE,CAAE,IAAK,CAAC,CAAE,SAAU,CAAC,CACvC,CACA,OAAO,IAAI,CAAC,WAAW,CAAE,IAAI,CAAE,OAAQ,CAAC,CAAC,IAAI,CAC5C,IAAI,CACJ,CAAE,IAAI,CAAE,QAAS,CAAE,EAAG,CAErB,EAAG,CAAE,OAAO,CAAC,cAAe,CAAE,CAC7B,OAAO,CAAC,cAAc,CAAC,CAAC,CACzB,CACA,EAAG,CAAE,IAAK,GAAI,aAAc,CAAE,CAE7B,OAAO,IAAI,CAAC,QAAQ,CACnB,IAAI,CACJ,IAAI,CACJ,SAAS,CACT,OACD,CAAC,CACF,CAEA,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAE,IAAI,CAAE,QAAS,CAAC,CAAC,OAAO,CAAC,CAAC,CACvD,CACD,CAAC,CACF,CAAC,CAgBD,WAAW,CAAE,QAAS,CAAE,IAAI,CAAE,OAAQ,CAAE,CAAC,CAAE,CAAE,CAC5C,MAAM,GAAI,CAAE,OAAO,CAAC,GAAI,EAAG,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,CAEvC,IAAI,KAAK,CACT,EAAG,CAAE,OAAO,CAAC,GAAI,CAAE,CAClB,KAAM,CAAE,OAAO,CAAC,GAAG,CAAC,CAAC,CACtB,CAEA,IAAK,CAAE,CAAC,CAAC,MAAM,CACd,CACC,MAAM,CAAE,kBAAkB,CAC1B,OAAO,CAAE,MAAM,CACf,OAAO,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,MAAO,CAAC,CAEhC,YAAY,CAAE,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,UAAW,CAAC,CAC3C,aAAa,CAAE,CAAC,CAChB,WAAW,CAAE,MAAM,CACnB,SAAS,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,gBAAiB,CAAC,CAC5C,cAAc,CAAE,IACjB,CAAC,CACD,IACD,CAAC,CAED,MAAM,MAAO,CAAE,IAAI,CAAC,MAAM,CAE1B,MAAM,OAAQ,CAAE,GAAG,CAAC,aAAa,CAAE,MAAM,CAAE,IAAI,CAAE,CAChD,WAAW,CAAE,qBAAqB,CAClC,6BAA6B,CAAE,IAChC,CAAE,CAAC,CAEH,OAAO,OAAO,CAAC,IAAI,CAClB,CAAE,QAAQ,CAAE,KAAM,CAAE,EAAG,CACtB,MAAM,YAAa,CAAE,QAAQ,CAAE,MAAO,CAAC,CAGvC,EAAG,CAAE,OAAO,CAAC,KAAM,EAAG,OAAO,CAAC,SAAU,CAAE,CACzC,MAAM,SAAU,CAAE,CACjB,KAAK,CAAE,OAAO,CAAE,kBAAmB,CAAC,CAAC,UAAU,CAAE,KAAK,CAAC,YAAa,CAAC;AACrE,QAAQ,CAAE,OAAO,CAAC,GAAG,CAAC,CAAE,CAAE,KAC3B,CAAC,CACD,MAAM,aAAc,CAAE,qBAAsB,CAAE,OAAO,CAAC,SAAU,CAC/D,CAAE,YAAY,CAAC,QAAS,CAAE,eAAgB,CAAE,kBAAmB,CAAC,CACjE,OAAO,CAAC,KAAK,CAAE,aAAa,CAAE,SAAU,CAAC,CAC1C,CAEA,IAAI,KAAK,CACT,EAAG,CAAE,CAAC,YAAa,CAAE,CACpB,KAAM,CAAE,CACP,IAAI,CAAE,iBAAiB,CACvB,IAAI,CAAE,EAAE,CAAC,OAAO,CAAE,sCAAuC,CAAC,CAAC,KAAK,CAAC,CAClE,CAAC,CACF,CAAE,KAAK,EAAG,CAAE,YAAY,CAAC,MAAO,GAAI,SAAU,CAAE,CAG/C,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAE,qBAAqB,CAAE,QAAS,CAAC,CAAC,OAAO,CAAC,CAAC,CACxE,CAAE,IAAK,CAEN,MAAO,CAAE,YAAY,CAAC,OAAQ,CAAE,CAC/B,IAAK,MAAM,CACX,IAAK,WAAW,CACf,EAAG,CAAE,OAAO,YAAY,CAAC,OAAQ,GAAI,QAAS,CAAE,CAC/C,KAAM,CAAE,CACP,IAAI,CAAE,gBAAgB,CACtB,IAAI,CAAE,EAAE,CAAC,OAAO,CAAE,sCAAuC,CAAC,CAAC,KAAK,CAAC,CAClE,CAAC,CACF,CACA,KAAK,CACN,IAAK,MAAM,CACV,EAAG,CAAE,OAAO,YAAY,CAAC,IAAK,GAAI,QAAS,CAAE,CAC5C,KAAM,CAAE,CACP,IAAI,CAAE,gBAAgB,CACtB,IAAI,CAAE,EAAE,CAAC,OAAO,CAAE,sCAAuC,CAAC,CAAC,KAAK,CAAC,CAClE,CAAC,CACF,CACA,KAAK,CACP,CACD,CAEA,EAAG,CAAE,KAAM,CAAE,CAEZ,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAE,KAAK,CAAC,IAAI,CAAE,CAAE,MAAM,CAAE,CAAE,KAAM,CAAE,CAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAC1E,CACA,OAAO,YAAY,CACpB,CAAC,CACD,CAAE,IAAI,CAAE,QAAS,CAAE,EAAG,CACrB,MAAM,YAAa,CAAE,EAAE,CAAC,OAAO,CAAE,QAAQ,CAAE,KAAK,CAAE,cAAe,CAAC,CAElE,EAAG,CAAE,YAAa,EAAG,OAAO,CAAC,KAAM,EAAG,OAAO,CAAC,SAAU,CAAE;AACzD,MAAM,SAAU,CAAE,CACjB,KAAK,CAAE,OAAO,CAAE,kBAAmB,CAAC,CAAC,UAAU,CAAE,YAAa,CAAC,CAC/D,QAAQ,CAAE,OAAO,CAAC,GAAG,CAAC,CAAE,CAAE,KAC3B,CAAC,CACD,IAAI,aAAa,CACjB,EAAG,CAAE,IAAK,GAAI,aAAc,CAAE,CAC7B,aAAc,CAAE,qBAAsB,CAAE,OAAO,CAAC,SAAU,CAAE,cAAc,CAC3E,CAAE,IAAK,CACN,aAAc,CAAE,qBAAsB,CAAE,OAAO,CAAC,SAAU,CAAE,kBAAkB,CAC/E,CACA,OAAO,CAAC,KAAK,CAAE,aAAa,CAAE,SAAU,CAAC,CAC1C,CACA,OAAO,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAE,IAAI,CAAE,QAAS,CAAC,CAAC,OAAO,CAAC,CAAC,CACvD,CACD,CAAC,CACF,CACD,CAAC,CACF,CAAC,CAAC,CAAE,CAAC"
}
},
{"offset":{"line":62,"column":0},"map":{
"version": 3,
"file": "/w/load.php?lang=ru&modules=ext.visualEditor.core.utils.parsing%7Cext.visualEditor.desktopArticleTarget.init%7Cext.visualEditor.progressBarWidget%2CsupportCheck%2CtargetLoader%2CtempWikitextEditorWidget%2Ctrack%2Cve&skin=vector&version=u9zxi",
"sources": ["/w/extensions/VisualEditor/modules/ve-mw/preinit/ve.init.mw.TempWikitextEditorWidget.js"],
"sourcesContent": ["/*!\n * VisualEditor MediaWiki temporary wikitext editor widget\n *\n * @copyright See AUTHORS.txt\n * @license The MIT License (MIT); see LICENSE.txt\n */\n\nmw.libs.ve = mw.libs.ve || {};\n\n/**\n * MediaWiki temporary wikitext editor widget\n *\n * This widget can be used to show the user a basic editing interface\n * while VE libraries are still loading.\n *\n * It has a similar API to OO.ui.InputWidget, but is designed to\n * be loaded before any core VE code or dependencies, e.g. OOUI.\n *\n * @class\n *\n * @constructor\n * @param {Object} config Configuration options\n * @param {string} config.value Raw wikitext to edit\n */\nmw.libs.ve.MWTempWikitextEditorWidget = function VeUiMwTempWikitextEditorWidget( config ) {\n\tconst conf = mw.config.get( 'wgVisualEditor' ),\n\t\tdir = conf.pageLanguageDir,\n\t\tlang = conf.pageLanguageCode;\n\n\tthis.$element = $( '<textarea>' )\n\t\t.addClass( 've-init-mw-tempWikitextEditorWidget ' )\n\t\t// The following classes are used here:\n\t\t// * mw-editfont-monospace\n\t\t// * mw-editfont-sans-serif\n\t\t// * mw-editfont-serif\n\t\t.addClass( 'mw-editfont-' + mw.user.options.get( 'editfont' ) )\n\t\t// The following classes are used here:\n\t\t// * mw-content-ltr\n\t\t// * mw-content-rtl\n\t\t.addClass( 'mw-content-' + dir )\n\t\t.attr( { lang, dir } )\n\t\t.val( config.value );\n};\n\n/**\n * Focus the input and move the cursor to the start.\n *\n * @return {mw.libs.ve.MWTempWikitextEditorWidget}\n * @chainable\n */\nmw.libs.ve.MWTempWikitextEditorWidget.prototype.moveCursorToStart = function () {\n\t// Move cursor to start\n\tthis.$element[ 0 ].setSelectionRange( 0, 0 );\n\tthis.focus();\n\treturn this;\n};\n\n/**\n * Expand the height of the text to fit the contents\n *\n * @return {mw.libs.ve.MWTempWikitextEditorWidget}\n * @chainable\n */\nmw.libs.ve.MWTempWikitextEditorWidget.prototype.adjustSize = function () {\n\t// Don't bother with reducing height for simplicity\n\tthis.$element.height( this.$element[ 0 ].scrollHeight );\n\treturn this;\n};\n\n/**\n * Focus the input\n *\n * @return {mw.libs.ve.MWTempWikitextEditorWidget}\n * @chainable\n */\nmw.libs.ve.MWTempWikitextEditorWidget.prototype.focus = function () {\n\tthis.$element[ 0 ].focus();\n\treturn this;\n};\n\n/**\n * @return {string} Raw, possibly edited wikitext\n */\nmw.libs.ve.MWTempWikitextEditorWidget.prototype.getValue = function () {\n\treturn this.$element.val();\n};\n\n/**\n * Get the selection range\n *\n * @return {Object} Object containing numbers 'from' and 'to'\n */\nmw.libs.ve.MWTempWikitextEditorWidget.prototype.getRange = function () {\n\tconst input = this.$element[ 0 ],\n\t\tstart = input.selectionStart,\n\t\tend = input.selectionEnd,\n\t\tisBackwards = input.selectionDirection === 'backward';\n\n\treturn {\n\t\tfrom: isBackwards ? end : start,\n\t\tto: isBackwards ? start : end\n\t};\n};\n"],
"names": [],
"mappings": "qHAOA,EAAE,CAAC,IAAI,CAAC,EAAG,CAAE,EAAE,CAAC,IAAI,CAAC,EAAG,EAAG,CAAC,CAAC,CAiB7B,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,0BAA2B,CAAE,SAAS,8BAA8B,CAAE,MAAO,CAAE,CACzF,MAAM,IAAK,CAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAE,gBAAiB,CAAC,CAC7C,GAAI,CAAE,IAAI,CAAC,eAAe,CAC1B,IAAK,CAAE,IAAI,CAAC,gBAAgB,CAE7B,IAAI,CAAC,QAAS,CAAE,CAAC,CAAE,YAAa,CAC/B,CAAC,QAAQ,CAAE,sCAAuC,CAKlD,CAAC,QAAQ,CAAE,cAAe,CAAE,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAE,UAAW,CAAE,CAI9D,CAAC,QAAQ,CAAE,aAAc,CAAE,GAAI,CAC/B,CAAC,IAAI,CAAE,CAAE,IAAI,CAAE,GAAI,CAAE,CACrB,CAAC,GAAG,CAAE,MAAM,CAAC,KAAM,CAAC,CACtB,CAAC,CAQD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,0BAA0B,CAAC,SAAS,CAAC,iBAAkB,CAAE,QAAS,CAAC,CAAE,CAE/E,IAAI,CAAC,QAAQ,CAAE,CAAE,CAAC,CAAC,iBAAiB,CAAE,CAAC,CAAE,CAAE,CAAC,CAC5C,IAAI,CAAC,KAAK,CAAC,CAAC,CACZ,OAAO,IAAI,CACZ,CAAC,CAQD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,0BAA0B,CAAC,SAAS,CAAC,UAAW,CAAE,QAAS,CAAC,CAAE,CAExE,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAE,IAAI,CAAC,QAAQ,CAAE,CAAE,CAAC,CAAC,YAAa,CAAC,CACvD,OAAO,IAAI,CACZ,CAAC,CAQD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,0BAA0B,CAAC,SAAS,CAAC,KAAM,CAAE,QAAS,CAAC,CAAE,CACnE,IAAI,CAAC,QAAQ,CAAE,CAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAC1B,OAAO,IAAI,CACZ,CAAC,CAKD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,0BAA0B,CAAC,SAAS,CAAC,QAAS,CAAE,QAAS,CAAC,CAAE,CACtE,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAC3B,CAAC,CAOD,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,0BAA0B,CAAC,SAAS,CAAC,QAAS,CAAE,QAAS,CAAC,CAAE,CACtE,MAAM,KAAM,CAAE,IAAI,CAAC,QAAQ,CAAE,CAAE,CAAC,CAC/B,KAAM,CAAE,KAAK,CAAC,cAAc;AAC5B,GAAI,CAAE,KAAK,CAAC,YAAY,CACxB,WAAY,CAAE,KAAK,CAAC,kBAAmB,GAAI,UAAU,CAEtD,MAAO,CACN,IAAI,CAAE,WAAY,CAAE,GAAI,CAAE,KAAK,CAC/B,EAAE,CAAE,WAAY,CAAE,KAAM,CAAE,GAC3B,CAAC,CACF,CAAC"
}
},
{"offset":{"line":65,"column":0},"map":{
"version": 3,
"file": "/w/load.php?lang=ru&modules=ext.visualEditor.core.utils.parsing%7Cext.visualEditor.desktopArticleTarget.init%7Cext.visualEditor.progressBarWidget%2CsupportCheck%2CtargetLoader%2CtempWikitextEditorWidget%2Ctrack%2Cve&skin=vector&version=u9zxi",
"sources": ["/w/extensions/VisualEditor/modules/ve-mw/ve.track.js"],
"sourcesContent": ["// In VE-MW, track events using MediaWiki's system instead of VisualEditor's\nve.track = mw.track;\nve.trackSubscribe = mw.trackSubscribe;\n\nve.trackSubscribe( 'activity.', ( topic, data ) => {\n\tmw.track( 'visualEditorFeatureUse', ve.extendObject( data, {\n\t\tfeature: topic.split( '.' )[ 1 ]\n\t} ) );\n} );\n"],
"names": [],
"mappings": "kGACA,EAAE,CAAC,KAAM,CAAE,EAAE,CAAC,KAAK,CACnB,EAAE,CAAC,cAAe,CAAE,EAAE,CAAC,cAAc,CAErC,EAAE,CAAC,cAAc,CAAE,WAAW,CAAE,CAAE,KAAK,CAAE,IAAK,CAAE,EAAG,CAClD,EAAE,CAAC,KAAK,CAAE,wBAAwB,CAAE,EAAE,CAAC,YAAY,CAAE,IAAI,CAAE,CAC1D,OAAO,CAAE,KAAK,CAAC,KAAK,CAAE,GAAI,CAAC,CAAE,CAAE,CAChC,CAAE,CAAE,CAAC,CACN,CAAE,CAAC"
}
},
{"offset":{"line":67,"column":0},"map":{
"version": 3,
"file": "/w/load.php?lang=ru&modules=ext.visualEditor.core.utils.parsing%7Cext.visualEditor.desktopArticleTarget.init%7Cext.visualEditor.progressBarWidget%2CsupportCheck%2CtargetLoader%2CtempWikitextEditorWidget%2Ctrack%2Cve&skin=vector&version=u9zxi",
"sources": ["/w/extensions/VisualEditor/lib/ve/src/ve.js"],
"sourcesContent": ["/*!\n * VisualEditor namespace.\n *\n * @copyright See AUTHORS.txt\n */\n\n/**\n * Namespace for all VisualEditor classes, static methods and static properties.\n *\n * @namespace ve\n */\nwindow.ve = {};\n\n/**\n * Get the current time, measured in milliseconds since January 1, 1970 (UTC).\n *\n * @return {number} Current time, monotonic in modern browsers (via Performance Timeline API)\n */\nve.now = function () {\n\t// Based on `mw.now` in MediaWiki core.\n\t// Optimisation: Cache and re-use the chosen implementation.\n\t// Optimisation: Avoid startup overhead by re-defining on first call instead of IIFE.\n\tconst perf = window.performance;\n\tconst navStart = perf && perf.timing && perf.timing.navigationStart;\n\tve.now = navStart && perf.now ?\n\t\tfunction () {\n\t\t\treturn navStart + perf.now();\n\t\t} : Date.now;\n\n\treturn ve.now();\n};\n"],
"names": [],
"mappings": "+FAWA,MAAM,CAAC,EAAG,CAAE,CAAC,CAAC,CAOd,EAAE,CAAC,GAAI,CAAE,QAAS,CAAC,CAAE,CAIpB,MAAM,IAAK,CAAE,MAAM,CAAC,WAAW,CAC/B,MAAM,QAAS,CAAE,IAAK,EAAG,IAAI,CAAC,MAAO,EAAG,IAAI,CAAC,MAAM,CAAC,eAAe,CACnE,EAAE,CAAC,GAAI,CAAE,QAAS,EAAG,IAAI,CAAC,GAAI,CAC7B,QAAS,CAAC,CAAE,CACX,OAAO,QAAS,CAAE,IAAI,CAAC,GAAG,CAAC,CAAC,CAC7B,CAAE,CAAE,IAAI,CAAC,GAAG,CAEb,OAAO,EAAE,CAAC,GAAG,CAAC,CAAC,CAChB,CAAC"
}
}
]
}