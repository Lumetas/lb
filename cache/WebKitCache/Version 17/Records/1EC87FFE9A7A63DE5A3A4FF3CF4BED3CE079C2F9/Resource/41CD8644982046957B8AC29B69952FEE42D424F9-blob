"use strict";(window.webpackChunk=window.webpackChunk||[]).push([[90083],{316222:(e,t,n)=>{n.r(t),n.d(t,{ACCESS_TOKEN_EXPIRATION_TIMESTAMP_KEY:()=>s,AUTH_TOKENS_UPDATING_ACTIVITY_ID:()=>u,AUTH_TOKENS_UPDATING_ACTIVITY_ID_TIMEOUT:()=>i,IS_AUTH_LOST:()=>l,IS_AUTH_RESTORED:()=>c,SHOULD_STOP_REQUESTS:()=>d,UPDATE_AUTH_TOKENS_TIMER_MAX_JITTER:()=>a,UPDATE_AUTH_TOKENS_TIMER_SAVE_OFFSET:()=>o});var r=n(909599),o=15*r.MINUTE,a=10*r.MINUTE,i=50,s="access_token_expires_at",u="auth_tokens_updating_activity_id",l="is_auth_lost",c="is_auth_restored",d="should_stop_requests"},429913:(e,t,n)=>{n.r(t),n.d(t,{IS_NEW_AUTH_ENABLED:()=>D,checkTimerTokens:()=>M,getAccessTokenExpirationTimestamp:()=>x,initCoreAuthManager:()=>z,isRequestAllowedToBeSent:()=>q,restoreAuth:()=>V,setCookie:()=>P,updateAuthTokens:()=>B});var r=n(629133),o=n.n(r),a=n(334254),i=n.n(a),s=n(130860),u=n.n(s),l=n(694615),c=n(367180),d=n(643095),f=n(744741),T=n(509372),_=n(778618),p=n(695195),h=n(403889),m=n(601236),A=n(909599),E=n(316222),v=n(661533);function y(e,t,n,r,o,a,i){try{var s=e[a](i),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,o)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){y(a,r,o,i,s,"next",e)}function s(e){y(a,r,o,i,s,"throw",e)}i(void 0)}))}}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){S(e,t,n[t])}))}return e}function O(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var w,g=function(e){return e},U=[],k={path:"/",session:!0,domain:".".concat((0,h.getDomain)())},D=!1,R=null,P=function(e,t){(0,T.set)(I({name:e,value:t},k))},N=function(e){(0,T.remove)(I({name:e},k))},C=function(){U.forEach((function(e){e()})),U=[]},H=function(){return Boolean((0,T.get)(E.IS_AUTH_LOST)||APP.auth_modal)},x=function(){return(0,T.get)(E.ACCESS_TOKEN_EXPIRATION_TIMESTAMP_KEY)},M=function(){var e=(0,A.getServerTime)(),t=x();e&&t||function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,d.captureException)(new Error("AuthManagerError: required cookies are missing."),e)}({serverTime:e,accessTokenExpirationTimestamp:t})},L=o().throttle((function(e){g(["[runUpdateActivity]: ",e])}),2e3),K=function(){g(["[isUpdatingTabActive]: check is tab updating tokens"]);var e=0;return new Promise((function(t,n){var r=function(o){(0,_.setWorkerTimeout)((function(){if(null===o&&t(void 0),g(["[isUpdatingTabActive]: activityId: ",(0,T.get)(E.AUTH_TOKENS_UPDATING_ACTIVITY_ID),"tab lifetime:",performance.now().toFixed(0),"lostAttempts: ",e]),o===(0,T.get)(E.AUTH_TOKENS_UPDATING_ACTIVITY_ID)&&++e>3)return N(E.AUTH_TOKENS_UPDATING_ACTIVITY_ID),n();r((0,T.get)(E.AUTH_TOKENS_UPDATING_ACTIVITY_ID))}),2*E.AUTH_TOKENS_UPDATING_ACTIVITY_ID_TIMEOUT)};r((0,T.get)(E.AUTH_TOKENS_UPDATING_ACTIVITY_ID))}))},V=function(){g(["[restoreAuth] remove all cookies: ",E.IS_AUTH_LOST,E.IS_AUTH_RESTORED,E.AUTH_TOKENS_UPDATING_ACTIVITY_ID,E.SHOULD_STOP_REQUESTS]),N(E.IS_AUTH_LOST),P(E.IS_AUTH_RESTORED,"y"),(0,_.setWorkerTimeout)((function(){N(E.IS_AUTH_RESTORED)}),2*T.COOKIE_LISTENER_INTERVAL_DELAY),N(E.AUTH_TOKENS_UPDATING_ACTIVITY_ID),N(E.SHOULD_STOP_REQUESTS)},Y=function(){return g(["[showAuthModal] start modal initialize"]),R&&(0,_.clearWorkerTimeout)(R),new Promise((function(e){APP.auth_modal?APP.auth_modal.subscribeOnSuccess((function(){e(void 0)})):(new c.default({success:function(){g(["[showAuthModal][success] auth restore"]),V(),M(),e(void 0)}}),g(["[showAuthModal] modal showed"]))}))},B=(w=b((function(e){var t,n,r;return O(this,(function(a){switch(a.label){case 0:if(!D)return[2];if(t=e.shouldStopRequests,g(["[updateAuthTokens] start token updating, shouldStopRequests: ",t]),t&&P(E.SHOULD_STOP_REQUESTS,"y"),!(0,T.get)(E.AUTH_TOKENS_UPDATING_ACTIVITY_ID))return[3,5];g(["[updateAuthTokens] tokens already updating (AUTH_TOKENS_UPDATING_ACTIVITY_ID), try isUpdatingTabActive"]),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,K()];case 2:return a.sent(),g(["[updateAuthTokens] tokens AUTH_TOKENS_UPDATING_ACTIVITY_ID removed on another tab"]),[3,4];case 3:return a.sent(),g(["[updateAuthTokens] tokens updating stucked, try updateAuthTokens again"]),B({shouldStopRequests:t}),[3,4];case 4:return[2];case 5:n=o().noop,g(["[updateAuthTokens] start update activity"]),a.label=6;case 6:if(a.trys.push([6,8,11,12]),i=0,(s=function(){var e=u()();L(e),g(["[runUpdateActivity] generate new activityId: ",e,"tab lifetime:",performance.now().toFixed(0)]),P(E.AUTH_TOKENS_UPDATING_ACTIVITY_ID,e),i=setTimeout(s,E.AUTH_TOKENS_UPDATING_ACTIVITY_ID_TIMEOUT)})(),n=function(){clearTimeout(i)},H())throw new Error("Auth already lost, we should not try update tokens");return[4,(0,p.promiseWithExponentialRetry)(l.updateAuthTokens,{isRetryable:function(e){var t=e.status;return t>=f.HttpStatusCode.INTERNAL_SERVER_ERROR&&t<=f.HttpStatusCode.NETWORK_CONNECT_TIMEOUT_ERROR}})];case 7:return r=a.sent().serverTime,P(A.SERVER_TIME_COOKIE_KEY,r),g(["[updateAuthTokens] tokens updated successfully"]),[3,12];case 8:return a.sent().status!==f.HttpStatusCode.UNAUTHORIZED?[3,10]:(g(["[updateAuthTokens] tokens updated with error, show authModal"]),P(E.IS_AUTH_LOST,"y"),[4,Y()]);case 9:a.sent(),a.label=10;case 10:return[3,12];case 11:return g(["[updateAuthTokens] stop update activity"]),N(E.AUTH_TOKENS_UPDATING_ACTIVITY_ID),N(E.SHOULD_STOP_REQUESTS),n(),[7];case 12:return[2]}var i,s}))})),function(e){return w.apply(this,arguments)}),G=performance.now(),F=(0,m.getRandom)({max:E.UPDATE_AUTH_TOKENS_TIMER_MAX_JITTER}),j=function(){var e=Number(x()),t=Number((0,A.getServerTime)());if(!e||!t)return g(["[getTokenLifetime]: exp. at: ",e,"[getTokenLifetime]: server_time: ",t]),0;var n=performance.now()-G,r=(e-t)*A.SECOND-E.UPDATE_AUTH_TOKENS_TIMER_SAVE_OFFSET-n;return r>0?r+F:0},W=function(){var e;D&&(g(["remaining update tokens timer time: \n".toLocaleUpperCase(),"".concat((j()/1e3/60).toFixed(2)," minutes \n"),"".concat((j()/1e3).toFixed(2)," seconds \n"),"jitter: \n".toLocaleUpperCase(),"".concat((F/1e3/60).toFixed(2)," minutes \n"),"".concat((F/1e3).toFixed(2)," seconds")]),g(["[verifyAuthFallback] checking token lifetime: ",j()]),j()?null===(e=APP.auth_modal)||void 0===e||e.destroy():B({shouldStopRequests:H()}))},q=function(){if(!D)return!0;if(e=!(0,T.get)(E.SHOULD_STOP_REQUESTS)&&!H(),g(["[_isRequestAllowedToBeSent]: ",e]),e)return W(),!1;var e;(0,T.get)(E.IS_AUTH_LOST)&&!APP.auth_modal&&Y();var t=v.Deferred();return U.push(t.resolve),t.promise()},Q=function(){var e,t=j();g(["set tokens timer time: \n".toLocaleUpperCase(),"".concat((t/1e3/60).toFixed(2)," minutes \n"),"".concat((t/1e3).toFixed(2)," seconds")]),g(["[runTimer] should set new timer, token lifetime: ",t]),R&&(0,_.clearWorkerTimeout)(R),t&&(null===(e=APP.auth_modal)||void 0===e||e.destroy()),R=(0,_.setWorkerTimeout)((function(){B({shouldStopRequests:!1})}),t||2*A.MINUTE)},z=function(){var e=b((function(e){var t,n;return O(this,(function(r){switch(r.label){case 0:if(!D)return[2];t=e.onLogsCollect,n=void 0===t?o().noop:t,g=n,i().change((function(){i().hidden()||H()||(g(["[listener] visibility, should run verify fallback"]),W())})),(0,T.listenCookie)({name:A.SERVER_TIME_COOKIE_KEY,listener:function(e){if(e.newValue)return g(["[listener] server_time, should set new timer"]),G=performance.now(),Q()}}),(0,T.listenCookie)({name:E.IS_AUTH_RESTORED,listener:function(e){var t;"y"===e.newValue&&x()&&(N(E.IS_AUTH_RESTORED),g(["[listener] auth_restored, should destroy auth modal"]),C(),null===(t=APP.auth_modal)||void 0===t||t.destroy())}}),(0,T.listenCookie)({name:E.IS_AUTH_LOST,listener:function(e){"y"!==e.newValue||APP.auth_modal||(g(["[listener] auth_lost, should show auth modal"]),Y())}}),(0,T.listenCookie)({name:E.SHOULD_STOP_REQUESTS,listener:function(e){var t;null===e.newValue&&x()&&(g(["[listener] SHOULD_STOP_REQUESTS: run callbacks",U]),C(),null===(t=APP.auth_modal)||void 0===t||t.destroy())}}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,K()];case 2:return r.sent(),Q(),[3,4];case 3:return r.sent(),H()||B({shouldStopRequests:!1}),[3,4];case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}()},104691:(e,t,n)=>{n.r(t)},715394:(e,t,n)=>{n.r(t),n.d(t,{IS_NEW_AUTH_ENABLED:()=>r.IS_NEW_AUTH_ENABLED,UpdateAuthTokensResponse:()=>o.UpdateAuthTokensResponse,getAccessTokenExpirationTimestamp:()=>r.getAccessTokenExpirationTimestamp,initCoreAuthManager:()=>r.initCoreAuthManager,isRequestAllowedToBeSent:()=>r.isRequestAllowedToBeSent,restoreAuth:()=>r.restoreAuth,updateAuthTokens:()=>r.updateAuthTokens});var r=n(429913),o=n(104691)},367180:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var r=n(661533),o=n.n(r),a=n(313981);const i=a.default.extend({subscribeOnSuccess:function(e){this.successCallbacks||(this.successCallbacks=[]),this.successCallbacks.push(e)},initialize:function(e){a.default.prototype.initialize.apply(this,arguments),this.options=e,this._$body.css("overflow","hidden").prepend(['<div id="session_end_modal" class="session_end_modal" style="position:fixed; top:0; height:100%; width:100%; z-index:var(--session-end-modal-z-index); left:0">','<iframe name="session_end_frame" style="width:100%; height:100%; position:fixed; z-index:9999999;" src="/private/account/restore_session.php"></iframe>',"</div>"].join("")),this.setElement(o()("#session_end_modal")),APP.auth_modal=this},destroy:function(){var e;this._$body.css("overflow",""),a.default.prototype.destroy.call(this,!0),delete APP.auth_modal,this.options.success(),null===(e=this.successCallbacks)||void 0===e||e.forEach((function(e){return e()}))}});var s="../build/transpiled/core/auth/modal";window.define(s,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([s])},432708:(e,t,n)=>{n.r(t),n.d(t,{awaitedPromiseCall:()=>r});var r=function(e){var t=e.promise,n=e.condition;return n&&"boolean"!=typeof n?n.then(t):t()}},695195:(e,t,n)=>{n.r(t),n.d(t,{awaitedPromiseCall:()=>o.awaitedPromiseCall,promiseWithExponentialRetry:()=>r.promiseWithExponentialRetry});var r=n(593868),o=n(432708)},656569:(e,t,n)=>{n.r(t),n.d(t,{makeBackoff:()=>l});var r=n(629133),o=n.n(r),a=n(601236);function i(e,t,n,r,o,a,i){try{var s=e[a](i),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,o)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u={numOfAttempts:4,startingDelay:100,maxDelay:1/0,timeMultiple:2,isRetryable:o().constant(!0)},l=function(e){var t,n,r,o=(r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){s(e,t,n[t])}))}return e}({},u,arguments.length>1&&void 0!==arguments[1]?arguments[1]:u),r.numOfAttempts<1&&(r.numOfAttempts=1),r),l=o.numOfAttempts,c=o.isRetryable,d=o.maxDelay,f=o.startingDelay,T=o.timeMultiple,_=0,p=function(){return _>=l},h=(t=function(){var t;return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,(function(n){switch(n.label){case 0:if(p())return[3,5];n.label=1;case 1:return n.trys.push([1,4,,5]),[4,(r=function(e){var t=e.attemptNumber,n=e.maxDelay,r=e.startingDelay,o=e.timeMultiple,i=function(){var e=o,a=t,i=r*Math.pow(e,a);return Math.min(i,n)};return{getJitteredDelay:function(){return i()+(0,a.getRandom)({max:1e4})},getDelay:i}}({attemptNumber:_,maxDelay:d,startingDelay:f,timeMultiple:T}).getJitteredDelay,o=r(),_||(o=0),new Promise((function(e){setTimeout(e,o)})))];case 2:return n.sent(),[4,e()];case 3:return[2,n.sent()];case 4:if(t=n.sent(),_+=1,c(t)&&!p())return[2,h()];throw t;case 5:return[2]}var r,o}))},n=function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function s(e){i(a,r,o,s,u,"next",e)}function u(e){i(a,r,o,s,u,"throw",e)}s(void 0)}))},function(){return n.apply(this,arguments)});return h()}},103634:(e,t,n)=>{n.r(t),n.d(t,{MakeRetryOptions:()=>r.MakeRetryOptions,backOff:()=>r.makeBackoff});var r=n(656569)},593868:(e,t,n)=>{n.r(t),n.d(t,{promiseWithExponentialRetry:()=>i});var r=n(629133),o=n(103634);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i=function(e,t){var n=t.numOfAttempts,i=void 0===n?4:n,s=t.startingDelay,u=void 0===s?100:s,l=t.isRetryable;return function(e,t){var n=t.numOfAttempts,i=void 0===n?4:n,s=t.startingDelay,u=void 0===s?100:s,l=t.isRetryable,c=void 0===l?(0,r.constant)(!0):l,d=-1;return(0,o.backOff)((function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return d+=1,e.apply(void 0,(o=n,function(e){if(Array.isArray(e))return a(e)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([d]));var o}),{numOfAttempts:i,startingDelay:u,isRetryable:c})}(e,{numOfAttempts:i,startingDelay:u,isRetryable:void 0===l?(0,r.constant)(!0):l})}},63653:(e,t,n)=>{n.r(t),n.d(t,{getRandom:()=>r});var r=function(e){var t=e.max,n=e.min,r=void 0===n?0:n;return Math.round(r+Math.random()*(t-r))}},601236:(e,t,n)=>{n.r(t),n.d(t,{getRandom:()=>r.getRandom});var r=n(63653)},560399:(e,t,n)=>{n.r(t),n.d(t,{subscribeToTabsBroadcast:()=>r.subscribeToTabsBroadcast});var r=n(519598)},519598:(e,t,n)=>{n.r(t),n.d(t,{subscribeToTabsBroadcast:()=>r.subscribeToTabsBroadcast});var r=n(764869)},764869:(e,t,n)=>{n.r(t),n.d(t,{subscribeToTabsBroadcast:()=>a});var r=n(629133),o=n.n(r),a=function(e,t){return window.BroadcastChannel&&o().isFunction(window.BroadcastChannel)?function(e,t){var n=new BroadcastChannel(e);return n.addEventListener("message",(function(e){t(e.data)})),function(){n.close()}}(e,t):function(e,t){localStorage.removeItem(e);var n=function(n){var r;n.storageArea===localStorage&&n.key===e&&(t(null!==(r=n.newValue)&&void 0!==r?r:""),localStorage.removeItem(e))};return window.addEventListener("storage",n),function(){window.removeEventListener("storage",n)}}(e,t)}}}]);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"build_2025_11_28_18_50_52"},function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="bf8caf48-da79-4a9c-9c1d-9ca42c9280ae",e._sentryDebugIdIdentifier="sentry-dbid-bf8caf48-da79-4a9c-9c1d-9ca42c9280ae")}catch(e){}}();
//# sourceMappingURL=90083.15fd6868b30fff422baf.js.map