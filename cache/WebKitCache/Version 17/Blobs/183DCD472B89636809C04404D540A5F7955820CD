"use strict";(window.webpackChunk=window.webpackChunk||[]).push([[37107],{537107:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var o=n(661533),r=n.n(o),i=n(629133),a=n.n(i),s=n(460159),l=n.n(s),u=n(809228),c=n.n(u),_=n(267651),d=n.n(_),h=n(313981),m=n(445368),f=n(500034),v=n(450422),p=n(998798),g=n(926168),y=n(859200),b=n(509372),w=n(922789),C=n(779971);function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function S(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}function A(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){S(i,o,r,a,s,"next",e)}function s(e){S(i,o,r,a,s,"throw",e)}a(void 0)}))}}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(i.push(o.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var E=["leads","catalogs"],T="/settings/profile/",I="";const j=new(h.default.extend({el:r()(document),entities:{leads:"leads",whatsapp:"whatsapp",catalogs:"catalogs",contacts:"catalogs",companies:"contacts",events:"stats",statsCalls:"stats",statsOperday:"stats","todo-line":"todo",authlog:"settings",widgetsSettings:"amo-market",dev:"settings",mail:"mail",home:"home"},setTelephonyState:function(e){var t=e||{},n=t.isEnabled,o=t.onClick,i=t.ns;if(n){if(!o||!i)return;var a=r()("#left_menu .nav__notifications");return a.find(".calls-list-toggler").length||(r()("#left_menu .nav__notifications").append('<div class="calls-list-toggler"><div class="calls-list-toggler__wrapper"></div><div class="calls-list-toggler__icon"><span class="nav__notifications__counter nav__notifications-call-list__counter js-notifications_call_list_counter" style="display:none;">0</span></div></div>').prepareTransition().addClass("nav__notifications-call-list"),a.addClass("calls-list-active")),I&&r()(document).off(I),r()(document).on("click".concat(i),".calls-list-toggler__wrapper, .calls-list-toggler__icon",(function(e){o.call(this),e.stopPropagation()})),void(I=i)}var s=r()("#left_menu .nav__notifications");s.find(".calls-list-toggler").length&&(s.prepareTransition().removeClass("nav__notifications-call-list").find(".calls-list-toggler").remove(),r()(document).off("click".concat(i)),s.removeClass("calls-list-active")),I&&r()(document).off(I)},_matching_entities:{leads:["leads"],whatsapp:["whatsapp"],catalogs:["companies","contacts","files","catalogs"],settings:["authlog","dev","widgetsSettings","advanced"],stats:["statsCalls","events","statsOperday","advanced"],mail:["mail"],"amo-market":["widgetsSettings"]},_partially_matchable:["chats"],_classes:function(){return{nav_top:"nav__top",nav_top_wrapper:"nav__top__wrapper",operday_holder:"nav__top__operday-holder",item:"nav__menu__item",item_selected:"nav__menu__item-selected",copy:"js-copy-account-id",support_body:"project_info-body-support",logo:"project_info-body-logo",themes_switcher:"js-themes-switcher"}},_selectors:function(){return{left_menu:"#left_menu",links:".nav__menu__item__link",loader:"#page_change_progress",nav_menu_up:"#nav_menu_up",nav_menu_down:"#nav_menu_down",nav_menu:"#nav_menu",nav_menu_wrapper:".nav__menu-wrapper",nav_item_by_entity:'.nav__menu__item[data-entity="%s"]',widget_naw_item:'.nav__menu__item[data-widget-code="%(widget_code)s"][data-widget-item="%(widget_item)s"]',overlay:"#left-menu-overlay:not(.hover-overlay)",current_account:".nav__top__userbar_useraccounts__item--current",menu_blocker:".js-operday-menu-blocker",avatar:".js-avatar-wrapper .js-left-avatar",avatar_overlay:".js-left-avatar-overlay",nvTooltip:".js-avatar-snv-tooltip"}},document_events:function(){return{"menu:start-hover":"startHoverMenu","menu:stop-hover":"stopHoverMenu"}},initialize:function(){for(var e,t,n=this,o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];h.default.prototype.initialize.apply(this,r),e=this._elem("item_selected");var s=this._getCompleteMatchUrlItem();a().isUndefined(s)||(e.removeClass(this._class("item_selected")),(e=s).addClass(this._class("item_selected"))),"Kommo"===APP.constant("current_brand")&&this._elem("logo").addClass("logo-kommo"),this.themes_switcher_mounted=!1,this.$_selected_item=e.length?e:void 0,this.smooth_scroll_interval=null,this.toggle_menu_blocked=!1,this.initEvents(),this._addComponent(c(),".js-copy-account-id").on("success",a().bind((function(){this._elem("copy").addClass("js-copied"),a().delay(a().bind((function(){this._elem("copy").removeClass("js-copied")}),this),800)}),this)).on("error",a().bind((function(){this._elem("copy").addClass("animated shake"),a().delay(a().bind((function(){this._elem("copy").removeClass("animated shake")}),this),200)}),this)),(0,f.isFeatureAvailable)("operday")&&(0,y.getRights)("oper_day_user_tracking")&&(this.operday=this._addComponent(w.default,{$holder:this._elem("operday_holder"),start_time:Math.floor(Date.now()/1e3),onShowMenuAndBlock:a().bind(this.handleShowMenuAndBlock,this),onUnblockMenu:a().bind(this.handleUnblockMenu,this),onBlockMenu:a().bind(this.handleBlockMenu,this),onCloseMenu:a().bind(this.handleCloseMenu,this)})),(0,v.isAmoChatsFullEnabled)()||(0,f.isFeatureAvailable)(f.Features.SYSTEM_NAVIGATION_V2)||(t=d().subscribe("hover_menu:show",a().bind((function(e,n){this.initHoverMenu((function(){d().unsubscribe(t),d().publish("hover_menu:show",n)}))}),this))),C.user.subscribeAvatarChange((function(e){n.setAvatarUrl(e)}))},_common_events:{"menu:loader:change":"onLoaderChange","page:change:start":"onPageChangeStart","page:change:stop":"onPageChangeStop","page:entity_changed":"onEntityChanged","menu:icon:restore":"onEntityChanged","menu:item:deleted":"onItemDelete","click .js-support":"onSupportClick","click .js-manage-profile":"onManageProfileClick","click .js-account-id":"onAccountIdClick","click .js-logout":"onLogoutClick","click .nav__top":"onNavTopClick","click .user-select-overlay":"onNavTopClick","click .account_selection":"onAccountSelectionClick","click .nav__menu__item":"onMenuClick"},_touch_events:{"scroll .nav__menu-wrapper":"onTouchScroll"},_desktop_events:{"menu:scroll .nav__menu-wrapper":"onMenuScroll","menu:scroll:revert":"onMenuScrollRevert","mousewheel .nav__menu-wrapper":"onWheelScroll","mouseleave #left_menu":"onMouseLeave","mouseenter #nav_menu_down":"onMouseEnter","mouseenter #nav_menu_up":"onMouseEnter","mouseenter #left_menu":"onMouseEnterInitHoverMenu"},_templates:["/tmpl/left_menu/aside.twig"],initEvents:function(){var e=APP.is_touch_device?this._touch_events:this._desktop_events;this.events=a().extend(this._common_events,e),APP.router&&this.listenTo(APP.router,"route",a().bind(this.onRouteChanged,this)),this.delegateEvents()},showNavigationAvatarPromotionTooltip:function(){return A((function(){var e,t,o;return M(this,(function(r){switch(r.label){case 0:return(e=this).avatarTooltipInitialized?[3,2]:(e.avatarTooltipInitialized=!0,[4,Promise.all([Promise.all([n.e(68592),n.e(91446),n.e(95882),n.e(70013),n.e(76265),n.e(3473),n.e(51974),n.e(4163),n.e(59769),n.e(48098),n.e(11958),n.e(8232),n.e(67914),n.e(42315),n.e(9034),n.e(72180),n.e(60794),n.e(37061),n.e(35817),n.e(4483),n.e(12915),n.e(97764),n.e(91498),n.e(96186),n.e(74211),n.e(35370),n.e(10462)]).then(n.bind(n,821630)),l()._preload("langs/navigationAvatarTooltip")()])]);case 1:t=P.apply(void 0,[r.sent(),1]),o=t[0].NavigationAvatarPromotionTooltipView,e.avatarTooltip=e._addComponent(o,{innerElement:e._elem("avatar"),el:e._elem("nvTooltip"),onDestroy:function(){e.avatarTooltipInitialized=!1,e.avatarTooltip=null}}),r.label=2;case 2:return[2]}}))})).apply(this)},setAvatarUrl:function(e){var t=this._elem("avatar").css("background-image"),n=null==t?void 0:t.replace(/"[^,]*"/,'"'.concat(e,'"'));this._elem("avatar_overlay").hide(),this._elem("avatar").css("background-image",n)},getItem:function(e){return a().isEmpty(e.widgetCode)||a().isEmpty(e.widgetItem)?a().isEmpty(e.id)?[]:this._elem("nav_item_by_entity",e.id):this._findElem("widget_naw_item",{widget_code:e.widgetCode,widget_item:e.widgetItem})},addMenuItem:function(e){var t={};t.item={label:e.item_label,description:e.item_description,link:e.item_code,selected:!1},t.item_name=e.item_name;var n=l()({ref:"/tmpl/settings/menu_item.twig"}).render(t);r()("#sidebar").find(".filter__list").append(n)},removeMenuItem:function(e){r()("#".concat(e)).remove()},updateItemCounter:function(e){var t=this.getItem(e);return t.length?(e.count<=0?t.find(".js-notifications_counter").hide():t.find(".js-notifications_counter").html(e.count).show(),this):this},onAccountSelectionClick:function(e){this._elem("nav_top").removeClass("expanded"),r()(e.currentTarget).hide().removeClass("account_selection"),this._elem("nav_top_wrapper").removeClass("expanded")},onNavTopClick:function(){if(this.isNotificationsExpanded()||this.toggle_menu_blocked)return!1;this.toggleLeftMenu()},toggleLeftMenu:function(){var e=this;this.hover_menu&&this.hover_menu.isHoverMenuVisible()&&this.closeHoverMenu(),this.toggleSubmenus();var t=this._elem("nav_top").hasClass("expanded");this.toggleOverlay(t).toggleClass("user-select-overlay",t),this.toggleSupportButton(),t&&(this._elem("current_account").length&&this._elem("current_account").get(0).scrollIntoView(!0),this.operday&&this.operday.onRerenderWorkspace(),(0,f.isFeatureAvailable)(f.Features.SYSTEM_NAVIGATION_V2_VIEWABLE)&&Promise.all([Promise.all([n.e(68592),n.e(51974),n.e(4163),n.e(4483),n.e(24907)]).then(n.bind(n,450368)),l()._preload("langs/leftMenuPromotion")()]).then((function(t){var n=P(t,1)[0].default;e.leftMenuPromotionPopup=e._addComponent(n,{onClick:function(){e.toggleLeftMenu()}})})))},onLogoutClick:function(e){window.location.href=r()(e.currentTarget).find("a").attr("href")},onAccountIdClick:function(e){e.stopPropagation()},onManageProfileClick:function(e){if(e.stopPropagation(),this.toggle_menu_blocked)return!1;if(this.avatarTooltip&&this.avatarTooltip.destroy(),e.metaKey||e.ctrlKey){var t=window.open();t.opener=null,t.location=T}else APP.router.navigate(T,{trigger:!0}),this.toggleSubmenus(!1),this.toggleOverlay(!1);return!1},onSupportClick:function(e){if(e.preventDefault(),this.toggle_menu_blocked){if((0,g.isCustomers)())return;(0,p.openSupportChat)(!0)}else(0,p.openSupportChat)();this.toggleSubmenus(!1),this.toggleOverlay(!1)},handleShowMenuAndBlock:function(){this.onNavTopClick(),this.handleBlockMenu()},handleCloseMenu:function(){this.onNavTopClick()},handleUnblockMenu:function(){this.toggle_menu_blocked=!1,this._elem("menu_blocker").hide()},handleBlockMenu:function(){this.toggle_menu_blocked=!0,this._elem("menu_blocker").show()},isNotificationsExpanded:function(){return this.$notifications||(this.$notifications=r()("#sidebar-notifications")),this.$notifications.hasClass("aside-expanded")},toggleSubmenus:function(e){this._elem("nav_top").toggleClass("expanded",e),this._elem("nav_top_wrapper").toggleClass("expanded",e),this._elem("left_menu").toggleClass("h-elevated",e),this._elem("operday_holder").toggleClass("expanded",e),this.themes_switcher_mounted?this._elem("themes_switcher").toggleClass("expanded",e):this.initThemesSwitcher(e)},initThemesSwitcher:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],o=this;t&&Promise.all([n.e(51974),n.e(57803)]).then(n.bind(n,557803)).then((function(n){var r=n.default;o._addComponent(r,{el:o._elem("themes_switcher")}),e.themes_switcher_mounted=!0,e._elem("themes_switcher").toggleClass("expanded",t)}))},toggleSupportButton:function(){APP.constant("account").amojo_enabled||this._elem("support_body").addClass("".concat(this._class("support_body"),"_disabled")).find(".button-input-inner__text").text((0,m.i18n)("The service is not available at the moment"))},toggleOverlay:function(e){return e?this._$document.trigger("overlay:fix"):this._findElem("overlay").hasClass("default-overlay-visible")&&this._$document.trigger("overlay:unfix"),this.leftMenuPromotionPopup&&!e&&this.leftMenuPromotionPopup.destroy(),this._findElem("overlay").removeClass("user-select-overlay").toggleClass("default-overlay-visible",e),this._elem("overlay")},setHelperBottomOffset:function(e){e.css("bottom",0),e.css("top","unset")},initHoverMenu:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a().noop;if(this.pending_hover_initialization)return this.pending_hover_initialization;this.pending_hover_initialization=new Promise((function(o){e.hover_menu||(0,v.isAmoChatsFullEnabled)()||Promise.all([n.e(68592),n.e(95882),n.e(59913),n.e(11958),n.e(72180),n.e(4483),n.e(95626)]).then(n.bind(n,793320)).then((function(t){var n=t.default;return e.hover_menu=new n({isNotificationsExpanded:a().bind(e.isNotificationsExpanded,e)}),e.hover_menu.init({requestAt:e._initHoverMenuRequestAt})})).then((function(){APP.is_touch_device||(e.onMenuScrollInit(),e._$window.on("resize",a().debounce(a().bind(e.onMenuScrollInit,e),200))),t(),o()}))}))},onPageChangeStart:function(){this._elem("loader").closest(this._selector("item")).hasClass(this._class("item_selected"))&&this._elem("loader").removeClass("stopped")},onPageChangeStop:function(){this._elem("loader").addClass("stopped")},getItemInfo:function(e){if(e||(e=this._getSelected()),!this._getSelected())return{is_sub_item:!1,main_entity:"",id:""};var t=this._getSelected().data("entity").split("_");return{is_sub_item:E.includes(t[0])&&!a().isUndefined(t[1]),main_entity:t[0],id:t.slice(1).join("_")||""}},onLoaderChange:function(){var e=this._elem("loader").show(),t=this.getItemInfo(this._getSelected()),n=APP.getBaseEntity();this.entities[n]&&(n=this.entities[n]),t.is_sub_item&&(n="".concat(t.main_entity,"_").concat(t.id)),this._elem("nav_item_by_entity",n).find(".nav__menu__item__icon").append(e)},onTouchScroll:function(e){var t=r()(e.currentTarget).scrollTop()>0;this._elem("nav_menu_up").toggleClass("nav__menu-scroller-showed",t),this._elem("nav_menu_down").toggleClass("nav__menu-scroller-showed",!t)},_linearToPower:function(e,t,n,o){var r=(n[1]-n[0])/(Math.pow(t[0],o)+Math.pow(t[1],o)),i=n[1]-Math.pow(t[1],o)*r;return r*Math.pow(e,o)+i},_stopSmoothScrollInterval:function(){clearInterval(this.smooth_scroll_interval),this.smooth_scroll_interval=null},_reinitSmoothScrollInterval:function(e,t,n){var o=Math.floor(this._linearToPower(e,[0,100],[25,1],.5)),r=this._elem("nav_menu_wrapper");this._stopSmoothScrollInterval(),this.smooth_scroll_interval=setInterval(a().bind((function(){this._scrollNotEnd(n)?r.scrollTop(r.scrollTop()+t):this.onMouseEnter(n)}),this),o)},offSmoothScroll:function(){this._stopSmoothScrollInterval(),this._elem("nav_menu_up").off(".smooth_scroll"),this._elem("nav_menu_down").off(".smooth_scroll")},startSmoothScroll:function(e){var t=r()(e.currentTarget),n=t.height(),o="nav_menu_up"===t.attr("id")?-3:3,i=100/n*("nav_menu_up"===t.attr("id")?n-e.offsetY:e.offsetY);this._reinitSmoothScrollInterval(i,o,e)},_scrollNotEnd:function(e){var t=r()(e.currentTarget),n=this._elem("nav_menu_wrapper"),o=n[0].scrollHeight,i=n[0].scrollTop,a=n[0].offsetHeight,s=t.attr("id");return i>0&&"nav_menu_up"===s||i+a<o&&"nav_menu_down"===s},onMouseEnterInitHoverMenu:function(e){var t=performance.now();this.initHoverMenu((function(){r()(e.target).trigger("mouseenter",[{requestAt:t}])}))},onMouseEnter:function(e){var t,n=r()(e.currentTarget),o=this._elem("nav_menu_wrapper"),i=this._elem("nav_menu").outerHeight(!0),s=o.height();if(this.offSmoothScroll(),this._scrollNotEnd(e))return n.on("mousemove.smooth_scroll",a().bind(this.startSmoothScroll,this)),n.on("mouseleave.smooth_scroll",a().bind(this.offSmoothScroll,this)),this._elem("nav_menu_up").addClass("nav__menu-scroller-showed"),void this._elem("nav_menu_down").addClass("nav__menu-scroller-showed");t="nav_menu_down"===n.attr("id")?i-s:0,i>s&&(o.trigger("menu:scroll",[t]),e.stopPropagation())},onMouseLeave:function(){this._$document.trigger("menu:scroll:revert")},onMenuScrollRevert:function(){var e=this._elem("nav_menu"),t=this._elem("nav_menu_wrapper"),n=e.children(".nav__menu__item-selected"),o=Math.floor(t.height()/72),i=n.length?n[0].offsetTop-72*Math.floor(o/2):0;APP.is_touch_device||a().delay((function(){r()("#sidebar").hasClass("aside-expanded")||t.trigger("menu:scroll",[i])}),150)},onMenuScrollInit:function(){var e=this._elem("nav_menu_wrapper").get(0),t=this._elem("nav_menu_wrapper").scrollTop(),n=t>0,o=e&&e.scrollHeight>e.offsetHeight&&e.scrollHeight!==e.offsetHeight+t;this._elem("nav_menu_up").toggleClass("nav__menu-scroller-showed",n),this._elem("nav_menu_down").toggleClass("nav__menu-scroller-showed",o),o&&this._$document.trigger("menu:scroll:revert")},onMenuScroll:function(e,t){var n=r()(e.currentTarget),o=n[0].scrollHeight>n[0].offsetHeight,i=t>0&&o,a=t+n.height()<n.children(".nav__menu").outerHeight(!0)&&o;n.animate({scrollTop:t},100),this._elem("nav_menu_up").toggleClass("nav__menu-scroller-showed",i),this._elem("nav_menu_down").toggleClass("nav__menu-scroller-showed",a)},onWheelScroll:function(e){var t=this._elem("nav_menu_wrapper").get(0),n=this._elem("nav_menu_wrapper").scrollTop()-e.deltaY;this._elem("nav_menu_up").toggleClass("nav__menu-scroller-showed",n>0),this._elem("nav_menu_down").toggleClass("nav__menu-scroller-showed",t.scrollHeight>t.offsetHeight&&t.scrollHeight>t.offsetHeight+n)},onMenuClick:function(e){var t=this,n=r()(e.currentTarget),o=n.data("entity");if(this.toggle_menu_blocked)return!1;e.stopPropagation(),e.ctrlKey||e.metaKey||(e.preventDefault(),APP.is_touch_device?this.initHoverMenu().then((function(){t.hover_menu.checkTouchClick(e,o).done((function(){t._onMenuClick(n)}))})):this._onMenuClick(n))},_onMenuClick:function(e){return A((function(){var t,n;return M(this,(function(o){return this.toggleSubmenus(!1),this.toggleOverlay(!1),e.hasClass("nav__menu__item-selected")||this._$document.trigger("page:change:start"),this._elem("left_menu").find(".nav__menu__item").removeClass("nav__menu__item-selected"),e.addClass("nav__menu__item-selected"),this.$_selected_item=e,t=e.children("a").attr("href"),n=this._isStrictPipelineRoute(t)?this._transformLeadsRoute(t):t,APP.router.navigate(n,{trigger:!0}),[2]}))})).apply(this)},_isStrictPipelineRoute:function(e){return e.startsWith("/leads/pipeline")},_transformLeadsRoute:function(e){var t;if(!(null===(t=(0,b.get)("LAST_PLACE_DEALS"))||void 0===t?void 0:t.startsWith("list")))return e;var n=e.split("/");return n.splice(2,0,"list"),n.join("/")},onItemDelete:function(e,t,n){var o;switch(t){case"leads":case"catalogs":(o=this._elem("nav_item_by_entity","".concat(t,"_").concat(n.id))).hasClass(this._class("item_selected"))&&(this.$_selected_item=this._elem("nav_item_by_entity",t),this.$_selected_item.addClass(this._class("item_selected"))),o.remove(),this._dropElemCache()}},_getCompleteMatchUrlItem:function(){var e,t,n=this;return this._elem("links").each((function(){var o=r()(this),i=o.attr("href"),s=o.parent().attr("data-entity");window.location.pathname===o.attr("href")?e=o.closest(".nav__menu__item"):i&&a().contains(n._partially_matchable,s)&&window.location.pathname.split("/")[1]===i.split("/")[1]&&(t=o.closest(".nav__menu__item"))})),e||t},_getSubEntityId:function(e){var t,n=window.location.pathname;switch(e){case"leads":if("/"===n[n.length-1]&&(n=n.slice(0,-1)),t=n.split("/").slice(-1)[0],isNaN(Number(t)))return"";break;case"catalogs":if(location.pathname.split("/")[1])switch(n.split("/").slice(-2,-1)[0]){case"list":t="contacts_and_companies";break;case"companies":t="companies";break;case"contacts":t="contacts";break;case"catalogs":if(t=n.split("/").slice(-1)[0],isNaN(Number(t)))return"";break;default:return""}break;default:return""}return t},_getSelected:function(){if(this.$_selected_item&&this.$_selected_item.length)return this.$_selected_item},_isNeedChange:function(){var e=this._getSelected(),t=APP.getBaseEntity(),n=this._matching_entities,o=this._getCompleteMatchUrlItem();if(!a().isUndefined(o)&&o!==e)return!0;if(!e)return!1;var r=e.attr("data-entity").split("_")[0];return t===r&&this._getSelected()&&this.$_selected_item.addClass("nav__menu__item-selected"),this._getSelected()&&this.$_selected_item.addClass("nav__menu__item-selected"),!(t===r||Object.prototype.hasOwnProperty.call(n,r)&&a().contains(n[r],t))},_isChangeCandidate:function(e){var t,n,o,r=e.attr("data-entity"),i=this._matching_entities,s=this._getCompleteMatchUrlItem(),l=APP.getBaseEntity();if(!a().propertyOf(s)(0)){if(r===l||Object.prototype.hasOwnProperty.call(i,r)&&a().contains(i[r],l))return!0;if(t=r.split("_")[0],n=r.split("_").slice(1).join("_"),E.includes(t))return""!==(o=this._getSubEntityId(t))&&Object.prototype.hasOwnProperty.call(i,t)&&a().contains(i[t],l)&&o===n}return a().propertyOf(s)(0)===a().propertyOf(e)(0)},onRouteChanged:function(e){this._isNeedChange()?this.onEntityChanged(e):this._$document.trigger("menu:loader:change")},onEntityChanged:function(){var e=APP.getBaseEntity(),t=this._isNeedChange(),n=this;this._elem("left_menu").find(".nav__menu__item").removeClass("js-new-selected").each((function(){var o=r()(this);if(o.hasClass("nav__menu__item-selected")&&!o.hasClass("js-new-selected")&&(t||"widget"===e&&o.data("widget-code")!==APP.getWidgetsArea().split(":")[1]&&o.data("widget-item")!==APP.getWidgetsArea().split(":")[2]&&o.hasClass("nav__menu__item__icon-integration"))&&o.removeClass("nav__menu__item-selected"),!o.hasClass("nav__menu__item-selected")&&(t&&n._isChangeCandidate(o)||"widget"===e&&o.data("widget-code")===APP.getWidgetsArea().split(":")[1]&&o.data("widget-item")===APP.getWidgetsArea().split(":")[2]&&o.hasClass("nav__menu__item__icon-integration"))){if(!n._getSelected())return;n._getSelected().removeClass("nav__menu__item-selected").removeClass("js-new-selected"),o.addClass("nav__menu__item-selected").addClass("js-new-selected"),n.$_selected_item=o}})),this._$document.trigger("menu:loader:change"),t&&this.onMouseLeave()},stopHoverMenu:function(){this.hover_menu&&this.hover_menu.prependHoverMenu(false)},startHoverMenu:function(){this.hover_menu&&this.hover_menu.prependHoverMenu(true)},isHoverMenuVisible:function(){if(this.hover_menu)return this.hover_menu.isHoverMenuVisible()},closeHoverMenu:function(){if(this.hover_menu)return this.hover_menu.closeHoverMenu()}}))},922789:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var o=n(629133),r=n.n(o),i=n(161320),a=n.n(i),s=n(313981),l=n(661533);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function c(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}function _(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){c(i,o,r,a,s,"next",e)}function s(e){c(i,o,r,a,s,"throw",e)}a(void 0)}))}}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t,n){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n||e):r.value}},h(e,t,n||e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(i.push(o.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=m(e);if(t){var r=m(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return function(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}(this,n)}}function y(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}const b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(s,e);var t,o,i=g(s);function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),i.apply(this,arguments)}return t=s,o=[{key:"initialize",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,o=arguments;return _((function(){var i;return y(this,(function(a){return(i=h(m(s.prototype),"initialize",e)).call.apply(i,[n].concat(function(e){if(Array.isArray(e))return u(e)}(c=o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(c)||p(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),n.onShowMenuAndBlock=t.onShowMenuAndBlock,n.onCloseMenu=t.onCloseMenu,n.onUnblockMenu=t.onUnblockMenu,n.onBlockMenu=t.onBlockMenu,n.$holder=t.$holder,n.$el=l('<div class="operday"></div>'),n.$document=l(document),n.onAjaxCompleteWithThis=r().bind(n.onAjaxComplete,n),n.render(),n.$document.on("ajaxComplete",n.onAjaxCompleteWithThis),[2];var c}))}))()}},{key:"document_events",value:function(){return{"operday:rerender":"onRerenderWorkspace"}}},{key:"onAjaxComplete",value:function(e,t){var n=this,o=t.getResponseHeader("X-Oper-Day-State"),i=t.getResponseHeader("X-Oper-Day-Expires-In");o&&(r().isNull(i)||(this._expires_in=i),this.ensureViews((function(e){var t=v(e,2),i=t[0],a=t[1];switch(!0){case"closed"===o&&(!n._state||"open"===n._state):n.current_view&&n._destroyComponent(n.current_view),n.onShowMenuAndBlock(),n._state="closed",n.current_view=n.renderStartOperday(i);break;case"open"===o&&n._expires_in<=0&&"expired"!==n._state:n.current_view&&n._destroyComponent(n.current_view),n.onShowMenuAndBlock(),n.current_view=n.renderWorkspace(a,!0),n._state="expired";break;case"open"===o&&!r().contains(["open","expired"],n._state):n.current_view&&n._destroyComponent(n.current_view),n.current_view=n.renderWorkspace(a),n._state="open"}})))}},{key:"onRerenderWorkspace",value:function(){this.current_view&&r().isFunction(this.current_view.reRender)&&this.current_view.reRender()}},{key:"handleChangeView",value:function(e){var t=this;this.ensureViews((function(n){var o=v(n,2),r=o[0],i=o[1];switch(t.current_view&&t._destroyComponent(t.current_view),e){case"start":t.onBlockMenu(),t._state="closed",t.current_view=t.renderStartOperday(r);break;case"workspace":t.onUnblockMenu(),t._state="open",t.current_view=t.renderWorkspace(i,!0)}}))}},{key:"render",value:function(){this.$holder.html(this.$el)}},{key:"renderStartOperday",value:function(e){return this._addComponent(e,{$holder:this.$el,start_time:a()().startOf("minute").unix(),onChangeView:r().bind(this.handleChangeView,this),is_last_day_expired:this._expires_in<=0})}},{key:"renderWorkspace",value:function(e,t){return this._addComponent(e,{$holder:this.$el,onChangeView:r().bind(this.handleChangeView,this),onDestroy:r().bind(this.onCloseMenu,this),need_fetch:t})}},{key:"ensureViews",value:function(e){return _((function(){var t,o,r,i,a;return y(this,(function(s){switch(s.label){case 0:return[4,Promise.all([n.e(41389).then(n.bind(n,41389)),Promise.all([n.e(56740),n.e(68592),n.e(59913),n.e(93103),n.e(26632),n.e(90580),n.e(12897),n.e(39042),n.e(79954),n.e(20064),n.e(7390),n.e(10642),n.e(52758),n.e(65062),n.e(70112),n.e(4483),n.e(50171),n.e(11480),n.e(68833),n.e(32814),n.e(68208)]).then(n.bind(n,510566))])];case 1:return t=v.apply(void 0,[s.sent(),2]),o=t[0],r=o.default,i=t[1],a=i.default,e([r,a]),[2]}}))}))()}}],o&&d(t.prototype,o),s}(s.default);var w="../build/transpiled/interface/operday/operday";window.define(w,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([w])},779971:(e,t,n)=>{n.r(t),n.d(t,{useUser:()=>o.useUser,user:()=>o.user});var o=n(72587)},72587:(e,t,n)=>{n.r(t),n.d(t,{useUser:()=>o.useUser,user:()=>r.user});var o=n(303010),r=n(492011)},303010:(e,t,n)=>{n.r(t),n.d(t,{useUser:()=>o.useUser});var o=n(988667)},988667:(e,t,n)=>{n.r(t),n.d(t,{useUser:()=>a});var o=n(827378),r=n(72587);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var a=function(){var e,t,n=(e=(0,o.useState)(r.user.avatarUrl),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(i.push(o.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=n[0],s=n[1];return(0,o.useEffect)((function(){return r.user.subscribeAvatarChange((function(e){s(e)}))}),[]),{name:r.user.name,id:r.user.id,avatarUrl:a}}},492011:(e,t,n)=>{n.r(t),n.d(t,{user:()=>u});var o=n(445368),r=n(464702);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"avatarUrl",void 0),s(this,"defaultAvatarUrl",void 0),s(this,"name",void 0),s(this,"id",void 0),APP.constant("avatarChangeListeners")||APP.constant("avatarChangeListeners",[]);var t=APP.constant("user");this.name=t.name,this.id=t.id,this.avatarUrl=t.photo,this.defaultAvatarUrl=(0,r.getCDNPath)((0,o.getDefaultAvatar)(t.id))}var t,n;return t=e,(n=[{key:"setAvatartUrl",value:function(e){this.avatarUrl=e.startsWith("/")?(0,r.getCDNPath)(e):e,this.notifyListeners(e)}},{key:"resetAvatarUrl",value:function(){this.setAvatartUrl(this.defaultAvatarUrl)}},{key:"subscribeAvatarChange",value:function(e){var t,n=(t=APP.constant("avatarChangeListeners")||[],function(e){if(Array.isArray(e))return i(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e]);return APP.constant("avatarChangeListeners",n),this.avatarUrl&&e(this.avatarUrl),function(){var t=(APP.constant("avatarChangeListeners")||[]).filter((function(t){return t!==e}));APP.constant("avatarChangeListeners",t)}}},{key:"notifyListeners",value:function(e){APP.constant("avatarChangeListeners").forEach((function(t){return t(e)}))}}])&&a(t.prototype,n),e}(),u=new l}}]);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"build_2025_11_28_18_50_52"},function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0c91b826-8132-41f4-8a13-7c8d296dcfb2",e._sentryDebugIdIdentifier="sentry-dbid-0c91b826-8132-41f4-8a13-7c8d296dcfb2")}catch(e){}}();
//# sourceMappingURL=37107.3a04e70b4920b64d8bb4.js.map