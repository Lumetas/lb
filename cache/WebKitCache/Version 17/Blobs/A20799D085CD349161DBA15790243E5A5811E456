"use strict";(window.webpackChunk=window.webpackChunk||[]).push([[79954],{902667:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var i=n(629133),r=n.n(i),s=n(974839),o=n.n(s);const a=o().Collection.extend({set:function(e,t){var n=this.pluck("id"),i=o().Collection.prototype.set.apply(this,arguments);return t.save_for_render&&(this._fetched=r().isArray(i)?i:[i],this._fetched=r().reject(this._fetched,(function(e){return r().contains(n,e.get("id"))}))),i},searchTerm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.links=null,this.fetch({reset:!0,url:this._getSearchUrl(e)})},_getSearchUrl:function(){return r().result(this,"url")},getFetchedItems:function(){return this._fetched},hasNextPage:function(){return r().isUndefined(this.links)||this.links&&this.links.next},clearForReset:function(){this.reset(),this.links=null}});var l="../build/transpiled/components/base/suggest/collection";window.define(l,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([l])},394111:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var i=n(661533),r=n.n(i),s=n(629133),o=n.n(s),a=n(460159),l=n.n(a),c=n(313981),d=n(466072);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}const _=c.default.extend({_list:null,_classes:function(){return{add_new_btn:"js-suggest__add-new",load_more_btn:"js-suggest__load-more-link",suggest_input:"js-suggest-input",load_more_block:"suggest__load-more",loading:"suggest__load-more_loading",input_loader:"js-suggest-input-loader",items_suggest:"suggest__items-suggest",empty_plug:"suggest__empty-plug",not_found_plug:"suggest__not-found-plug",hidden:"h-hidden"}},events:function(){var e=o().result(c.default.prototype,"events",{});return e["click ".concat(this._selector("add_new_btn"))]="onAddNewClick",e["click ".concat(this._selector("load_more_btn"))]="loadMore",e["input ".concat(this._selector("suggest_input"))]="onSuggestInput",e["keydown ".concat(this._selector("suggest_input"))]="onSuggestInputKeydown",e},initialize:function(e){return c.default.prototype.initialize.call(this),this._setParams(e)._initCollection(),this},_setParams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.options=e,this._template_params={},this._ItemsCollection=this._ItemsCollection||e._ItemsCollection,this._ItemView=this._ItemView||e._ItemView,!this._ItemsCollection)throw new Error("No collection constructor provided! ".concat(JSON.stringify(e)));if(!this._ItemView)throw new Error("No item view constructor provided! ".concat(JSON.stringify(e)));return this},_initCollection:function(){this._list=new this._ItemsCollection([],this._getCollectionParams(this.options))},_getCollectionParams:function(e){return o().extend({},e.collection_params||{})},fetchData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(this.options.fetch_params||[]).concat([l()._preload(this._getTemplates())(),this._list.fetch()]).concat(this._getFetchParams());return new Promise(o().bind((function(n){Promise.all(t).then(o().bind((function(){this._onDataFetch.apply(this,arguments),this.render(n),e.rerender||(this._setListeners(this._list),this._addComponent(d.default,this._getAutoloadParams(this.options)))}),this))}),this))},rerender:function(){return this._list.clearForReset(),this.fetchData({rerender:!0})},_getAutoloadParams:function(e){return o().extend({},{element:this._getScrollContainer().get(0),onLoadMore:o().bind(this.loadMore,this),conditions:{"max-bottom":350}},e.autoload_params||{})},loadMore:function(){this._list.hasNextPage()&&!this._fetching&&(this._toggleLoadMoreLoader({load:!0}),this._fetching=!0,this._list.fetch({silent:!0,remove:!1,save_for_render:!0}).then(o().bind((function(){this._fetching=!1,this.renderItems(this._getFetchedItems())}),this),o().bind(this._toggleLoadMoreLoader,this,{load:!1})))},_getFetchParams:function(){return[]},_getFetchedItems:function(){return this._list.getFetchedItems()},_onDataFetch:function(){throw new Error("Must be implemented in subclass!")},_setListeners:function(){throw new Error("Must be implemented in subclass!")},_getTemplates:function(){if(!this._templates)throw new Error("No templates for render specified!");return o().values(this._templates)},render:function(e){var t=this._getRenderItems();if(!this._templates.main)throw new Error("No template provided!");this.$el.html(l()({ref:this._templates.main}).render(o().extend(this._template_params,this._getTemplateParams(t)))),this.renderItems(t),o().isFunction(e)&&e()},renderItems:function(e){var t=document.createDocumentFragment();e=e||this._getRenderItems();var n=[this.renderAddNewButton(),this.renderLoadMoreButton(),this.renderEmptyPlug(!e.length&&!this._search_term),this.renderNotFoundPlug(!e.length&&this._search_term)];o().each(e,(function(e){t.appendChild(this._addComponent(this._ItemView,this._getItemParams(this.options,e)).render().el)}),this),o().each(n,(function(e){o().isElement(e)&&t.appendChild(e)})),this._getItemsHolder().append(t),o().isFunction(this.updateAddNewButton)&&this.updateAddNewButton()},_getItemParams:function(e,t){return o().extend({},{model:t,isTyping:o().bind(this.isTyping,this)},e.item_params||{})},renderLoadMoreButton:function(){if(this._findElem("load_more_block").remove(),this._list.hasNextPage())return r()(l()({ref:"/tmpl/common/suggest/load_more.twig"}).render(this._getLoadMoreButtonParams(this.options))).get(0)},renderAddNewButton:function(){if(this._findElem("add_new_btn").remove(),this._search_term&&!this.options.cant_add&&this._templates.add_new&&!this._matchesSearchQuery())return r()(l()({ref:this._templates.add_new}).render(o().extend(this.options.add_new_btn_params||{},{name:this._search_term}))).get(0)},renderEmptyPlug:function(e){if(this._findElem("empty_plug").remove(),this._templates.empty_plug&&e)return r()(l()({ref:this._templates.empty_plug}).render(this.options.empty_plug_params||{})).get(0)},renderNotFoundPlug:function(e){if(this._findElem("not_found_plug").remove(),this._templates.not_found_plug&&e)return r()(l()({ref:this._templates.not_found_plug}).render(o().extend(this.options.not_found_plug_params||{},{search_term:this._search_term}))).get(0)},_matchesSearchQuery:function(){var e=this._getSearchMatchingParams(),t=o().map(this._getRenderItems(),(function(t){return t.get(e)}));return o().contains(t,this._search_term)},_toggleSearchLoader:function(e){this._toggleClass("hidden","input_loader",(e||{}).hide),this._is_typing=!(e||{}).hide},_toggleLoadMoreLoader:function(e){this._findElem("load_more_block").toggleClass(this._class("loading"),(e||{}).hide)},_getSearchMatchingParams:function(){return"name"},_getRenderItems:function(){return this._list.models},_getTemplateParams:function(){return{}},_getItemsHolder:function(){return this._elem("items_suggest")},_getScrollContainer:function(){return this._getItemsHolder()},_getLoadMoreButtonParams:function(e){return o().extend({},e.load_more_btn_params||{})},onSuggestInput:function(e){var t=r()(e.target).val().trim();t!==this._search_term&&(this._toggleSearchLoader({hide:!1}),this._debouncedSearch.call(this,t))},_debouncedSearch:o().debounce((function(e){this._search_term=e,this._list.searchTerm({search:e}).then(o().bind((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i;this._onSearchFetch.apply(this,function(e){if(Array.isArray(e))return u(e)}(i=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),this._getScrollContainer().scrollTop(0),this.renderItems(this._getSearchedItems()),this._toggleSearchLoader({hide:!0})}),this),o().bind(this._toggleSearchLoader,this,{hide:!0}))}),500),_onSearchFetch:o().noop,_getSearchedItems:function(){return this._getRenderItems()},onAddNewClick:function(e){e.preventDefault(),e.stopPropagation(),this.addNewItem()},onSuggestInputKeydown:function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.addNewItem())},isTyping:function(){return this._is_typing},addNewItem:o().noop});var f="../build/transpiled/components/base/suggest/index";window.define(f,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([f])},115764:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});var i=n(629133),r=n.n(i),s=n(313981);const o=s.default.extend({initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s.default.prototype.initialize.call(this),this.areActionsBlocked=r().isFunction(e.isTyping)?e.isTyping:r().noop,this.listenTo(this.model.collection,"reset",r().bind((function(){this.destroy(!0)}),this))}});var a="../build/transpiled/components/base/suggest/item";window.define(a,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([a])},237509:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var i=n(661533),r=n.n(i),s=n(629133),o=n.n(s),a=n(460159),l=n.n(a),c=n(750856);const d={events:{"click .filter-search__linked_entity":"initLinkedEntity"},initLinkedEntity:function(e){var t=r()(e.currentTarget),n=t.closest(".filter-search__linked_entity-holder");e.stopPropagation(),n.parent().parent().find(".js-filter-search__entity-header").click(),this._linkedEntity=new c.default({$el:t,suggest_class_name:"filter__linked_entity-suggest linked_entity-suggest-list",items_template:"/tmpl/filter/linked_entity/select.twig",catalog_id:n.data("search-in-id"),onRenderItemsParams:function(){return{input_name:n.data("input-name")||"",inner_item_tmpl:"/tmpl/filter/linked_entity/item.twig"}},existing_items:r().map(t.find(".js-multisuggest-item"),(function(e){return{id:parseInt(r()(e).attr("data-id"))||0,name:r()(e).attr("data-title")}})),onInit:o().bind((function(){t.parent().addClass("js-in-edit"),this._fixFilterForSuggest({fix:!0})}),this),onDestroy:o().bind((function(e){this._linkedEntity=null,t.parent().removeClass("js-in-edit"),this._fixFilterForSuggest({fix:!1}),this.refreshSelectedElements(e,n)}),this)})},refreshSelectedElements:function(e,t){var n=!0,i=t.data("input-name");(!e||o().isArray(e)&&!e.length)&&(t.find(".filter-search__linked_entity").html(l()({ref:"/tmpl/filter/linked_entity/select.twig"}).render({items:e||[],input_name:i,inner_item_tmpl:"/tmpl/filter/linked_entity/item.twig"})),this._linkedEntity&&this._linkedEntity.destroy(),n=!1),this.checkSuggestValues(t,i),t.toggleClass("glow",n)}}},666870:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var i=n(661533),r=n.n(i),s=n(629133),o=n.n(s);function a(e){return e.data("element-type")||APP.element_types[APP.getBaseEntity()]||APP.getBaseEntity()}const l={cacheFilledInputName:function(e,t){var n=a(t.closest(this._selector("entity_wrapper")));o().isArray(this.checked_fields[n])||(this.checked_fields[n]=[]);var i=this.checked_fields[n];o().contains(i,e)||i.push(e)},unsetFilledInputName:function(e){var t=e.find(":input:not(.js-filter-clear-skip)"),n=e.closest(this._selector("entity_wrapper"));if(n.length){var i=a(n),s=this.checked_fields[i];if(o().contains(["tags","users"],e.data("tmpl"))){var l=e.data("input-name");o().isArray(s)&&o().contains(s,l)&&s.splice(o().indexOf(s,l),1)}t.length&&o().isArray(s)&&r().each(t,(function(e,t){var n=r()(t).attr("name");o().contains(s,n)&&s.splice(o().indexOf(s,n),1)})),this.setEntityWrapperClass()}},resetFilledInputNames:function(){o().isEmpty(this.checked_fields)||o().each(o().keys(this.checked_fields),(function(e){this.checked_fields[e]=[]}),this)},setEntityWrapperClass:function(){o().each(this.checked_fields,(function(e,t){this._findElem("entity_wrapper_by_type",t).length&&this._findElem("entity_wrapper_by_type",t).toggleClass("filter-search__entity-wrapper_filled",!!e.length)}),this)}}},995210:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var i=n(661533),r=n.n(i),s=n(629133),o=n.n(s),a=n(460159),l=n.n(a),c=n(750856);const d={events:{"click .filter-search__products":"initProducts"},initProducts:function(e){var t=r()(e.currentTarget),n=t.closest(".filter-search__products-holder");e.stopPropagation(),n.parent().parent().find(".js-filter-search__entity-header").click(),this._products=new c.default({$el:t,entity:n.data("element-type-name")||APP.getBaseEntity(),suggest_class_name:"filter__products-suggest products-suggest-list",items_template:"/tmpl/filter/products/select.twig",catalog_id:APP.constant("account").products.catalog_id,onRenderItemsParams:function(){return{input_name:n.data("input-name")||"",inner_item_tmpl:"/tmpl/filter/products/item.twig"}},existing_items:r().map(t.find(".js-multisuggest-item"),(function(e){return{id:parseInt(r()(e).attr("data-id"))||0,sku:r()(e).attr("data-sku")||"",name:r()(e).attr("data-title")}})),onInit:o().bind((function(){t.parent().addClass("js-in-edit"),this._fixFilterForSuggest({fix:!0})}),this),onDestroy:o().bind((function(e){this._products=null,t.parent().removeClass("js-in-edit"),this._fixFilterForSuggest({fix:!1}),this.refreshSelectedProducts(e,n)}),this)})},refreshSelectedProducts:function(e,t){var n=!0,i=t.data("input-name")||"product[]";(!e||o().isArray(e)&&!e.length)&&(t.find(".filter-search__products").html(l()({ref:"/tmpl/filter/products/select.twig"}).render({items:e||[],input_name:i,inner_item_tmpl:"/tmpl/filter/products/item.twig"})),this._products&&this._products.destroy(),n=!1),this.checkSuggestValues(t,i),this.form.model.set("filter[products][]",e.length>0?o().pluck(e,"id"):""),t.toggleClass("glow",n)}}},199003:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var i=n(661533),r=n.n(i),s=n(629133),o=n.n(s),a=n(460159),l=n.n(a),c=n(47912);const d={events:{"click .filter-search__tags":"initTags"},initTags:function(e){var t=r()(e.currentTarget),n=t.closest(".filter-search__tags-holder");e.stopPropagation(),this._tags=new c.default({$el:t,entity:n.data("element-type-name")||APP.getBaseEntity(),suggest_class_name:"filter__tags-suggest fast-tags-suggest-list",items_template:"/tmpl/filter/tags/items.twig",onRenderItemsParams:function(){return{input_name:n.data("input-name")||""}},tags:r().map(t.find(".js-multisuggest-item"),(function(e){return{id:parseInt(r()(e).attr("data-id"))||0,color:r()(e).attr("data-color"),name:r()(e).text()}})),onInit:o().bind((function(){t.parent().addClass("js-in-edit"),this._fixFilterForSuggest({fix:!0})}),this),onDestroy:o().bind((function(e){this._tags=null,t.parent().removeClass("js-in-edit"),this._fixFilterForSuggest({fix:!1}),this.refreshSelectedTags(e,n)}),this)})},refreshSelectedTags:function(e,t,n){var i=!0,r=(t=t||this._findElem("tags_field")).data("input-name")||"tag[]";t.find(".filter-search__tags").html(l()({ref:"/tmpl/filter/tags/items.twig"}).render({items:e||[],input_name:r})),(!e||o().isArray(e)&&!e.length)&&(this._tags&&this._tags.destroy(),i=!1),(o().isUndefined(n)||n)&&this.checkSuggestValues(t,r),t.toggleClass("glow",i)}}},759822:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var i=n(629133),r=n.n(i),s=n(445368);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n||e):r.value}},a(e,t,n||e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=l(e);if(t){var r=l(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}(this,n)}}var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(u,e);var t,n,i=d(u);function u(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i.apply(this,arguments)}return t=u,n=[{key:"_selectors",value:function(){return{header:".segments-filter__header",and_radio:'[name="filter[segments_logic]"][value="and"]',item_checkboxes:'input[type="checkbox"]',item_name:'.suggest-segments__item_filter-list[data-id="%s"] .suggest-segments__name',item:'.segments-filter__item[data-id="%s"]',items:".segments-filter__item",empty_find_item:".segments-filter__item_empty-find",checked_item:".segments-filter__item-checkbox:checked"}}},{key:"_classes",value:function(){return{header_visible:"segments-filter__header_visible"}}},{key:"events",get:function(){return r().extend({"click .js-segments-filter-header-clear":"clear","input .segments-filter__input":"findSegments"},a(l(u.prototype),"events",this))}},{key:"initialize",value:function(e){var t=e.segments;this.segments=t,a(l(u.prototype),"initialize",this).apply(this,arguments),this.listenTo(this.model,"all",r().throttle(r().bind(this.checkChanged,this),400))}},{key:"clear",value:function(){this._findElem("and_radio").click(),this._findElem("item_checkboxes").attr("checked",!1).trigger("change")}},{key:"getNameSelected",value:function(e){return this._findElem("item_name",e).text().trim()}},{key:"findSegments",value:function(e){var t=this,n=String(e.target.value).toLowerCase(),i=r().map(this._findElem("checked_item"),(function(e){return parseInt(e.value)})),o=0;this._findElem("items").show(),this._findElem("empty_find_item").hide();var a=r().map(this.segments.list,(function(e){var s=-1!==String(e.name).toLowerCase().indexOf(n);if(s&&o++,!s&&!r().contains(i,e.id))return t._selector("item").replace("%s",e.id)}));0===o&&this._findElem("empty_find_item").show().text((0,s.i18n)("No segments were found for «%s»").replace("%s",n)),this.$el.find(r().compact(a).join(", ")).hide()}},{key:"checkChanged",value:function(){var e=r().isEmpty(this.model.get("filter[segments][]"));e&&"and"!==this.model.get("filter[segments_logic]")&&(this.model.set("filter[segments_logic]","and"),this._findElem("and_radio").click()),this._findElem("header").toggleClass(this._class("header_visible"),!e)}}],n&&o(t.prototype,n),u}(n(526471).default.View),_="../build/transpiled/components/filter/segments";window.define(_,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([_])},887067:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var i=n(629133),r=n.n(i),s=n(460159),o=n.n(s),a=n(313981),l=n(445368),c=n(661533);function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t,n){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n||e):r.value}},u(e,t,n||e)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=_(e);if(t){var r=_(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}(this,n)}}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(s,e);var t,n,i=h(s);function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),i.apply(this,arguments)}return t=s,n=[{key:"default_value",get:function(){return""}},{key:"events",get:function(){return{'controls:change [name="statistic_select"]':"onFieldSelect"}}},{key:"initialize",value:function(e){var t=e.fields,n=e.findCustomFieldElement;this.fields=t,this.findCustomFieldElement=n,this.renderSelect(),u(_(s.prototype),"initialize",this).apply(this,arguments)}},{key:"renderSelect",value:function(){var e=this,t="/tmpl/controls/select.twig",n=r().reduce(r().keys(this.fields),(function(t,n){return t.concat([{id:n,option:e.fields[n].title}])}),[{id:this.default_value,option:(0,l.i18n)("Select field")}]);o()._preload([t])().then((function(){e.$el.html(o()({ref:t}).render({name:"statistic_select",items:n,selected:e.default_value}))}))}},{key:"onFieldSelect",value:function(e){var t=c(e.currentTarget).val();if(t!==this.default_value){var n="filter[cf][".concat(t,"]");this.findCustomFieldElement(n).removeClass("hidden").insertBefore(this.$el),delete this.fields[t],this.renderSelect()}}}],n&&d(t.prototype,n),s}(a.default),p="../build/transpiled/components/filter/statistic";window.define(p,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([p])},578882:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var i=n(629133),r=n.n(i),s=n(445368),o=n(859200),a=n(394111),l=n(306120),c=n(285495),d=n(503488),u=n(816270),_=n(661533),f=d.default.extend({searchTerm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.links=null,this.remove(this.filter((function(e){return!e.get("selected")}))),this.fetch({remove:!1,url:this._getSearchUrl(e)})}});const h=a.default.extend({_ItemsCollection:f,_ItemView:c.default,_need_rerender:null,tag_input_name:"tag[]",className:"filter-search__tags-lib tags-lib",id:"filter-search__tags-lib",_classes:function(){return r().extend({},r().result(a.default.prototype,"_classes"),{hidden:"h-hidden",header:"tags-lib__header",tags_logic_visible:"tags-lib__header_tags-logic-visible",manage_btn:"js-tags-lib__manage",deselect_btn:"js-tags-lib__header-deselect"})},_selectors:function(){return r().extend({},r().result(a.default.prototype,"_selectors"),{tags_logic_inputs:".tags-lib__tags-logic-holder input"})},events:function(){var e=r().result(a.default.prototype,"events",{});return e["click ".concat(this._selector("manage_btn"))]="showTagsManageModal",e["click ".concat(this._selector("deselect_btn"))]="deselectAll",e},_setParams:function(){return a.default.prototype._setParams.apply(this,arguments),this.entity=this.options.entity||APP.getBaseEntity(),this.tag_input_name=this.options.tag_input_name||this.tag_input_name,r().isFunction(this.options.checkSuggestValues)&&(this.checkTagItemsChanges=r().bind((function(){this.options.checkSuggestValues(this.$el,this.tag_input_name)}),this)),this},_initCollection:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=this._getCollectionParams(this.options);i.url_params.qs_params={filter:{id:this.options.selected_tags}},a.default.prototype._initCollection.apply(this,t),this.options.selected_tags&&this.options.selected_tags.length&&(this._sel=new this._ItemsCollection([],r().extend({model:u.default.Selected},i)))},_getCollectionParams:function(e){return{url_params:{entity:this.entity,pipeline_id:e.pipeline_id}}},_getFetchParams:function(){return[this._sel?this._sel.fetch():r().noop]},_onDataFetch:function(){var e;this._sel&&(e=r().map(this._sel.models,(function(e){return e.toJSON()})),this._list.set(e,{merge:!0,remove:!1}))},_setListeners:function(e){this.listenTo(e,"change:selected",this.onTagsLibItemChange)},_templates:{main:"/tmpl/filter/tags_lib/index.twig",item:"/tmpl/filter/tags_lib/item.twig",empty_plug:"/tmpl/filter/tags_lib/empty_plug.twig",not_found_plug:"/tmpl/common/tags/not_found_plug.twig"},_getRenderItems:function(){return this._list.getSortedBySelected()},renderNotFoundPlug:function(){var e=r().reject(this._list.getSortedByFrequency(),(function(e){return e.get("selected")}));return a.default.prototype.renderNotFoundPlug.call(this,!e.length&&this._search_term)},_getFetchedItems:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=a.default.prototype._getFetchedItems.apply(this,t);return r().filter(i,(function(e){return e.get("total")}))},_getSearchedItems:function(){return this._list.getNonSelectedItems()},_getTemplateParams:function(e){return r().extend({manage_tags:(0,o.isAdmin)(),has_tags:e.length},this.options.tags_logic_enabled?{tags_logic:{disabled:!this._list.getSelectedItemsCount(),name:this.options.tags_logic_input_name||"",value:this.options.getTagsLogicValue()}}:{})},_getScrollContainer:function(){return this.options.$filter_scroller},_getLoadMoreButtonParams:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=a.default.prototype._getLoadMoreButtonParams.apply(this,t);return r().extend(i,{class_name:"tags-lib__item tags-lib__item_load-more",inner_class_name:"tags-lib__link-text",button_text:(0,s.i18n)("More tags")})},onTagsLibItemChange:function(e){this._sel||(this._sel=new this._ItemsCollection),e.get("selected")?this._sel.add(e.toJSON()):(this._sel.remove(e),this.checkTagItemsChanges()),this.toggleTagsLogic()},onSuggestInput:function(e){var t=_(e.target).val().trim();t!==this._search_term&&(this._toggleSearchLoader({hide:!1}),this._debouncedSearch.call(this,t))},toggleTagsLogic:function(){var e=this._findElem("tags_logic_inputs"),t=!this._list.getSelectedItemsCount();e.length&&(t&&e.filter('[value="or"]').trigger("custom_radio_change"),e.trigger("controls:disable",t),this._toggleClass("tags_logic_visible","header",!t))},_checkRemovedTags:function(){this.checkTagItemsChanges(),this.toggleTagsLogic()},onTagsManageModalDestroy:function(e){if((e=e||{}).deleted_tags&&e.deleted_tags.length&&(this._list.removeTags(e.deleted_tags),this._checkRemovedTags(),r().chain(e.deleted_tags).map((function(e){return e.get("total")})).reduce((function(e,t){return e+t}),0).value()&&r().isFunction(this.options.setNeedReload)&&this.options.setNeedReload({reload:!0}),this._list.getSortedByFrequency().length||this.renderItems()),e.tags_changed)return this._$document.trigger("page:reload")},showTagsManageModal:function(){this._addComponent(l.default,{entity:this.entity,onDestroy:r().bind(this.onTagsManageModalDestroy,this),item_params:{colored_tags_available:r().contains(["leads","leads-pipeline"],APP.data.current_entity)}}).fetchData()},deselectAll:function(){var e=this._list.getItems({selected:!0});r().each(e,(function(e){e.set("selected",!1,{silent:!0}),e.trigger("tag:update")})),this._sel&&this._sel.reset(),this._checkRemovedTags()},updateTags:function(e,t){this._list&&(e.length||t.length)&&(this._need_rerender=!0)},checkNeedRerender:function(e){e=r().isFunction(e)?e:r().noop,this._need_rerender?(this._dropElemCache(),this._sel&&(this._sel.updateSelectedTagsIds(),this._sel.reset(),this._sel.links=null),this.rerender().then(r().bind((function(){e(),this.checkTagItemsChanges()}),this)),this._need_rerender=!this._need_rerender):e()}})},285495:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var i=n(629133),r=n.n(i),s=n(460159),o=n.n(s),a=n(115764);const l=a.default.extend({tagName:"li",className:"tags-lib__item",_classes:function(){return{inner_name:"js-tags-lib__item-name"}},events:function(){var e=r().result(a.default.prototype,"events",{});return e["click ".concat(this._selector("inner_name"))]="onTagsLibItemClick",e},initialize:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a.default.prototype.initialize.apply(this,t),this.listenTo(this.model,"change:selected",this.render),this.listenTo(this.model,"tag:update",this.render),this.listenTo(this.model,"remove",r().bind((function(){this.destroy(!0)}),this))},render:function(){return this.$el.attr("data-tag-id",this.model.get("id")).attr("data-color",this.model.get("color")).toggleClass("tags-lib__item_selected",!!this.model.get("selected")).html(o()({ref:"/tmpl/filter/tags_lib/item.twig"}).render(this.model.toJSON())),this},onTagsLibItemClick:function(){var e=this.model.get("selected");this.areActionsBlocked()||(this.model.set("selected",!e),e||this.$("input").trigger("controls:change"))}});var c="../build/transpiled/components/filter/tags_lib/item";window.define(c,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([c])},601418:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var i=n(661533);function r(e){e.length&&e.reverse().each((function(){var e=i(this);switch(e[0].type.toString().toLowerCase()){case"text":case"hidden":e.val("").trigger("controls:change");break;case"radio":e.prop("checked",!this.value).trigger("change");break;case"checkbox":e.prop("checked",!1).removeAttr("checked").trigger("change")}}))}},602714:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var i=n(661533),r=n.n(i),s=n(629133),o=n.n(s),a=n(926168);function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o().each(e,(function(e,i){var s,l=!1;if(!o().isArray(e)&&!e&&!n.mind_empty)return!0;if(o().isArray(e)||(e=[e]),l=!1,i.indexOf("[!")>=0&&(i=i.replace("[!","["),l=!0),"filter[status_id][]"===i&&(1===e.length&&!l&&o().contains((0,a.getLeadsWinlostStatuses)(),parseInt(o().first(e)))&&(s=t?this._findElem("leads_checkbox_by_status",o().first(e)):this._findElem("leads_checkbox_by_status_single_ppl",o().first(e))),2===e.length&&l&&(s=this._findElem("leads_checkbox"))),(s=s&&s.length?s:this._findElem("filter_input",i)).length)switch(s[0].type.toString().toLowerCase()){case"text":case"hidden":(e[0]||n.mind_empty)&&s.val(e[0]||"").trigger("controls:change");break;case"radio":case"checkbox":r().each(s,(function(t,n){var i,s=r()(n);i=l?-1===o().indexOf(e,n.value):o().indexOf(e,n.value)>=0,s.attr("checked",i),s.prop("checked",i),("checkbox"===s.attr("type")||i)&&s.trigger("change")}))}return!0}),this)}var c="../build/transpiled/components/filter/utils/fill";window.define(c,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([c])},481612:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_,deserializeFilterParams:()=>u,serializeFilterParams:()=>d});var i=n(629133),r=n.n(i),s=n(34158),o=/^filter\[(pipe|cf)\]\[\d+\]\[\]$/,a=/^filter\[(pipe|cf)\]\[\d+\]$/;function l(e){return r()(e).map((function(e){return parseInt(e)})).reduce((function(e,t){return e+t}),0)}function c(e,t,n){for(var i=0,r=[e];i<n-1;i++)r.push(e+=+t);return l(r)}var d=function(e){if(arguments.length>1&&void 0!==arguments[1]&&!arguments[1]){var t=r().omit(e,"useCompressFilter");return(0,s.jsonToQS)(t)||""}if(!Object.keys(e).some((function(t){return o.test(t)&&r().isArray(e[t])}))){var n=(0,s.jsonToQS)(e);return n?"".concat(n,"&useCompressFilter=y"):""}var i={};for(var a in e){var l=e[a];if(l)if(o.test(a)&&r().isArray(l)){var c=a.replace(/\[\]$/,""),d=l.join(",");i[c]=d}else i[a]=l}var u=(0,s.jsonToQS)(i);return u?"".concat(u,"&useCompressFilter=y"):"useCompressFilter=y"},u=function(e){var t={};for(var n in e){var i=e[n];if(i){if("useCompressFilter"!==n)if(a.test(n)&&r().isString(i)&&i.includes(",")){var s="".concat(n,"[]"),o=i.split(",").map((function(e){return e.trim()})).filter((function(e){return""!==e}));t[s]=o}else t[n]=i}else t[n]=i}return t};const _=function e(t,n,i){var s,o,a,d;for(s in i=i||{},t)r()(t).has(s)&&(a=t[s],o=n?"".concat(n,"[").concat(s,"]"):s,r().isObject(a)?(d=r().keys(a),r().every(d,(function(e){return!r().isNaN(parseInt(e))&&!r().isObject(a[e])}))&&c(0,1,d.length)===l(d)?i["".concat(o,"[]")]=r().values(a):e(a,o,i)):i[o]=a);return i};var f="../build/transpiled/components/filter/utils/parse";window.define(f,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([f])},878978:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});var i=n(629133),r=n.n(i),s=n(63872);const o=s.default.extend({_classes:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r().extend(s.default.prototype._classes.apply(this,t),{modal:"confirm_catalog_delete"})},_template:"/tmpl/common/modal/delete.twig"});var a="../build/transpiled/components/modals/delete";window.define(a,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([a])},503488:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var i=n(629133),r=n.n(i),s=n(567952),o=n.n(s),a=n(863055),l=n(902667),c=n(816270);const d=l.default.extend({model:c.default.Base,initialize:function(e,t){this.url_params=t.url_params||{}},url:function(){switch(!0){case!this.links:return(0,a.getTagsListUrl)(o()(this.url_params));case this.hasNextPage()&&!r().isUndefined(this.links):return this.links.next.href;default:return""}},_getSearchUrl:function(e){var t={};return e.search?t={search:e.search||""}:this.url_params.qs_params&&this.url_params.qs_params.search&&delete this.url_params.qs_params.search,this.url_params.qs_params=r().extend(this.url_params.qs_params||{},t),this.url()},getSortedByFrequency:function(){return r().chain(this.models).filter((function(e){return e.get("total")})).sortBy((function(e){return e.get("name")})).sortBy((function(e){return-1*parseInt(e.get("total"))})).value()},getSortedBySelected:function(){return r().sortBy(this.getSortedByFrequency(),(function(e){return!e.get("selected")}))},getNonSelectedItems:function(){return r().filter(this.getSortedByFrequency(),(function(e){return!e.get("selected")}))},getSelectedItemsCount:function(){return this.getItems({selected:!0}).length},getItems:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r().isUndefined(e.selected)?this.models:this.filter((function(t){return t.get("selected")===e.selected}))},clearForReset:function(){l.default.prototype.clearForReset.call(this),this.url_params.qs_params&&this.url_params.qs_params.search&&delete this.url_params.qs_params.search},updateSelectedTagsIds:function(){this.url_params.qs_params={filter:{id:this.pluck("id")}}},removeTags:function(e){if(e){var t=r().chain(e).map((function(e){return e.get("id")})).map((function(e){return this.get(e)}),this).reject((function(e){return r().isUndefined(e)})).value();t.length&&this.remove(t)}}});var u="../build/transpiled/components/tags/collection";window.define(u,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([u])},558279:(e,t,n)=>{n.r(t),n.d(t,{colors:()=>i});var i=["","#EBEBEB","#D0D0D0","#F2DDF7","#D1A4DC","#FF8F92","#FFC8C8","#C7DB8C","#DDEBB5","#8699DA","#AABDFF","#FFCE5A","#FFE193","#90CDB0","#C6F4DE","#A9A5D7","#D8D5FF","#86C0FC","#832161","#6A0F49","#0C7C59","#10599D","#9D2B32","#247BA0"],r="../build/transpiled/components/tags/constant";window.define(r,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([r])},986214:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var i=n(629133),r=n.n(i),s=n(350562),o=n(445368),a=n(878978);const l=a.default.extend({_tags:null,save:function(){this._elem("save_btn").trigger("button:load:start"),this._xhr||(this._xhr=(0,s.deleteTags)(this._tags).always(r().bind(this.actionComplete,this)))},setParams:function(e){var t=a.default.prototype.setParams.apply(this,arguments);if(!e.tags.length)throw new Error("Tag items not provided in params: ".concat(JSON.stringify(e)));return this._tags=e.tags,t},isValidResponse:function(e){return(e||{}).deleted},getTemplateParams:function(){var e=[];return 1===this._tags.length?(e.push((0,o.i18n)("Are you sure you want to delete the «%s» tag?").replace("%s",r().escape(r().first(this._tags).name))),e.push((0,o.i18n)("The tag will be removed from all leads."))):(e.push((0,o.i18n)("Are you sure you want to delete selected tags?")),e.push((0,o.i18n)("Tags will be removed from all leads."))),{caption:(0,o.i18n)("Delete tags"),message:[{text:e.join(" ")}],accept_text:(0,o.i18n)("Confirm")}}});var c="../build/transpiled/components/tags/modals/delete";window.define(c,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([c])},306120:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var i=n(661533),r=n.n(i),s=n(629133),o=n.n(s),a=n(350562),l=n(445368),c=n(144352),d=n(304483),u=n(394111),_=n(503488),f=n(816270),h=n(56815),g=n(558279);const p=u.default.extend({_ItemsCollection:_.default,_ItemView:h.default,deleted_tags:null,added_tags:null,_selectors:function(){return o().extend({},o().result(u.default.prototype,"_selectors"),{manage_restrict:"#modal-tags-lib-manage__restrict",color_picker:".js-modal-tags-lib-manage__icon-wrapper"})},events:function(){var e=o().result(u.default.prototype,"events",{});return e["change ".concat(this._selector("manage_restrict"))]="onRestrictSwitcherChange",e["click ".concat(this._selector("color_picker"))]="onChangeNewTagColor",e},initialize:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];u.default.prototype.initialize.apply(this,t),this.colored_tags_available&&(this.color_picker=this._addComponent(c.default))},_setParams:function(){return u.default.prototype._setParams.apply(this,arguments),this.deleted_tags=[],this.added_tags=[],this.tags_changed=!1,this.colored_tags_available=this.options.item_params.colored_tags_available,this._template_params.colored_tags_available=this.colored_tags_available,this},destroy:function(){o().isFunction(this.options.onDestroy)&&this.options.onDestroy({deleted_tags:this.deleted_tags,added_tags:this.added_tags,tags_changed:this.tags_changed}),u.default.prototype.destroy.call(this)},_getCollectionParams:function(e){return{url_params:{entity:e.entity||APP.getBaseEntity()}}},_getFetchParams:function(){return[(0,a.getAccountSettings)().then(o().bind((function(e){this._template_params.tags_editable=e.tags_editable}),this))]},_onDataFetch:o().noop,_setListeners:function(e){this.listenTo(e,"remove",this.onTagsRemove),this.listenTo(e,"add",this.onTagsAdd),this.listenTo(e,"change",this.onTagsChanged)},_templates:{main:"/tmpl/common/tags/manage/modal.twig",item:"/tmpl/common/tags/manage/item.twig",add_new:"/tmpl/common/tags/add_new.twig",empty_plug:"/tmpl/common/tags/empty_plug.twig",not_found_plug:"/tmpl/common/tags/not_found_plug.twig"},render:function(){this.modal=new d.default({class_name:"modal-list modal-tags-lib-manage",init:o().bind((function(e){this.setElement(e),u.default.prototype.render.apply(this,arguments),this.$el.trigger("modal:loaded"),this._elem("suggest_input").focus(),this.$el.trigger("modal:centrify"),APP.is_touch_device&&this._elem("items_suggest").css("minHeight",this._elem("items_suggest").height())}),this),destroy:o().bind(this.destroy,this)})},renderAddNewButton:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=u.default.prototype.renderAddNewButton.apply(this,t);return this.$el.find(this._selector("color_picker")).toggleClass("hidden",!(i&&this.colored_tags_available)),i},updateAddNewButton:function(){var e=this._getItemsHolder().find(".new-tag");if(e.length&&!o().isUndefined(this.saved_add_new_color)){var t=this.saved_add_new_color;e.css({borderColor:t?"#".concat(t):"",backgroundImage:t?"linear-gradient(0deg, ".concat((0,l.hex2rgba)("#".concat(t),.3),", ").concat((0,l.hex2rgba)("#".concat(t),.3),")"):""}),e.attr("data-color",t||""),this._elem("suggest_input").focus()}},_getLoadMoreButtonParams:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=u.default.prototype._getLoadMoreButtonParams.apply(this,t);return o().extend(i,{class_name:"tags-lib__item tags-lib__item_load-more",inner_class_name:"tags-lib__link-text",button_text:(0,l.i18n)("More tags")})},onChangeNewTagColor:function(e){var t=this.isTyping(),n=this;if(!t){var i=e.target.getBoundingClientRect();this.$overflow_color_picker=r()(this.color_picker.getTemplate(g.colors)),this.$el.append(this.$overflow_color_picker);var s=this.$overflow_color_picker.find(".segments-color-picker");this.$overflow_color_picker.on("click",(function(){n.$overflow_color_picker.remove()})),s.on("click",".segments-color-picker__item",(function(e){var t=r()(e.target).attr("data-color")||null;n._getItemsHolder().find(".new-tag").length&&(n.saved_add_new_color=o().isString(t)?t.slice(1):t,n.updateAddNewButton())})),s.css({left:"".concat(i.x-s.width()+i.width-5,"px"),top:"".concat(i.y+i.height+5,"px")})}},onRestrictSwitcherChange:function(e){var t=r()(e.currentTarget);this._restrict_xhr&&this._restrict_xhr.abort(),this._restrict_xhr=(0,a.setAccountSettings)({tags_editable:!t.prop("checked")}).always(o().bind((function(){this._restrict_xhr=null}),this)).done(o().bind((function(e){(e||{}).updated||this.modal.showError()}),this)).fail(o().bind((function(e){"abort"!==e.statusText&&this.modal.showError()}),this))},addNewItem:function(){var e=this._elem("suggest_input").val(),t=this._getItemsHolder().find(".new-tag").attr("data-color")||null,n=new f.default.Base({name:e.trim(),entity:this.options.entity,color:t});return this.saved_add_new_color=null,n.save().then(o().bind((function(){this._list.push(n)}),this)).fail(o().bind((function(){this.modal.showError()}),this))},onTagsRemove:function(e){this.deleted_tags.push(e),this._list.length||this.renderItems()},onTagsChanged:function(){this.tags_changed=!0},onTagsAdd:function(e){this.added_tags.push(e),this._elem("suggest_input").val("").trigger("input").focus()}});var m="../build/transpiled/components/tags/modals/manage/index";window.define(m,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([m])},56815:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var i=n(629133),r=n.n(i),s=n(460159),o=n.n(s),a=n(350562),l=n(445368),c=n(144352),d=n(115764),u=n(986214),_=n(558279),f=n(661533);const h=d.default.extend({tagName:"li",className:"tags-lib__item tags-lib__item_suggest",_classes:function(){return{delete_icon:"js-tags-lib__item-delete",color:"js-tags-lib__item-color",tag_name:"tags-lib__item-name"}},events:function(){var e=r().result(d.default.prototype,"events",{});return e["click ".concat(this._selector("delete_icon"))]="onDeleteClick",e["click ".concat(this._selector("color"))]="onChangeColor",e},initialize:function(e){d.default.prototype.initialize.apply(this,arguments),this.colored_tags_available=Boolean(e.colored_tags_available),this.colored_tags_available&&(this.color_picker=this._addComponent(c.default)),this.listenTo(this.model,"remove",r().bind((function(){this.destroy(!0)}),this))},changeColor:function(e){var t=this.$el.attr("data-tag-id");r().isUndefined(e)||(r().isString(e)&&"#"===e[0]&&(e=e.slice(1)),this.model.set("color",e),this.render(),(0,a.setTagColor)({entity:"leads",id:Number(t),color:e}))},render:function(){var e=this.model.get("color");return this.$el.attr("data-tag-id",this.model.get("id")).attr("data-color",e).html(o()({ref:"/tmpl/common/tags/manage/item.twig"}).render(r().extend({},this.model.toJSON(),{colored_tags_available:this.colored_tags_available}))),this.colored_tags_available&&e&&(this.$el.find(this._selector("tag_name")).css({borderColor:"#".concat(e),backgroundColor:(0,l.hex2rgba)("#".concat(e),.3)}),this.$el.find(this._selector("color")).css({borderColor:"#".concat(e),backgroundColor:"#".concat(e)})),this},onDeleteClick:function(){if(!this.areActionsBlocked())return new u.default({tags:[this.model.toJSON()],complete:r().bind((function(){this.model.collection.remove(this.model)}),this)})},onChangeColor:function(e){var t=this.areActionsBlocked(),n=this;if(!t){var i=e.target.getBoundingClientRect();this.$overflow_color_picker=f(this.color_picker.getTemplate(_.colors)),this.$el.append(this.$overflow_color_picker);var r=this.$overflow_color_picker.find(".segments-color-picker");this.$overflow_color_picker.on("click",(function(){n.$overflow_color_picker.remove()})),r.on("click",".segments-color-picker__item",(function(e){var t=f(e.target).attr("data-color")||null;n.changeColor(t)})),r.css({left:"".concat(i.x-r.width()+i.width-5,"px"),top:"".concat(i.y+i.height+5,"px")})}}});var g="../build/transpiled/components/tags/modals/manage/item";window.define(g,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([g])},816270:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var i=n(629133),r=n.n(i),s=n(974839),o=n.n(s),a={total:0,selected:!1,object_type:{code:"tags",id:APP.element_types.tags}},l=o().Model.extend({url:function(){var e=this.get("entity");return!0===this.isNew()?e?"/ajax/v3/%s/tags/".replace("%s",e):"/ajax/v3/tags/":o().Model.prototype.url.call(this)},parse:function(e){return e.added&&e._embedded&&(e=r().first(e._embedded.items)),o().Model.prototype.parse.call(this,e)},sync:function(e,t,n){return"create"===e&&(n=r().extend(n||{},{contentType:"application/json",data:JSON.stringify([{name:t.get("name"),color:t.get("color")}])})),o().Model.prototype.sync.call(this,e,t,n)}});const c={Base:l.extend({defaults:r().clone(a)}),Selected:l.extend({defaults:r().extend(r().clone(a),{selected:!0})})};var d="../build/transpiled/components/tags/model";window.define(d,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([d])},192399:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var i=n(661533),r=n.n(i),s=n(629133),o=n.n(s),a=n(267651),l=n.n(a);l().subscribe("cf-group:toggle",(function(e,t){r()('.js-cf-group[data-id="'.concat(t.attr("data-id"),'"]')).not(t).trigger(e)}));const c={_toggleCFGroupCallback:"_toggleCFGroup",events:{"cf-group:toggle .js-cf-group":"toggleCFGroupUI","click .js-cf-group":"toggleCFGroupClick"},toggleCFGroupUI:function(e){var t=r()(e.currentTarget),n=Math.abs(t.attr("data-folded")-1);return t.attr("data-folded",n),this[this._toggleCFGroupCallback](t),n},toggleCFGroupClick:function(e){var t=r()(e.currentTarget),n=+t.data("element-type")||APP.element_types[APP.getBaseEntity()];if(0!==parseInt(t.attr("data-foldable"))&&!t.hasClass("need_hide")){var i=this.toggleCFGroupUI(e);this._toggleCFGroupAjax({action:"group_folding",id:t.attr("data-id"),show:i,element_type:n}),l().publish("cf-group:toggle",t)}},_toggleCFGroupAjax:o().debounce((function(e){r().ajax({url:"/ajax/settings/profile/",data:e,type:"POST"})}),200),_toggleCFGroup:function(e){var t=e.next()[0];"none"===t.style.display?t.style.display="":t.style.display="none"}};var d="../build/transpiled/interface/account/mixins/cf_groups";window.define(d,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([d])},144352:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var i=n(629133),r=n.n(i);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=o(e);if(t){var r=o(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}(this,n)}}var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(o,e);var t,n,i=l(o);function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,(n=[{key:"getTemplate",value:function(e){return r().template('<div class="segments-page__overflow">\n        <div class="segments-color-picker">\n          '.concat(r().map(e,(function(e){return'\n            <div class="segments-color-picker__item-wrap">\n              <span class="segments-color-picker__item" '.concat(e?'data-color="'+e+'" style="background: '+e+'"':"",'"></span>\n              <span class="segments-color-picker__item-hover"></span>\n            </div>\n          ')})).join(""),"\n        </div>\n      </div>"))()}}])&&s(t.prototype,n),o}(n(313981).default),d="../build/transpiled/interface/color_picker";window.define(d,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([d])},34158:(e,t,n)=>{n.r(t),n.d(t,{jsonToQS:()=>o});var i=n(629133),r=n.n(i),s=n(661533),o=function(e){var t;return null!==(t=s.param(r().reduce(e,(function(e,t,n){return t&&(e[n]=t),e}),{})))&&void 0!==t?t:""}}}]);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"build_2025_11_28_17_08_33"},function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e7c8c509-4f33-4899-868b-f1bf8c669773",e._sentryDebugIdIdentifier="sentry-dbid-e7c8c509-4f33-4899-868b-f1bf8c669773")}catch(e){}}();
//# sourceMappingURL=79954.f08f7e35a6cc1736b344.js.map