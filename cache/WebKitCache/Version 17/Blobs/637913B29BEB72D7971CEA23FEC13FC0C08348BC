(window.webpackChunk=window.webpackChunk||[]).push([[1170],{629821:function(e,t,n){"use strict";var r,a;r=function(){var e,t={},r="undefined"!=typeof window?window:n.g,a=r.document,i="localStorage",o="script";if(t.disabled=!1,t.version="1.3.20",t.set=function(e,t){},t.get=function(e,t){},t.has=function(e){return void 0!==t.get(e)},t.remove=function(e){},t.clear=function(){},t.transact=function(e,n,r){null==r&&(r=n,n=null),null==n&&(n={});var a=t.get(e,n);r(a),t.set(e,a)},t.getAll=function(){},t.forEach=function(){},t.serialize=function(e){return JSON.stringify(e)},t.deserialize=function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e||void 0}},function(){try{return i in r&&r[i]}catch(e){return!1}}())e=r[i],t.set=function(n,r){return void 0===r?t.remove(n):(e.setItem(n,t.serialize(r)),r)},t.get=function(n,r){var a=t.deserialize(e.getItem(n));return void 0===a?r:a},t.remove=function(t){e.removeItem(t)},t.clear=function(){e.clear()},t.getAll=function(){var e={};return t.forEach((function(t,n){e[t]=n})),e},t.forEach=function(n){for(var r=0;r<e.length;r++){var a=e.key(r);n(a,t.get(a))}};else if(a&&a.documentElement.addBehavior){var s,u;try{(u=new ActiveXObject("htmlfile")).open(),u.write("<"+o+">document.w=window</"+o+'><iframe src="/favicon.ico"></iframe>'),u.close(),s=u.w.frames[0].document,e=s.createElement("div")}catch(t){e=a.createElement("div"),s=a.body}var c=function(n){return function(){var r=Array.prototype.slice.call(arguments,0);r.unshift(e),s.appendChild(e),e.addBehavior("#default#userData"),e.load(i);var a=n.apply(t,r);return s.removeChild(e),a}},d=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),l=function(e){return e.replace(/^d/,"___$&").replace(d,"___")};t.set=c((function(e,n,r){return n=l(n),void 0===r?t.remove(n):(e.setAttribute(n,t.serialize(r)),e.save(i),r)})),t.get=c((function(e,n,r){n=l(n);var a=t.deserialize(e.getAttribute(n));return void 0===a?r:a})),t.remove=c((function(e,t){t=l(t),e.removeAttribute(t),e.save(i)})),t.clear=c((function(e){var t=e.XMLDocument.documentElement.attributes;e.load(i);for(var n=t.length-1;n>=0;n--)e.removeAttribute(t[n].name);e.save(i)})),t.getAll=function(e){var n={};return t.forEach((function(e,t){n[e]=t})),n},t.forEach=c((function(e,n){for(var r,a=e.XMLDocument.documentElement.attributes,i=0;r=a[i];++i)n(r.name,t.deserialize(e.getAttribute(r.name)))}))}try{var _="__storejs__";t.set(_,_),t.get(_)!=_&&(t.disabled=!0),t.remove(_)}catch(e){t.disabled=!0}return t.enabled=!t.disabled,t},void 0===(a=r.apply(t,[]))||(e.exports=a);var i="store";window.define(i,(function(){var t="undefined",n=typeof __webpack_exports__===t?typeof a===t?typeof e===t?void 0:e.exports:a:__webpack_exports__;return n&&n.default||n})),window.require([i])},923703:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var r,a=n(629133),i=n.n(a),o=n(444459),s=function(){(r=new o.default("/api/v1.1")).loadBackendVersion()};i().extend(s.prototype,{linkLead:function(e,t){var n=r.makeUrl("/account_id/mail/leads/link"),a={lead_id:t,thread_id:e};return r.request("POST",n,a)},unlinkLead:function(e){var t=r.makeUrl("/account_id/mail/leads/unlink"),n={thread_id:e};return r.request("POST",t,n)},getAddressesWithoutContact:function(e){var t=r.makeUrl("/account_id/mail/address"),n={thread_ids:e,type:"without_contact"};return r.request("GET",t,n)},linkAddress:function(e,t){var n=r.makeUrl("/account_id/mail/address/link"),a={id:t,address_id:e};return r.request("POST",n,a)},listThreads:function(e,t,n,a){var i=r.makeUrl("/account_id/mail/list"),o={page:t||1,folder:e,mailbox_id:n};return r.request("GET",i,o,{},a||{})},restoreThreads:function(e){var t=r.makeUrl("/account_id/mail/threads/restore"),n={threads:e};return r.request("POST",t,n)},deleteThreads:function(e){var t=r.makeUrl("/account_id/mail/threads/delete"),n=i().extend({},{threads:e});return r.request("POST",t,n)},createEntitiesFromThreads:function(e,t,n){var a=r.makeUrl("/account_id/mail/".concat(t)),o=i().extend({},n,{threads:e});return r.request("POST",a,o)},deleteMailbox:function(e){var t=r.makeUrl("/account_id/mail/mailboxes/".concat(e,"/delete"));return r.request("POST",t)},enableMailbox:function(e,t){var n=r.makeUrl("/account_id/mail/mailboxes/".concat(e,"/connect"));return r.request("POST",n,t)},disableMailbox:function(e){var t=r.makeUrl("/account_id/mail/mailboxes/".concat(e,"/disconnect"));return r.request("POST",t)},syncMailbox:function(e){var t=r.makeUrl("/account_id/mail/mailboxes/".concat(e,"/sync"));return r.request("POST",t)},addMailbox:function(e){var t=r.makeUrl("/account_id/mail/mailboxes");return r.request("POST",t,e)},saveMailbox:function(e,t,n){var a=r.makeUrl("/account_id/mail/mailboxes/".concat(e,"?save=").concat(n));return r.request("POST",a,t)},getMailbox:function(e){var t=r.makeUrl("/account_id/mail/mailboxes/".concat(e));return r.request("GET",t)},getMailboxes:function(e){var t=r.makeUrl("/account_id/mail/mailboxes");return r.request("GET",t,e)},getMailboxStatus:function(e){var t=r.makeUrl("/account_id/mail/mailboxes/status"),n={id:e};return r.request("GET",t,n)},getCounters:function(){var e=r.makeUrl("/account_id/mail/mailboxes/counters");return r.request("GET",e)},getThread:function(e,t,n){var a=r.makeUrl("/account_id/mail/threads/".concat(e));return r.request("GET",a,t||{},{},n)},getMessage:function(e){var t=r.makeUrl("/account_id/mail/messages/".concat(e));return r.request("GET",t)},readThread:function(e,t){var n=r.makeUrl("/account_id/mail/threads/view"),a={threads:e};return r.request("POST",n,a,{},t)},shareThread:function(e,t){var n=r.makeUrl("/account_id/mail/threads/share"),a=i().extend(t,{threads:e});return r.request("POST",n,a)},findSettings:function(e){var t=r.makeUrl("/account_id/mail/settings"),n={email:e};return r.request("GET",t,n)},getThreadReplyData:function(e){var t=r.makeUrl("/account_id/mail/threads/".concat(e,"/reply"));return r.request("GET",t)},composeReply:function(e,t){var n=e?"threads/".concat(e,"/reply"):"reply",a=r.makeUrl("/account_id/mail/".concat(n));return r.request("POST",a,t)},composeMailing:function(e){var t=r.makeUrl("/account_id/mail/compose");return r.request("POST",t,e)},getRecipients:function(e){var t=r.makeUrl("/account_id/mail/threads/recipients");return r.request("GET",t,e)},getMailTemplates:function(e){var t=r.makeUrl("/account_id/mail/templates");return r.request("GETJSON",t,e)},createMailTemplate:function(e){var t=r.makeUrl("/account_id/mail/templates");return r.request("POST",t,e)},updateMailTemplate:function(e){var t=r.makeUrl("/account_id/mail/templates/".concat(e.id));return r.request("POST",t,e)},removeMailTemplate:function(e){var t=r.makeUrl("/account_id/mail/templates/".concat(e.id,"/delete"));return r.request("POST",t,e)},updateMailTemplatesSort:function(e){var t=r.makeUrl("/account_id/mail/templates/sort");return r.request("POST",t,e)}});const u=new s;var c="../build/transpiled/components/mail/api";window.define(c,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([c])},444459:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l});var r=n(629133),a=n.n(r),i=n(661533),o=n.n(i),s=n(12615),u=n(509372);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=function(e,t){this.base_path=e,this.headers=a().extend({"X-Requested-With":"XMLHttpRequest"},t||{})};a().extend(d.prototype,{loadBackendVersion:function(){var e;(e=(0,u.get)("amomail_backend"))&&(e=JSON.parse(e),a().isString(e.backend)&&(this.headers["X-App-Api-Backend"]=e.backend),this.headers["X-App-Version"]=e.version)},setBackendVersion:function(e,t){if(a().isUndefined(e)&&a().isUndefined(t)||a().isUndefined(t)&&"current"===e)return(0,u.set)({name:"amomail_backend",value:"{}",expiredays:-1}),delete this.headers["X-App-Api-Backend"],void delete this.headers["X-App-Version"];e=e||"current",this.headers["X-App-Version"]=e;var n={backend:null,version:e};a().isString(t)&&(this.headers["X-App-Api-Backend"]=t,n.backend=t),(0,u.set)({name:"amomail_backend",expiredays:1,value:JSON.stringify(n)})},getParams:function(){var e=APP.constant("amomail")||{};return{enabled:e.enabled,account_id:APP.constant("account").id,base_url:e.server_base+this.base_path,auth_token:e.auth_token||""}},getAjaxDefaults:function(e){var t={xhrFields:{withCredentials:!0},contentType:"application/json; charset=UTF-8"};return t.headers=a().extend({},this.headers,e||{}),t},resolveOnCache:function(e,t){var n=o().Deferred(),r=a().bind((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.resolve.apply(this,t)}),this),i=a().bind((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.reject(this,t)}),this);return e.done((function(e,n,a){304===a.status?t().done(r).fail(i):r.apply(this,arguments)})).fail(i),n.promise()},makeRequest:function(){var e=Array.prototype.slice.call(arguments);return a().bind((function(){return this.request.apply(this,function(e){if(Array.isArray(e))return c(e)}(t=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var t}),this)},checkAccount:function(){var e=this.getParams(),t=APP.constant("amomail");if(e.enabled||!APP.constant("amomail")){var n=o().Deferred();return n.resolve(),n.promise()}var r="".concat(t.server_base,"/api/v2/register"),i=APP.constant("account"),s={account_id:i.id,domain:i.subdomain},u=a().extend(this.getAjaxDefaults(),{url:r,data:JSON.stringify(s),type:"POST",dataType:"json"}),c=o().ajax(u);return c.done((function(){t.enabled=!0})),c},makeUrl:function(e,t){var n=this.getParams();return t=t||{},n.account_id&&(t.account_id=n.account_id),a().each(t,(function(t,n){e=e.replace(n,t)})),n.base_url+e},_request:function(e,t,n,r,i){var u=o().Deferred();r=r||{},n=n||{},"GET"!==e&&(n=JSON.stringify(n),"GETJSON"===e?r["X-Http-Method-Override"]="GET":"POST"!==e&&(r["X-Http-Method-Override"]=e),e="POST");var c=a().extend(this.getAjaxDefaults(r),{url:t,data:n,type:e,dataType:"json"},i||{});return o().ajax(c).done((function(){u.resolve.apply(null,arguments)})).fail((function(e){401===e.status?s.default.checkAuth((function(){return o().ajax(c)}),0).done((function(){u.resolve.apply(null,arguments)})).fail((function(){u.reject.apply(null,arguments)})):u.reject.apply(null,arguments)})),u.promise()},requestRaw:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0,s=a().extend({url:t,data:n,type:e,headers:r,dataType:"json"},i||{});return o().ajax(s)},request:function(e,t,n,r,i){var o=this;return this.checkAccount().always((function(){o.request=o._request})).then(a().bind(o._request,this,e,t,n,r,i))}});const l=d;var _="../build/transpiled/components/mail/base_api";window.define(_,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([_])},12615:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>m});var r=n(661533),a=n.n(r),i=n(629133),o=n.n(i),s=n(910),u=n(168807),c=n(11024),d=APP.constant("version"),l=APP.constant("version_backend"),_=o().propertyOf(window)(["performance","timing","responseEnd"])||0,f=null;function p(e,t){var n=Date.now()-_,r=a().Deferred();return n<(t=o().isNumber(t)?t:6e4)?e().then(r.resolve,r.reject):(_=Date.now(),f||(f=a().ajax({url:"/private/ping.php"}).always((function(){f=null}))),f.done((function(){e().then(r.resolve,r.reject)})).fail(r.reject)),r.promise()}"production"===APP.environment&&a()(document).ajaxComplete((function(e,t,n){var r=APP.constant("server"),i=t.getResponseHeader("X-Core-Version"),_=t.getResponseHeader("X-Core-Server"),f=t.getResponseHeader("X-Core-Version-Backend"),p=t.getResponseHeader("X-Generation-Time"),m=t.getResponseHeader("X-Generation-Time-System"),v=t.getResponseHeader("X-Core-Session-Token"),g=t.getResponseHeader("X-Core-Widgets-Cache-Version"),h={},y=0,b=t===APP.page_xhr,P=(0,s.getCallingStatus)(),w=o().isNull(i)||d===i,A=o().isNull(f)||l===f;_&&_!==r&&APP.constant("server",_),v&&v!==APP.constant("session_token")&&APP.constant("session_token",v),(p||m)&&(y=p||m,a()(document).find(".generation-time").append("<br>".concat(y," - ").concat(n.url))),w&&A||P||(A&&b||!A)&&(window.location.href=document.URL),o().isEmpty(g)||(h[APP.getWidgetsArea()]=g,o().extend(APP.constant("widgets_cache_version"),h),u.storeWithExpiration.remove(c.default.getCacheCode()))}));const m={check:function(){var e=a().Deferred();return e.resolve(),p(e.promise,0)},checkAuth:p};var v="../build/transpiled/core/updater";window.define(v,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([v])},11024:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var r=n(629133),a=n.n(r),i=n(661586),o=n.n(i),s=n(926168),u=n(859200);const c={getCacheCode:function(){var e="".concat((0,s.getVersion)(),"_linked_types_cache_").concat(APP.lang_id,"_").concat((0,u.userID)()),t=(0,u.getRights)("catalog_rights")||{},n=a().map(t,(function(e,t){var n=+(e.view!==u.RIGHTS_DENIED);return"".concat(t,":").concat(n)}));return n.length&&(e+="_".concat(o()(n.join("_")))),e},linked_types_cache_lifetime:36e5};var d="../build/transpiled/interface/card/linked/constants";window.define(d,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([d])},400605:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var r=n(661533),a=n.n(r),i=n(629133),o=n.n(i),s=n(156040),u=n(397927),c=n(923703),d=a()(document);function l(){APP.constant("amomail").enabled&&c.default.getCounters().done((function(e){(0,u.updateItemCounter)({id:u.CounterId.MAIL,count:e.unreadCount}),APP.constant("amomail").mailboxes.active=e.active,APP.constant("amomail").mailboxes.smtp_supports=e.smtpSupports}))}var _=o().throttle(l,1e4,{trailing:!1});d.on("mail:update:counter",(function(){l()})).on("page:changed",(function(){s.onPageFullyLoaded(_)})).on("mailbox:view:settings",(function(e,t){location.href.includes("/mail/settings")&&!APP.data.is_card?(a()(window).scrollTop(0),APP.data.current_view.showMailSettings(e,t)):(t=o().isUndefined()?"general":t,APP.router.navigate("/mail/settings/?mailbox-setup=".concat(t),{trigger:!0}))})),s.onPageFullyLoaded(_);const f={};var p="../build/transpiled/interface/mail/common";window.define(p,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([p])},910:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getCallingStatus:()=>l,runMerge:()=>f,setCallingStatus:()=>d,showUserStatus:()=>_});var r=n(629133),a=n.n(r),i=n(214558);function o(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,a)}var s,u,c=!1,d=function(e){return"calling_status - "+(c=e)},l=function(){return c},_=function(e){var t={},n=(0,i.get)();switch(!0){case"online"===e:t=[],a().each(n,(function(e){!0===e.online&&t.push(e.id)}));break;case!a().isNaN(parseInt(e))&&!a().isUndefined((0,i.get)(e)):t=(0,i.get)(e).online||!1;break;default:a().each(n,(function(e,n){t[n]={},t[n].id=e.id,t[n].online=e.online||!1}))}return t},f=(s=function(e){return function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(t){switch(t.label){case 0:return[4,Promise.all([n.e(68592),n.e(45839),n.e(26632),n.e(50769),n.e(4483),n.e(73197),n.e(85826)]).then(n.bind(n,450769))];case 1:return[2,new(0,t.sent().default)(e)]}}))},u=function(){var e=this,t=arguments;return new Promise((function(n,r){var a=s.apply(e,t);function i(e){o(a,n,r,i,u,"next",e)}function u(e){o(a,n,r,i,u,"throw",e)}i(void 0)}))},function(e){return u.apply(this,arguments)}),p="../build/transpiled/sdk/index";window.define(p,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([p])},859200:(e,t,n)=>{"use strict";n.r(t),n.d(t,{RIGHTS_DENIED:()=>f,RIGHTS_FULL:()=>d,RIGHTS_GROUP:()=>l,RIGHTS_LINKED:()=>p,RIGHTS_MAIN:()=>_,canCatalog:()=>A,canDeleteCard:()=>w,canEditCard:()=>P,canImport:()=>T,canTask:()=>E,canViewLead:()=>S,getContactsMergedRights:()=>x,getRights:()=>v,groupMatesIDs:()=>y,hasRestrictedFieldAccess:()=>k,isAdmin:()=>g,isFromCard:()=>b,refreshCache:()=>m,userID:()=>h});var r=n(629133),a=n.n(r),i=n(866633),o=n(926168),s=n(214558),u=null;function c(e,t){var n=u;return null===n||a().isUndefined(e)||(n=a().has(n,e)?n[e]:null,t&&(n=a().has(n,t)?n[t]:null)),n}var d="A",l="G",_="M",f="D",p="L",m=function(){var e,t=APP.constant("user_rights");if(t){e=["add","add_company","has_multi","view_company","merge","view","edit","add_task","change_status","change_field","reassign","delete","manage_tags","import","export","can_save","copy"],(u=u||{}).contacts=a().extend({},u.contacts,t.contacts,t.contacts.CONTACT||{}),u.contacts=a().pick(u.contacts,e),e=["add_company","has_multi","view_company","merge","view","edit","add_task","change_status","change_field","reassign","delete","manage_tags","add","import","export","can_save","copy"],u.companies=a().extend({},u.companies,t.companies,t.contacts.COMPANY||{}),u.companies=a().pick(u.companies,e),a().each({leads:["view","edit","change_status","change_field","reassign","add_task","delete","manage_tags","add","import","export","has_multi","merge","can_save","can_delete"],todo:["delete","open","close","reassign","change_task_date","change_task_type_in_list"],tasks:["edit","delete"],unsorted:["accept","decline","denied"],customers:["view","export","edit","add","delete","reassign","has_multi","add_task","change_field","manage_tags"],tags:["add"],files:["view","delete"],mail:["add_contacts","add_customers","add_leads","delete_thread","mailing","multi_read","resend","reply","restore_thread"],"contacts-trash":["restore"],"leads-trash":["restore"],"todo-trash":["restore"],"files-trash":["restore"],users:["change_group","change_role","deactivate","activate","delete","email_confirm"],helpbot:["delete","activate","deactivate"],helpbot_dataset:["delete"],reply_templates:["delete"],broadcasting_scheduled:["delete","copy"],broadcasting_in_progress:["stop"],broadcasting_draft:["delete"],broadcasting_completed:["delete","copy"],bots_list:["delete","copy","deactivate_bot","activate_bot","stop_bot","reset_bot","export_bot"],onlinechats_list:["delete"],bots_list_marketing:["delete","copy","deactivate_bot","activate_bot","stop_bot","reset_bot","export_bot"],operday_report:["delete"],cleaning_rules_list:["delete"],restricted_fields:["leads","customers","contacts","companies"]},(function(e,n){u[n]=a().extend({},u[n],t[n]),u[n]=a().pick(u[n],e)})),u.is_admin=!!t.is_admin,u.is_free_user=!!t.is_free_user,u.mail_admin=!!t.mail_admin,u.duplicate_search=!!t.duplicate_search,u.base_rights=t.base_rights||{},u.status_rights=t.status_rights||{},u.catalog_rights=t.catalog_rights||{},u.catalogs=t.catalogs||{},u.oper_day_user_tracking=t.oper_day_user_tracking,u.oper_day_reports_view_access=t.oper_day_reports_view_access;var n=APP.constant("user");e=["id","group_mates_ids"],u.user=a().extend({},u.user,a().pick(n,e)),u.user.id=parseInt(u.user.id)}},v=function(e,t,n){var r;return u&&!0!==n||m(),null===(r=c(e,t))&&(m(),r=c(e,t)),r},g=function(){return!!v("is_admin")},h=function(){return v("user","id")},y=function(){return v("user","group_mates_ids")},b=function(){return APP.data.current_card&&APP.data.current_card.id>0&&APP.data.current_card.element_type>0},P=function(){return v(APP.data.current_entity,"can_save",!0)||"customers"===APP.data.current_entity&&APP.constant("grant_edit")},w=function(){return v(APP.data.current_entity,"can_delete",!0)||"customers"===APP.data.current_entity&&APP.constant("grant_delete")},A=function(e,t,n){var r,o,s;return APP.constant("account").pay_type!==i.PayType.PAYMENT_TYPE_BLOCK&&(g()?s=!0:(n=!!a().isUndefined(n)&&b(),r=(v("catalog_rights")[t]||{})[e]||f,o=n?[d,p]:[d],s=-1!==a().indexOf(o,r),n&&r===p&&("edit"===e?s=s&&P():"delete"===e&&(s=s&&w()))),s)},k=function(e,t,n){var r=v("restricted_fields",t)||[];return n=n||"edit",!!r[e]&&!1===a().propertyOf(r)([e,n])},E=function(e,t,n){var r,i,u,c,f,p,m=t.element_type||APP.element_types.todo,h=(0,o.convertElementType)(m,"string"),y=null,b=!1,P=(0,s.current)().id;if(n=n||{},"todos"===h&&(h="tasks"),g())b=!0;else switch(i=m===APP.element_types.todo?Number(t.responsible_user_id):Number(n.responsible_user_id),m===APP.element_types.leads&&(r=v("status_rights"),f=n.pipeline_id||0,p=n.status_id||0,y=a().propertyOf(r)([f,p])||null),null===y&&(y=v("base_rights",h)),y[e]){case d:b=!0;break;case _:b=P&&P===i;break;case l:u=(0,s.get)(!0)[P]||{},c=(0,s.get)(!0)[i]||{},b=!a().isEmpty(u)&&!a().isEmpty(c)&&u.group===c.group}return b},x=function(){var e={};m();var t=v("contacts"),n=v("companies");return a().each(a().keys(t),(function(r){e[r]=t[r]&&n[r]})),e},T=function(){return v("leads","import")||v("contacts","import")||v("company","import")},S=function(e,t){if(g())return!0;var n=v("status_rights");if(0===t){var r=a().keys(n);t=parseInt(a().first(r))}var i=a().propertyOf(n)([t,e,"view"]);return i===d||a().isUndefined(i)},U="../build/transpiled/utils/account/rights";window.define(U,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([U])},214558:(e,t,n)=>{"use strict";n.r(t),n.d(t,{add:()=>S,addGroup:()=>q,changeUserGroup:()=>O,current:()=>T,deleteGroup:()=>C,fetch:()=>N,first:()=>M,get:()=>w,getByAmoJoId:()=>x,getGroupName:()=>U,getLangTranslation:()=>P,getUserName:()=>D,isUserOnline:()=>B,remove:()=>E,saveGroupChange:()=>R,set:()=>k,updateAmoJoHash:()=>A,updateGroupName:()=>I,updateOnline:()=>G});var r=n(629133),a=n.n(r),i=n(661533),o=n.n(i),s=n(987081),u=n(128508),c=n(156040),d=n(445368),l=n(955026),_=n(761634),f=new s.Subject,p=new s.ReplaySubject(1),m=o().extend(!0,{},APP.constant("managers")||{}),v=o().extend(!0,{},APP.constant("free_users")||{}),g=o().extend(!0,{},APP.constant("user")||{}),h=o().extend(!0,{},APP.constant("groups")||{}),y={},b={en:"English",es:"Spanish",pt:"Portuguese",id:"Indonesian",tr:"Turkish",ru:"Russian"},P=function(e){return e?b[e]:b[APP.lang_id]};function w(e){var t,n={},r={},i=parseInt(e);if(i>0)return(t=m[i]||v[i])?a().extend({},t):t;switch(a().each(m,(function(e,t){e.active?n[t]=e:r[t]=e})),!0){case!0===e:case"all"===e:return o().extend(!0,{},n,v);case"free"===e:return o().extend(!0,{},v);case"inactive"===e:return o().extend(!0,{},r);case"everyone"===e:return o().extend(!0,{},m,v);case"groups"===e:return o().extend(!0,{},h);case"clean_groups"===e:return a().reduce(w("groups"),(function(e,t,n){var r=parseInt(n.replace("group_",""));return("group_free_users"===n||r>=0)&&e.push({id:"group_free_users"===n?"free_users":r,option:a().escape(t)}),e}),[]);default:return o().extend(!0,{},n)}}function A(){y=a().chain(w(!0)).reduce((function(e,t){return t.amojo_id&&(e[t.amojo_id]=t),e}),{}).value(),a().extend(y,a().reduce((0,_.get)(),(function(e,t){return("amojo_bot_default"===t.code||t.is_integration_bot)&&(e[t.amojo_id]=t),e}),{}))}function k(e){return a().extend(m,e),APP.constant("managers",m),A(),w()}function E(e){e=a().map(e,(function(e){return+e}));var t={paid:a().chain(m).keys().map((function(e){return+e})).intersection(e).value(),free:a().chain(v).keys().map((function(e){return+e})).intersection(e).value()};return a().isEmpty(t.paid)||(m=a().omit(m,t.paid),APP.constant("managers",m)),a().isEmpty(t.free)||(v=a().omit(v,t.free),APP.constant("free_users",v)),A(),a().extend({},m,v)}function x(){return a().extend({},y)}function T(e,t){var n=g;return a().isUndefined(e)||(t?(n[e]=t,APP.constant("user")[e]=t):n=n[e]),n}function S(e){var t={},n=m,r="managers";"Y"!==e.is_free&&"Y"!==e.free_user||(n=v,r="free_users"),t[e.id]=a().clone(e),n[e.id]&&(t[e.id].online=n[e.id].online),a().extend(n,t),APP.constant(r,n),A()}function U(e){return"group_free_users"===e?(0,d.i18n)("Free users"):(e=(a().isNumber(e)?e:e||"").toString().replace(/[^0-9]+/g,""),w("groups")["group_".concat(e)]||(0,d.i18n)("Group deleted"))}function D(e){var t=w(e)||{};return 0===parseInt(e)?(0,d.i18n)("Bot"):t.title||(0,d.i18n)("User deleted")}function I(e,t){var n="group_".concat(e),r={};w("groups")[n]&&t&&(r[n]=t,a().extend(h,r))}function C(e){w("groups")["group_".concat(e)]&&(h=a().omit(h,"group_".concat(e)))}function q(e){var t={};a().isObject(e)&&e.id&&e.name&&(t["group_".concat(e.id)]=e.name,a().extend(h,t))}function O(e,t){var n=w("everyone")[e];"Y"===n.free_user&&E([e]),a().extend(n,{group:"group_".concat(t),free_user:"N"}),S(n)}function R(e){return new Promise((function(t,n){e.group_new===e.group_old||"free"===e.group_new?t():o().ajax({url:"/ajax/v1/users/set",headers:{"X-Session-Token":APP.constant("session_token")},type:"POST",dataType:"json",data:{request:{users:{change_group:{group_id:e.group_new,id:[e.userID]}}}}}).done((function(r){var i=e.userID,o=w("everyone")[i];(0,l.hasKeys)(r,["response","users","set","change_group",i,"result"])?("Y"===o.free_user&&E([i]),a().extend(o,{active:!0}),S(o),O(i,e.group_new),t()):n()})).fail(n)}))}function M(){return a().values(w())[0]}function N(){return p.asObservable()}function j(e){return e}function L(){return s.from(o().ajaxPromisify({url:"/ajax/get_managers_with_group/",type:"POST",data:{free_users:"Y"},dataType:"json"}).then((function(e){return h=e.groups,e})))}function G(e,t){var n;a().each(e,(function(e){n=m[e]||v[e],a().isUndefined(n)||(n.online=t,y[n.amojo_id]&&(y[n.amojo_id].online=t))}))}function B(e){return!!(m[e]||{}).online||!!(v[e]||{}).online}(0,c.onPageFullyLoaded)((function(){s.merge(f,s.fromEvent(o()(document),"loaded_users:null")).pipe(u.startWith(!0),u.switchMap(L),u.map(j)).subscribe(p)})),A();var F="../build/transpiled/utils/account/users";window.define(F,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([F])},189851:function(e){!function(t){"use strict";var n=-1,r={onVisible:function(e){var t=r.isSupported();if(!t||!r.hidden())return e(),t;var n=r.change((function(t,a){r.hidden()||(r.unbind(n),e())}));return n},change:function(e){if(!r.isSupported())return!1;var t=n+=1;return r._callbacks[t]=e,r._listen(),t},unbind:function(e){delete r._callbacks[e]},afterPrerendering:function(e){var t=r.isSupported(),n="prerender";if(!t||n!=r.state())return e(),t;var a=r.change((function(t,i){n!=i&&(r.unbind(a),e())}));return a},hidden:function(){return!(!r._doc.hidden&&!r._doc.webkitHidden)},state:function(){return r._doc.visibilityState||r._doc.webkitVisibilityState||"visible"},isSupported:function(){return!(!r._doc.visibilityState&&!r._doc.webkitVisibilityState)},_doc:document||{},_callbacks:{},_change:function(e){var t=r.state();for(var n in r._callbacks)r._callbacks[n].call(r._doc,e,t)},_listen:function(){if(!r._init){var e="visibilitychange";r._doc.webkitVisibilityState&&(e="webkit"+e);var t=function(){r._change.apply(r,arguments)};r._doc.addEventListener?r._doc.addEventListener(e,t):r._doc.attachEvent(e,t),r._init=!0}}};e.exports?e.exports=r:t.Visibility=r}(this)},334254:(e,t,n)=>{!function(t){"use strict";var r=-1,a=function(e){return e.every=function(t,n,a){e._time(),a||(a=n,n=null);var i=r+=1;return e._timers[i]={visible:t,hidden:n,callback:a},e._run(i,!1),e.isSupported()&&e._listen(),i},e.stop=function(t){return!!e._timers[t]&&(e._stop(t),delete e._timers[t],!0)},e._timers={},e._time=function(){e._timed||(e._timed=!0,e._wasHidden=e.hidden(),e.change((function(){e._stopRun(),e._wasHidden=e.hidden()})))},e._run=function(n,r){var a,i=e._timers[n];if(e.hidden()){if(null===i.hidden)return;a=i.hidden}else a=i.visible;var o=function(){i.last=new Date,i.callback.call(t)};if(r){var s=new Date-i.last;a>s?i.delay=setTimeout((function(){o(),i.id=setInterval(o,a)}),a-s):(o(),i.id=setInterval(o,a))}else i.id=setInterval(o,a)},e._stop=function(t){var n=e._timers[t];clearInterval(n.id),clearTimeout(n.delay),delete n.id,delete n.delay},e._stopRun=function(t){var n=e.hidden(),r=e._wasHidden;if(n&&!r||!n&&r)for(var a in e._timers)e._stop(a),e._run(a,!n)},e};e.exports?e.exports=a(n(189851)):a(t.Visibility)}(window)}}]);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"build_2025_11_28_17_08_33"},function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="b80bb93c-7385-42b1-a237-930ce7afd8fe",e._sentryDebugIdIdentifier="sentry-dbid-b80bb93c-7385-42b1-a237-930ce7afd8fe")}catch(e){}}();
//# sourceMappingURL=1170.16bcf1fcfe0bd9308011.js.map