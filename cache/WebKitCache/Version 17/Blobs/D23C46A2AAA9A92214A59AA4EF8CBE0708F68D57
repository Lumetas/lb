"use strict";(window.webpackChunk=window.webpackChunk||[]).push([[88320],{9008:(e,t,n)=>{n.r(t),n.d(t,{ExistingExternalChatTarget:()=>d});var r=n(445368),i=n(580326),o=n(750097),a=n(570286),c=n(181605);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}(this,n)}}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(d,e);var t,n,o,u=f(d);function d(e){var t,n=e.chat_id,r=e.contact_name,i=e.contact_id,o=e.origin,a=e.origin_name,c=e.origin_icon_url,s=e.source_id,l=e.lead_source_name,f=e.amojo_user_id,_=e.phone,p=e.talk_id,h=e.intercom_talk_id,y=e.category;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=u.call(this))._chat_id=n,t._contact_name=r,t._contact_id=i,t._origin=o||"facebook",t._origin_name=a,t._origin_icon_url=c,t._source_id=s,t._lead_source_name=l,t._amojo_user_id=f,t._phone=_,t._talk_id=p,t._intercom_talk_id=h,t._category=y,t._id="ExistingExternalChatTarget:".concat(t._chat_id),t._prototype=d._prototype,t}return t=d,n=[{key:"getContactId",value:function(){return this._contact_id}},{key:"getContactName",value:function(e){return e?this._contact_name:this._contact_name||"..."}},{key:"getOrigin",value:function(){return this._origin}},{key:"getId",value:function(e){var t=this._id;return e&&(t+=":".concat(e)),t}},{key:"getOriginName",value:function(){return this._origin_name}},{key:"getOriginIconUrl",value:function(){return this._origin_icon_url}},{key:"getChatId",value:function(){return this._chat_id}},{key:"getPhone",value:function(){return this._phone}},{key:"getTalkInfo",value:function(){return"amo.intercom"===this._origin&&this._talk_id?"â„–A"+this._talk_id:""}},{key:"setTalkId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this._talk_id=e}},{key:"setCategory",value:function(e){this._category=e}},{key:"getTalkId",value:function(){return this._talk_id||""}},{key:"getAmojoUserId",value:function(){return this._amojo_user_id}},{key:"getLeadSourceName",value:function(){return this._lead_source_name}},{key:"getSourceId",value:function(){return this._source_id}},{key:"getFullTitle",value:function(e){var t=e.contact_name,n=e.with_source_name,o=void 0!==n&&n,a=this.getTalkInfo(),c=this.getPhone(),s=this.getLeadSourceName(),u=this.getOriginName(),l="";return l+=t,a&&(l+=" (".concat(a,")")),c&&i.AmoJoMediator.checkWithOriginalProfilePhoneShown(this._chat_id)&&(l+=" ".concat((0,r.phone)(c))),o&&(s||u)&&(l+=" / ".concat(s||u)),l}}],o=[{key:"_prototype",get:function(){return"ExistingExternalChatTarget"}},{key:"checkIsInstance",value:function(e){return e&&e._prototype===d._prototype}},{key:"createFromChat",value:function(e){var t=c.Chat.getId(e),n=c.Chat.getExternalContact(e);if(!n)throw new Error("Chat doesn't have external_contact.");return new d({chat_id:t,contact_name:a.ExternalContact.getFullName(n),contact_id:a.ExternalContact.getLinkedEntityId(n),origin:a.ExternalContact.getOrigin(n),origin_name:a.ExternalContact.getOriginName(n),origin_icon_url:a.ExternalContact.getOriginIconUrl(n),source_id:a.ExternalContact.getSourceId(n),lead_source_name:a.ExternalContact.getLeadSourceName(n),amojo_user_id:a.ExternalContact.getAmojoUserId(n),phone:a.ExternalContact.getOriginalProfilePhone(n),intercom_talk_id:a.ExternalContact.getIntercomTalkId(n)})}}],n&&s(t.prototype,n),o&&s(t,o),d}(o.ExternalChatTarget),_="../build/transpiled/interface/card/chat_entities/existing_external_chat_target";window.define(_,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([_])},750097:(e,t,n)=>{function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t),n.d(t,{ExternalChatTarget:()=>i});var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"getContactId",value:function(){throw new Error("Must be implemented by subclass!")}},{key:"getOrigin",value:function(){throw new Error("Must be implemented by subclass!")}},{key:"getId",value:function(){throw new Error("Must be implemented by subclass!")}},{key:"getOriginName",value:function(){throw new Error("Must be implemented by subclass!")}},{key:"getOriginIconUrl",value:function(){throw new Error("Must be implemented by subclass!")}},{key:"getLeadSourceName",value:function(){throw new Error("Must be implemented by subclass!")}},{key:"getFullTitle",value:function(){throw new Error("Must be implemented by subclass!")}},{key:"getPhone",value:function(){throw new Error("Must be implemented by subclass!")}}])&&r(t.prototype,n),e}()},784854:(e,t,n)=>{n.r(t),n.d(t,{WriteFirstExternalChatTarget:()=>f});var r=n(629133),i=n.n(r),o=n(445368),a=n(580326);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}(this,n)}}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(f,e);var t,n,r,s=l(f);function f(e){var t,n=e.contact_id,r=e.contact_name,i=e.lead_source_model,o=e.phone;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=s.call(this))._contact_id=n,t._contact_name=r,t._lead_source_model=i,t._phone=o,t._id="WriteFirstExternalChatTarget:".concat(i.getId(),":").concat(t._contact_id,":").concat(t._phone),t._prototype=f._prototype,t}return t=f,r=[{key:"_prototype",get:function(){return"WriteFirstExternalChatTarget"}},{key:"checkIsInstance",value:function(e){return e&&e._prototype===f._prototype}}],(n=[{key:"getContactId",value:function(){return this._contact_id}},{key:"getContactName",value:function(){return this._contact_name}},{key:"getOrigin",value:function(){return this._lead_source_model.getOrigin()}},{key:"getId",value:function(){return this._id}},{key:"getTalkId",value:function(){return""}},{key:"getOriginName",value:function(){return this._lead_source_model.getOriginName()}},{key:"getOriginIconUrl",value:function(){return this._lead_source_model.getOriginIconUrl()}},{key:"getPhone",value:function(){return this._phone}},{key:"getSourceId",value:function(){return this._lead_source_model.getSourceId()}},{key:"getScopeId",value:function(){return this._lead_source_model.getScopeId()}},{key:"getLeadSourceName",value:function(){return this._lead_source_model.getName()}},{key:"getFullTitle",value:function(e){var t=e.contact_name,n=e.with_source_name,r=void 0!==n&&n,c=this.getLeadSourceName(),s=(0,o.capitalize)(this.getOriginName()||this.getOrigin()),u=this.getPhone(),l=i().compact([c,"(".concat(s,")")]).join(" ");return l+=" / ".concat(t),u&&a.AmoJoMediator.checkWithOriginalProfilePhoneShown(this._chat_id)&&(l+=" ".concat((0,o.phone)(u))),r&&c&&(l+=" / ".concat(c)),l}}])&&c(t.prototype,n),r&&c(t,r),f}(n(750097).ExternalChatTarget),d="../build/transpiled/interface/card/chat_entities/write_first_external_chat_target";window.define(d,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([d])},392744:(e,t,n)=>{function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}},i(e,t,n||e)}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=o(e);if(t){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}(this,n)}}n.r(t),n.d(t,{CardHeaderPipelinesSelect:()=>s});var s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(l,e);var t,n,s,u=c(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),u.apply(this,arguments)}return t=l,s=[{key:"controlClassName",get:function(){return"card-header-lead-pipeline-select"}}],(n=[{key:"noticeSide",get:function(){return"left"}},{key:"selectInnerClassName",get:function(){return".card-header-lead-pipeline-select__inner"}},{key:"initialize",value:function(e){i(o(l.prototype),"initialize",this).call(this,e)}}])&&r(t.prototype,n),s&&r(t,s),l}(n(350646).PipelineSelect);s.extend(s);var u="../build/transpiled/interface/card/controls/selects/card_header/card_header_pipeline_select";window.define(u,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([u])},298603:(e,t,n)=>{function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}},i(e,t,n||e)}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=o(e);if(t){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}(this,n)}}n.r(t),n.d(t,{CardHeaderStatusSelect:()=>s});var s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(l,e);var t,n,s,u=c(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),u.apply(this,arguments)}return t=l,s=[{key:"controlClassName",get:function(){return"card-header-lead-statuses-select"}}],(n=[{key:"noticeSide",get:function(){return"left"}},{key:"initialize",value:function(e){i(o(l.prototype),"initialize",this).call(this,e)}}])&&r(t.prototype,n),s&&r(t,s),l}(n(74657).StatusSelect);s.extend(s);var u="../build/transpiled/interface/card/controls/selects/card_header/card_header_status_select";window.define(u,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([u])},350646:(e,t,n)=>{n.r(t),n.d(t,{PipelineSelect:()=>p});var r=n(629133),i=n.n(r),o=n(630570),a=n(661533);function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t,n){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}},l(e,t,n||e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?c(e):t;var n}(this,n)}}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(p,e);var t,n,r,o=_(p);function p(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),u(c(e=o.apply(this,arguments)),"_onDocumentMouseover",(function(t){var n=a(t.target).parent(e._selector("item"));n.get(0)&&e.onItemMouseenter(n)})),e}return t=p,n=[{key:"selectInnerClassName",get:function(){return".form-top-card-pipeline-select__inner"}},{key:"_selectors",value:function(){return{item:".pipeline-select__dropdown__item",selectList:".pipeline-select__dropdown",currentSelectList:"".concat(this.selectInnerClassName," .pipeline-select__pipeline-input:checked + .pipeline-select .pipeline-select__dropdown")}}},{key:"initialize",value:function(e){var t,n;this.options=e||{},l(f(p.prototype),"initialize",this).call(this,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){u(e,t,n[t])}))}return e}({},this.options),n=null!=(n={dataType:"pipeline_select"})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t)),this._onPipelineSelectShow=i().bind(this._onPipelineSelectShow,this),this._onStatusSelectHide=i().bind(this._onStatusSelectHide,this),this._initListeners()}},{key:"_needNoticeShow",get:function(){return"leads"===APP.getBaseEntity()}},{key:"$selectList",get:function(){return a(this._selector("selectList"))}},{key:"$currentSelectList",get:function(){return a(this._selector("currentSelectList"))}},{key:"_initListeners",value:function(){this._needNoticeShow&&(this.$el.on("controls:pipeline-select:open",this._onPipelineSelectShow),this.$el.on("controls:pipeline-select:hide",this._onStatusSelectHide))}},{key:"_onPipelineSelectShow",value:function(){this._$document.on("mouseover",this._onDocumentMouseover),this.$selectList.on("mouseleave",this.onSelectMouseleave),this.onSelectShow()}},{key:"_onStatusSelectHide",value:function(){this._$document.off("mouseover",this._onDocumentMouseover),this.$selectList.off("mouseleave",this.onSelectMouseleave),this.onSelectHide()}}],r=[{key:"controlClassName",get:function(){return"form-top-card-pipeline-select"}}],n&&s(t.prototype,n),r&&s(t,r),p}(o.StatusDescriptionSelect);p.extend(p);var h="../build/transpiled/interface/card/controls/selects/pipeline_select";window.define(h,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([h])},74657:(e,t,n)=>{n.r(t),n.d(t,{StatusSelect:()=>_});var r=n(629133),i=n.n(r),o=n(630570),a=n(661533);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t,n){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}},u(e,t,n||e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}(this,n)}}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(_,e);var t,n,r,o=d(_);function _(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_),o.apply(this,arguments)}return t=_,n=[{key:"_selectors",value:function(){return{item:".control--select--list--item",selectList:"ul"}}},{key:"initialize",value:function(e){var t,n;this.options=e||{},u(l(_.prototype),"initialize",this).call(this,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){s(e,t,n[t])}))}return e}({},this.options),n=null!=(n={dataType:"statuses_select"})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t)),this._onStatusSelectShow=i().bind(this._onStatusSelectShow,this),this._onStatusSelectHide=i().bind(this._onStatusSelectHide,this),this._onStatusItemMouseenter=i().bind(this._onStatusItemMouseenter,this),this._initListeners()}},{key:"_needNoticeShow",get:function(){return"leads"===APP.getBaseEntity()}},{key:"$selectList",get:function(){return this._elem("selectList")}},{key:"$currentSelectList",get:function(){return this.$selectList}},{key:"_initListeners",value:function(){this._needNoticeShow&&(this.$selectList.on("controls:select:open",this._onStatusSelectShow),this.$selectList.on("controls:select:hide",this._onStatusSelectHide))}},{key:"_onStatusSelectShow",value:function(){this._elem("item").on("mouseenter",this._onStatusItemMouseenter),this.$selectList.on("mouseleave",this.onSelectMouseleave),this.onSelectShow()}},{key:"_onStatusSelectHide",value:function(){this._elem("item").off("mouseenter",this._onStatusItemMouseenter),this.$selectList.off("mouseleave",this.onSelectMouseleave),this.onSelectHide()}},{key:"_onStatusItemMouseenter",value:function(e){this.onItemMouseenter(a(e.currentTarget))}},{key:"destroy",value:function(){this.$selectList.off("controls:select:open",this._onStatusSelectShow),this.$selectList.off("controls:select:hide",this._onStatusSelectHide)}}],r=[{key:"controlClassName",get:function(){return"form-top-card-statuses-select"}}],n&&c(t.prototype,n),r&&c(t,r),_}(o.StatusDescriptionSelect);_.extend(_);var p="../build/transpiled/interface/card/controls/selects/status_select";window.define(p,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([p])},260904:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var r=n(629133),i=n.n(r),o=n(313981),a=n(445368),c=n(845043);function s(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}function u(e,t){return e.find('.linked-form__field[data-id="'.concat(t,'"]'))}function l(e,t,n){i().each(t,(function(t){u(e,t).toggleClass("u-hidden-cf",!n).find("tester").prev("input").trigger("autosize:important")}))}const f=o.default.extend({initialize:function(e){var t=e.element_type,n=void 0===t?-1:t,r=e.status_id,a=void 0===r?0:r,c=e.pipeline_id,s=void 0===c?0:c,u=e.rules,l=void 0===u?{}:u,f=e.onConflictResolutionHandled;o.default.prototype.initialize.apply(this,arguments),this.element_type=n,this.rules=l,this.onConflictResolutionHandled=i().isFunction(f)?f:function(){return Promise.resolve()},this.setStatusData(s,a)},process:function(e,t,n){return(r=function(){var r,o,a,c,s,f,d,_;return function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}(this,(function(p){switch(p.label){case 0:return r=this,o=(n||{}).force,this.element_type!==APP.element_types.leads||this.current_pipeline_id===e&&this.current_status_id===t&&!o?[2]:(a=this.getPossiblyHiddenFields(this.current_pipeline_id,this.current_status_id),c=this.getPossiblyHiddenFields(e,t),s=i().map(c,(function(e){return function(e,t){return u(e,t).find(":input:not(.js-form-changes-skip)").attr("name")}(r.$el,e)})),f=!o&&Boolean(i().find(s,(function(e){return r.model.hasChanges(e)}),this)),d=!0,f?[4,this.showEditingDiscardConfirmation()]:[3,3]);case 1:return _=p.sent(),[4,this.onConflictResolutionHandled(_,s)];case 2:d=p.sent(),p.label=3;case 3:return d&&(this.setStatusData(e,t),l(this.$el,a,!0),l(this.$el,c,!1)),[2]}}))},function(){var e=this,t=arguments;return new Promise((function(n,i){var o=r.apply(e,t);function a(e){s(o,n,i,a,c,"next",e)}function c(e){s(o,n,i,a,c,"throw",e)}a(void 0)}))}).apply(this);var r},showEditingDiscardConfirmation:function(){return new Promise((function(e){new c.default({decline_text:(0,a.i18n)("Discard changes"),accept_text:(0,a.i18n)("Save"),text:(0,a.i18n)("Some fields, which will be hidden for the selected stage, contain changes. Save them before changing stage?"),destroy:function(){e(this.accepted)}})}))},getPossiblyHiddenFields:function(e,t){return i().propertyOf(this.rules)([e,t])||[]},setStatusData:function(e,t){this.current_pipeline_id=e,this.current_status_id=t}})},782361:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var r=n(629133),i=n.n(r),o=n(128508),a=n(162262),c=n.n(a),s=n(797078),u=n(955026),l=n(926168),f=n(214558),d=n(577486),_=n(756542),p=n(418860),h=n(144185),y=n(729115),g=n(661533),m=APP.constant("account"),b={};b.Model=y.default.Model.extend({initialize:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.resetChangedFields(),y.default.Model.prototype.initialize.apply(this,t)},getCFId:function(e){var t=/^CFV\[(\d+)\]/.exec(e);return t?parseFloat(t[1]):-1},getCFTypeById:function(e){var t=i().find(APP.constant("account").cf,(function(t){if(parseFloat(t.ID)===e)return!0}));return t?t.TYPE_ID:-1},getCFKeysById:function(e){var t=this;return i().filter(i().keys(this.defaults),(function(n){if(t.getCFId(n)===e)return!0}))},fillChangedFieldsByKey:function(e){var t=this.getCFId(e),n=this.getCFKeysById(t),r=this.getCFTypeById(t);switch(!0){case r===APP.cf_types.legal_entity:case r===APP.cf_types.smart_address:return n.length<1?[e]:n;case r===APP.cf_types.chained_list:return n;default:return[e]}},addChangedField:function(e){e&&i().isString(e)&&(i().contains(this.changed_fields,e)||this.changed_fields.push(e))},resetChangedFields:function(){this.changed_fields=[]},updateDefaults:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.default.Model.prototype.updateDefaults.apply(this,t),this.resetChangedFields()},set:function(e,t,n){var r={};"object"==typeof e?(r=e,n=t):r[e]=t,n&&n.update_default&&i().each(r,(function(e,t){this.clearAndAddDefault(t,e)}),this),y.default.Model.prototype.set.apply(this,arguments)},isDefault:function(e){return this.get(e)===this.defaults[e]},clearAndAddDefault:function(e,t){this.setDefault(e,t),delete this.changed[e]},setDefault:function(e,t){this.defaults[e]=t},setElementType:function(e){this.element_type=Number(e)},toJSON:function(e){var t=y.default.Model.prototype.toJSON.apply(this,arguments),n=this,r=[],o=[];return(e=e||{}).only_changed&&(this.element_type===APP.element_types.leads&&(o=["lead[STATUS]","lead[PIPELINE_ID]"]),r=i().reduce(this.changed_fields.concat(o),(function(e,t){return i().contains(e,t)?e:e.concat(n.fillChangedFieldsByKey(t))}),[]),t=i().pick(t,r)),_.default._correctNameInputs(t)}}),b.View=y.default.View.extend({destroy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._manageAUSubscription("unsubscribe"),this._auto_update_ws_state&&this._auto_update_ws_state.unsubscribe(),y.default.View.prototype.destroy.apply(this,t)},initialize:function(e){y.default.View.prototype.initialize.call(this,e),c().mixin(this,_.default),this.entity=(0,l.convertElementType)(e.entity.type,"single"),this.card_id=e.entity.id,this._auto_update_ws_state=s.default.status.subscribe(i().bind((function(e){e.state===WebSocket.OPEN&&this._manageAUSubscription("subscribe")}),this)),i().isFunction(this.model.setElementType)&&this.model.setElementType(e.entity.type)},setInputValue:function(e,t,n){var r=this._patchContactNameRevert(e,t,n,["contact[N]","contact[FN]","contact[LN]"]);y.default.View.prototype.setInputValue.apply(this,r.length?r:arguments),"customer"===this.entity&&"customers[next_date]"===n&&this.$el.find("#task_edit_date").trigger("input")},_manageAUSubscription:function(e){var t=[this.entity,"card",this.card_id].join(":");s.default.send([{method:e,params:{channel:t}}]),"subscribe"===e?this._auto_update=s.default.subscribe(t).pipe(o.filter((function(e){return(0,u.hasKeys)(e,["body","payload","data","params"])&&e.body.channel===t})),o.map((function(e){return e.body.payload}))).subscribe(i().bind(this._handleAUMessage,this),i().bind(this._manageAUSubscription,this,"subscribe")):this._auto_update&&this._auto_update.unsubscribe()},_handleAUMessage:function(e){var t,n;if(22!==e.type)if(94!==e.type)if(95!==e.type){var r=i().clone(e.data.params);if(r.element_type=e.element_type,!(0,u.hasKeys)(e,["object_type","code"])||"systemnotes"!==e.object_type.code||14!==e.type||i().isNull(r.new)||i().isUndefined(r.new)){if(!i().isUndefined(r.new_value)&&!i().isUndefined(r.field_id)){if(t="CFV[".concat(r.field_id,"]"),n=this.$el.find('[name="'.concat(t,'"]')),!this.model.isDefault(t))return void this.model.setDefault(t,r.new_value);switch(r.field_type){case p.default.NAME_CHANGED_EVENT:this.changeNameEntity(r);break;case p.default.PRICE_CHANGED_EVENT:case p.default.LTV_CHANGED_EVENT:this._changePrice(r,e.created_by);break;case APP.cf_types.monetary:this.changePrice(t,r,e.created_by);break;case APP.cf_types.numeric:this.changeNumericField(t,r,n);break;case APP.cf_types.text:case APP.cf_types.url:case APP.cf_types.textarea:case APP.cf_types.streetaddress:this.changeStringFields(t,r,n);break;case APP.cf_types.multiselect:return;case APP.cf_types.multitext:this.changeMultiTextFields(t,r,this.$el.find(".js-linked-pei").filter((function(e,n){var r=t.replace("[","\\[").replace("]","\\]");return new d.UnsafeRegExp("".concat(r,".*")).test(n.name)})));break;case APP.cf_types.file:this.changeFile(t,r,n);break;case APP.cf_types.checkbox:this.changeCheckbox(t,r,n);break;case APP.cf_types.select:this.changeSelect(t,r,n);break;case APP.cf_types.radiobutton:this.changeRadiobutton(t,r);break;case APP.cf_types.smart_address:this.changeAddress(t,r);break;case APP.cf_types.chained_list:this.changeChainedList(t,r);break;case APP.cf_types.date:case APP.cf_types.birthday:case APP.cf_types.date_time:this.changeDateFields(t,r,n)}}}else this.changeResponsibleUser(r)}else this._handleSegmentsDetachedMessage(e);else this._handleSegmentsAttachedMessage(e);else this._handleCustomerCreatedMessage(e)},_handleCustomerCreatedMessage:function(e){if(this.model.element_type===APP.element_types.leads){var t=i().propertyOf(e)(["data","params","customer_id"]);t&&this.model.trigger("on:customer-created",{customer_id:t})}},_handleSegmentsAttachedMessage:function(e){var t=i().propertyOf(e)(["data","params","segments"])||[];i().isEmpty(t)||this.model.trigger("on:segments-attached",{segments:t})},_handleSegmentsDetachedMessage:function(e){var t=i().propertyOf(e)(["data","params","segments"])||[];i().isEmpty(t)||this.model.trigger("on:segments-detached",{segments:t})},changeInModel:function(e){var t=g(e.currentTarget),n=t.attr("name");t.attr("disabled")||(y.default.View.prototype.changeInModel.apply(this,arguments),!this.model.isDefault(n)&&this.checkChanges()&&i().isFunction(this.model.addChangedField)&&this.model.addChangedField(n))},revert:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.default.View.prototype.revert.apply(this,t),i().isFunction(this.model.resetChangedFields)&&this.model.resetChangedFields()},changeResponsibleUser:function(e){var t="lead[MAIN_USER]",n=(0,f.get)(e.new),r=0===e.old;this.model.isDefault(t)?this.model.set(t,n.id,{update_default:!0,is_first_assignment_via_socket:r}):this.model.setDefault(t,n.id)},changeNumericField:function(e,t,n){var r=n.closest(".linked-form__field__value");n.val(t.new_value),r.data("computed",r.hasClass("linked-form__field__value_computed")).toggleClass("linked-form__field__value_computed",!0===i().propertyOf(t)(["flags","computed"])),this.model.set(e,t.new_value,{update_default:!0})},_changePrice:function(e,t){var n="ltv";"lead"===this.entity?n="lead[PRICE]":APP.constant("periodicity_enabled")&&(n="next_price"),this.changePrice(n,e,t)},changePrice:function(e,t,n){var r=this.$('[name="'.concat(e,'"]'));if(this.model.isDefault(e)){var i=r.closest(".linked-form__field__value");i.data("computed",i.hasClass("linked-form__field__value_computed")).toggleClass("linked-form__field__value_computed",0===n),r.val(t.new_value),this.model.set(e,t.new_value,{update_default:!0}),r.trigger("controls:change")}else this.model.setDefault(e,t.new_value)},changeMultiselect:function(e,t){var n;i().each([t.old_enum_id,t.new_enum_id],i().bind((function(r){(n=this.$el.find('[name="'.concat(e,"[").concat(r,']"]'))).length&&(n.prop("checked",r===t.new_enum_id),n.trigger("change")),this.model.set(e,t.new_value,{update_default:!0})}),this))},changeSelect:function(e,t,n){t.new_enum_id=t.new_enum_id?t.new_enum_id.toString():"",n.val(t.new_enum_id),this.model.set(e,t.new_enum_id,{update_default:!0}),n.trigger("controls:change")},changeRadiobutton:function(e,t){var n=this.$el.find("#cf_".concat(t.field_id,"_").concat(t.new_enum_id,"_"));n.prop("checked",!0),this.model.set(e,t.new_enum_id.toString(),{update_default:!0}),n.trigger("change")},changeAddress:function(e,t){e+="[".concat(m.cf[t.field_id].sub_types[t.subtype_id],"][VALUE]");var n=this.$el.find('[name="'.concat(e,'"]'));this.model.isDefault(e)?(n.val(t.new_value),this.model.set(e,t.new_value,{update_default:!0}),n.trigger(6===t.subtype_id?"controls:change":"change")):this.model.setDefault(e,t.new_value)},changeChainedList:function(e,t){var n=String(i().propertyOf(t)(["metadata","new","element_id"])||"");e+="[".concat(t.subtype_id,"]");var r=this.$el.find('[name="'.concat(e,'"]'));r.length&&this.model.get(e)===n||(this.model.isDefault(e)?(r.val(n),this.model.set(e,n,{update_default:!0}),r.trigger("controls:change")):this.model.setDefault(e,n))},changeMultiTextFields:function(e,t,n){var r=(t.old_value||"").toString();n.length>1||n.val()!==r||(n.val(t.new_value),this.model.set(n.attr("name"),t.new_value,{update_default:!0}),n.trigger("change"))}}),c().mixin(b.View,h.default);const v=b;var w="../build/transpiled/interface/card/form";window.define(w,(function(){var e="undefined",n=typeof t===e?typeof __WEBPACK_AMD_DEFINE_RESULT__===e?typeof module===e?void 0:module.exports:__WEBPACK_AMD_DEFINE_RESULT__:t;return n&&n.default||n})),window.require([w])}}]);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"build_2025_11_28_17_08_33"},function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="cf559032-55c7-4503-8bbf-575d1ca8cdc9",e._sentryDebugIdIdentifier="sentry-dbid-cf559032-55c7-4503-8bbf-575d1ca8cdc9")}catch(e){}}();
//# sourceMappingURL=88320.e785efbc7a502ad0cda5.js.map