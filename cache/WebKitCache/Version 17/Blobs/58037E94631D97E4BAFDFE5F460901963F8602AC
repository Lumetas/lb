"use strict";(window.webpackChunk=window.webpackChunk||[]).push([[53256],{967482:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=n.p+"images/1098a699e820ce1c902274ea3790bc79.svg"},730185:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={modal:"a3eeef05a"}},990205:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={wrapper:"a0afb7da0",title:"a64cafaa5",text:"a34ccaf40"}},494036:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={wrapper:"eda42ad0",title:"a5424459d",text:"a9fbbb570"}},73587:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={wrapper:"a0daa7b26",icon:"a2b7706c6",title:"a4407a1ab"}},650040:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={wrapper:"a6b57884e",title:"a7d7ff31e",tip:"a31d1ea3e","tip-icon-wrapper":"a9f48aaaa","tip-icon":"fb461036"}},862040:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={body:"a78fa16bc",text:"a79022247","close-button":"a30f0a07e","close-icon":"a176d9cc8","trial-text":"a32f11c4","trial-modal":"a1e4806dc","trial-button":"cf60be3a",title:"b1782f04"}},336015:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={button:"a8b864092",loading:"d9e58d52",disable:"a3acb09fa",active:"a90eb90ea",preview:"a6c053be3"}},687083:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={answer:"a4b09b0c6",header:"a56745395",icon:"a05ad60fe",heading:"a78162dfa",main:"a05a9ce7e",text:"a05a34f96","customersus-text":"a0e647c0f",close:"b09fa820",buttons:"a57116f79","links-text":"f4f2a06e",resources:"a618f501d",links:"afa4c49e",link:"a05aa79fc"}},728822:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={button:"a920dad12",active:"a9772fd6a"}},604789:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={button:"a7c302fd7",preview:"a2f08207a",loading:"a0f83ed37",disable:"a5f112ee3",active:"a797d87ab"}},758918:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={control:"a013f64e3",header:"a398bda47",brand:"a1def16e6",active:"a2d8676c0",wrapper:"a27a18419",opened:"a461ac023",sticker:"a57dd08c3"}},275814:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={wrapper:"a5dfddfac",text:"a763d8e14",button:"a18c1668a"}},84290:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={select:"a6e70a78a",option:"a7ada0098","option-icon":"a62480ef2","option-revert":"a0009fbc6",icon:"a7cdc7778"}},248813:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={wrapper:"a6bc3f67c",title:"a63d3fa81",text:"a0a137838","mb-16":"a636d1586"}},450518:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={wrapper:"a0b67df12",title:"b935ded2",text:"a2701d9e4",input:"ba6773ee",options:"a61d4e11d"}},881323:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={wrapper:"a1f1ab15c",title:"a595bed61",text:"a4d347504",input:"a58c322d3"}},945948:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={modal:"a3a0ce3c9"}},294238:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={button:"a749a562a",icon:"a34d7f71c",close:"a66c7d5c2"}},659918:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={closeButton:"a65985964",content:"a0675127d",button:"a59ae78ae",wrapper:"a2cd76297",title:"a7779b15c",textAreaWrapper:"a875c1c46",textAreaWrapperError:"a0b5d922b",counter:"a06d53400",text:"a1ca0c5a9"}},989715:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={textAreaWrapper:"a9e21b06",textAreaWrapperError:"a487014ea",counter:"a0c6cd4a0",text:"a64042dee"}},642455:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r={overlay:"a0f22b43f"}},555424:(e,t,n)=>{n.r(t),n.d(t,{getTaskRequest:()=>d});var r=n(717068),a=n(445368),o=n(604874),i=n(292562);function u(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){u(o,r,a,i,s,"next",e)}function s(e){u(o,r,a,i,s,"throw",e)}i(void 0)}))}}function l(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var c,f=(c=s((function(e){var t,n,r,u,s,c,f,d,p,m,E,v,y,h,b,A,S,g,w;return l(this,(function(l){switch(l.label){case 0:t=e.jobUuid,n=e.maxRequestCount,r=e.url,u=e.resolve,s=e.reject,c=e.requestCount,f=e.incrementRequestCount,d=e.clearRequestCount,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,(0,o.get)({url:"".concat(r,"/").concat(t)})];case 2:switch(p=l.sent(),m=p.status,E=p.taskId,v=void 0===E?null:E,y=p.taskText,h=void 0===y?"":y,b=p.taskDeadline,A=void 0===b?null:b,S=p.taskType,m){case i.RewriteStatusRequest.ERROR:d(),s({detail:(0,a.i18n)("Something went wrong")});break;case i.RewriteStatusRequest.PENDING:c+1===n?(d(),s({detail:(0,a.i18n)("Something went wrong"),code:i.RewriterErrorCodes.NOT_FOUND})):f();break;case i.RewriteStatusRequest.LOADING:case i.RewriteStatusRequest.SUCCESS:A&&d()}return u({taskId:v,taskDeadline:A,status:m,taskText:h,taskType:S}),[3,4];case 3:return g=l.sent(),w=g.detail?g:{detail:(0,a.i18n)("Something went wrong"),code:i.RewriterErrorCodes.NOT_FOUND},d(),s(w),[3,4];case 4:return[2]}}))})),function(e){return c.apply(this,arguments)}),d=function(){var e=s((function(e){var t,n,a,o,i,u,s,c,d,p;return l(this,(function(l){return t=e.jobUuid,n=e.maxRequestCount,a=e.url,o=e.requestCount,i=e.incrementRequestCount,u=e.clearRequestCount,s=new r.SplitPromise,c=s.promise,d=s.resolve,p=s.reject,f({jobUuid:t,resolve:d,reject:p,maxRequestCount:n,url:a,requestCount:o,incrementRequestCount:i,clearRequestCount:u}),[2,c]}))}));return function(t){return e.apply(this,arguments)}}()},58256:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var r=n(717068),a=n(445368),o=n(292562),i=n(604874);function u(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){u(o,r,a,i,s,"next",e)}function s(e){u(o,r,a,i,s,"throw",e)}i(void 0)}))}}function l(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var c,f=(c=s((function(e){var t,n,r,u,s,c,f,d,p,m,E,v,y,h,b,A,S,g,w;return l(this,(function(l){switch(l.label){case 0:t=e.messageId,n=e.talkId,r=e.elementId,u=e.elementType,s=e.resolve,c=e.reject,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,(0,i.post)({url:i.TASK_URL,data:{talkId:n,lastMessageId:t,entityId:r,entityType:u}})];case 2:return f=l.sent(),d=f.status,p=f.taskId,m=void 0===p?null:p,E=f.taskText,v=void 0===E?"":E,y=f.jobUuid,h=void 0===y?"":y,b=f.taskDeadline,A=void 0===b?null:b,S=f.taskType,v||d===o.RewriteStatusRequest.PENDING||d===o.RewriteStatusRequest.LOADING?(s({taskId:m,taskText:v,status:d,taskDeadline:A,jobUuid:h,taskType:S}),[2]):(!v&&h||c({taskText:v}),[3,4]);case 3:return g=l.sent(),w=g.detail?g:{detail:(0,a.i18n)("Something went wrong. Please Try again."),code:o.RewriterErrorCodes.NOT_FOUND},c(w),[3,4];case 4:return[2]}}))})),function(e){return c.apply(this,arguments)}),d=function(){var e=s((function(e){var t,n,a,o,i,u,s,c;return l(this,(function(l){return t=e.messageId,n=e.talkId,a=e.elementId,o=e.elementType,i=new r.SplitPromise,u=i.promise,s=i.resolve,c=i.reject,f({talkId:n,messageId:t,elementId:a,elementType:o,resolve:s,reject:c}),[2,u]}))}));return function(t){return e.apply(this,arguments)}}();const p=d},872828:(e,t,n)=>{var r,a;n.r(t),n.d(t,{AiAgentActivationSteps:()=>r,UserChoice:()=>a}),function(e){e.OFFER="offer",e.CONFIRM="confirm",e.SUCCESS="success"}(r||(r={})),function(e){e.TURN_ON_FIRST_MODAL="turn_on_first_modal",e.TURN_ON_SECOND_MODAL="turn_on_second_modal",e.NOT_INTERESTED="not_interested",e.CLOSE_FIRST_MODAL="close_first_modal",e.CLOSE_SECOND_MODAL="close_second_modal",e.REQUEST_TURN_ON="request_turn_on",e.REQUEST_NOT_INTERESTED="request_not_interested",e.REQUEST_CLOSE_MODAL="request_close_modal"}(a||(a={}))},201029:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var r=n(827378),a=n.n(r),o=n(292554),i=n.n(o),u=n(859200),s=n(960190),l=n(438089),c=n(417438),f=n(246541),d=n(129624),p=n(872828),m=n(825650),E=n(730185),v=i().bind(E.default);const y=function(e){var t=e.onCloseRequest,n=e.onSuccess,o=(0,d.default)().getSurveyData,i=(0,c.useInvalidateSurveyRequest)().invalidateSurveyRequest,E=p.AiAgentActivationSteps.OFFER,y=function(e){n(o(e)),i()},h=function(){t()},b=function(e){E=e},A=function(){var e;E!==p.AiAgentActivationSteps.SUCCESS&&(e=(0,u.isAdmin)()?E===p.AiAgentActivationSteps.OFFER?p.UserChoice.CLOSE_FIRST_MODAL:p.UserChoice.CLOSE_SECOND_MODAL:p.UserChoice.REQUEST_CLOSE_MODAL,y({userChoice:e}))},S=(0,l.default)((function(){return a().createElement(f.GlobalUnifiedModal,{onClose:h,size:"s",customPosition:{right:"40px",bottom:"40px"},isPopup:!0,isCloseButtonVisible:!0,onCloseButtonClick:A,slideDirection:"right",className:v("modal"),hideDistance:600},a().createElement(m.default,{onStepChange:b,onSuccess:y}))})),g=S.modalElement,w=S.showModal;return(0,r.useEffect)((function(){w(),(0,s.sendAgentSurveyIsSeenMetric)()}),[]),g}},809764:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var r=n(292554),a=n.n(r),o=n(916569),i=n(529062),u=n(701106),s=n(445368),l=n(464702),c=n(417438),f=n(872828),d=n(990205),p=n(827378),m=a().bind(d.default),E=(0,l.getCDNPath)("/frontend/images/interface/ai/"),v=APP.lang_id.toUpperCase(),y={"1x":"".concat(E,"ai_agent_activation_popup_").concat(v,".png"),"2x":"".concat(E,"ai_agent_activation_popup_").concat(v,"@2x.png")};const h=function(e){var t=e.onCloseRequest,n=e.onSuccess;return p.createElement(c.BaseStep,{images:y},p.createElement("div",{className:m("wrapper")},p.createElement("div",null,p.createElement(u.default,{className:m("title"),type:"h2",size:"xxl"},(0,s.i18n)("If you change your mind...")),p.createElement(o.Text,{theme:o.TextPrimaryTheme,className:m("text"),size:"l"},(0,s.i18n)("You can activate the AI agent any time, take it for a test run, and customize its knowledge in the Kommo AI settings."))),p.createElement("div",null,p.createElement(i.Button,{theme:i.ButtonPrimaryTheme,onClick:function(){n({userChoice:f.UserChoice.NOT_INTERESTED}),t()}},(0,s.i18n)("Got it")),p.createElement(i.Button,{theme:i.ButtonSecondaryTheme,onClick:function(){n({userChoice:f.UserChoice.TURN_ON_SECOND_MODAL}),APP.router.navigate("/settings/ai-agent",{trigger:!0})}},(0,s.i18n)("Go to settings")))))}},227318:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var r=n(292554),a=n.n(r),o=n(916569),i=n(529062),u=n(701106),s=n(445368),l=n(464702),c=n(859200),f=n(960190),d=n(292562),p=n(613092),m=n(417438),E=n(872828),v=n(494036),y=n(827378),h=a().bind(v.default),b=(0,l.getCDNPath)("/frontend/images/interface/ai/"),A=APP.lang_id.toUpperCase(),S={"1x":"".concat(b,"ai_agent_activation_popup_").concat(A,".png"),"2x":"".concat(b,"ai_agent_activation_popup_").concat(A,"@2x.png")};const g=function(e){var t=e.onSuccess,n=e.onCloseRequest,r=(0,p.useSteps)().changeStep,a=(0,c.isAdmin)()?"Try now (CTA)":"Request admin to set up";return y.createElement(m.BaseStep,{images:S},y.createElement("div",{className:h("wrapper")},y.createElement("div",null,y.createElement(u.default,{className:h("title"),type:"h2",size:"xxl"},(0,s.i18n)("Meet your all-new AI agent")),y.createElement(o.Text,{theme:o.TextPrimaryTheme,className:h("text"),size:"l"},(0,s.i18n)("Now AI agent is fully customizable—set the tone, role, workflows, and rules to fit your business. Use ready-made templates or build one from scratch to make sales 24/7 and more effective than ever."))),y.createElement("div",null,y.createElement(i.Button,{theme:i.ButtonPrimaryTheme,onClick:function(){(0,c.isAdmin)()?(t({userChoice:E.UserChoice.TURN_ON_FIRST_MODAL}),APP.router.navigate("settings/ai-agent",{trigger:!0})):(t({userChoice:E.UserChoice.REQUEST_TURN_ON}),(0,f.requestAiTrial)(d.TrialUserRequest.AGENT_REQUESTED),r(E.AiAgentActivationSteps.SUCCESS))}},(0,s.i18n)(a)),y.createElement(i.Button,{theme:i.ButtonSecondaryTheme,onClick:function(){(0,c.isAdmin)()?r(E.AiAgentActivationSteps.CONFIRM):(t({userChoice:E.UserChoice.REQUEST_NOT_INTERESTED}),n())}},(0,s.i18n)("I'm not interested")))))}},711480:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var r=n(827378),a=n.n(r),o=n(292554),i=n.n(o),u=n(916569),s=n(701106),l=n(491967),c=n(445368),f=n(970948),d=n(73587),p=i().bind(d.default);const m=function(e){var t=e.onCloseRequest;return(0,r.useEffect)((function(){setTimeout((function(){t()}),3e3)}),[]),a().createElement(f.default,null,a().createElement("div",{className:p("wrapper")},a().createElement(l.default,{type:"svg",name:"settings--widgets--check",className:p("icon")}),a().createElement(s.default,{type:"h2",size:"xxl",className:p("title")},(0,c.i18n)("Success (AI)")),a().createElement(u.Text,{theme:u.TextPrimaryTheme,size:"l"},(0,c.i18n)("Request sent"))))}},598505:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var r=n(827378),a=n.n(r),o=n(613092),i=n(227318),u=n(711480),s=n(809764),l=n(872828);const c=function(e){var t=e.onClose,n=e.onStepChange,c=e.onSuccess,f=(0,o.useSteps)().activeStep;switch((0,r.useEffect)((function(){n(f)}),[f]),f){case l.AiAgentActivationSteps.OFFER:return a().createElement(i.default,{onSuccess:c,onCloseRequest:t});case l.AiAgentActivationSteps.CONFIRM:return a().createElement(s.default,{onSuccess:c,onCloseRequest:t});case l.AiAgentActivationSteps.SUCCESS:return a().createElement(u.default,{onCloseRequest:t})}}},825650:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var r=n(629133),a=n.n(r),o=n(598505),i=n(872828),u=n(613092),s=n(827378);const l=(0,u.withStepsProvider)((function(e){var t=e.onSuccess,n=e.onStepChange,r=e.onClose,i=void 0===r?a().noop:r;return s.createElement(o.default,{onSuccess:t,onStepChange:n,onClose:i})}),i.AiAgentActivationSteps.OFFER)},129624:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var r=n(161320),a=n.n(r),o=n(827378),i=n(417438);const u=function(){var e=(0,o.useRef)(a()());return{getSurveyData:function(t){var n=t.userChoice,r=a()().diff(e.current,"seconds");return{name:i.Surveys.AI_AGENT_ACTIVATION,data:{userChoice:n},metadata:{viewingTime:r,viewingUrl:window.location.pathname}}}}}},559261:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var r=n(827378),a=n(292554),o=n.n(a),i=n(916569),u=n(724329),s=n(491967),l=n(701106),c=n(445368),f=n(961790),d=n(650040),p=n(827378);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var y=o().bind(d.default);const h=function(e){var t,n,a=e.talkIds,o=v((0,r.useState)(!1),2),d=o[0],m=o[1],h=v((0,r.useState)(!1),2),b=h[0],A=h[1],S=(0,r.useRef)(null),g=(0,f.default)({talkIds:a,onSuccessAiAgentDisable:function(){m(!1),A(!1)},onSuccessIsAiAgentEnabled:function(){m(!0)}}),w=g.disableAiAgent,T=g.overlayElement,R=(t=function(){return function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}(this,(function(e){return w(),[2]}))},n=function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){E(o,r,a,i,u,"next",e)}function u(e){E(o,r,a,i,u,"throw",e)}i(void 0)}))},function(){return n.apply(this,arguments)});return(0,u.useOnOutsideClick)({ref:S,handler:function(){A(!1)}}),d?p.createElement("div",{ref:S,className:y("wrapper")},p.createElement(i.Text,{theme:i.TextSecondaryDarkTheme,size:"m",className:y("title"),onClick:function(){A(!b)}},(0,c.i18n)("AI_agent")),b&&p.createElement("div",{className:y("tip")},T,p.createElement(l.default,{type:"h2",size:"l"},(0,c.i18n)("AI_agent")),p.createElement("div",{onClick:R,className:y("tip-icon-wrapper")},p.createElement(s.default,{type:"svg",name:"salesbot--stop-bot-icon",className:y("tip-icon")})))):null}},961790:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var r=n(629133),a=n.n(r),o=n(724329),i=n(960190),u=n(393914);function s(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){s(o,r,a,i,u,"next",e)}function u(e){s(o,r,a,i,u,"throw",e)}i(void 0)}))}}function c(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var f="canceled";const d=function(e){var t,n=e.talkIds,r=e.onSuccessAiAgentDisable,s=e.onSuccessIsAiAgentEnabled,d=(0,u.default)(),p=d.showOverlay,m=d.hideOverlay,E=d.overlayElement,v=(t=l((function(){var e,t;return c(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,3,4]),p(),[4,(0,i.disableAiAgent)({talkIds:n})];case 1:return(e=o.sent()).Embedded?(a().every(e.Embedded.states,(function(e){return e.state.state===f}))&&r(),[3,4]):[2];case 2:return t=o.sent(),console.error(t),[3,4];case 3:return m(),[7];case 4:return[2]}}))})),function(){return t.apply(this,arguments)}),y=function(){var e=l((function(){var e,t,r;return c(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,(0,i.getIsAiAgentEnabled)({talkIds:n})];case 1:return e=o.sent(),t=e.Embedded.states,a().isEmpty(t)||!a().some(t,(function(e){return e.state.state!==f}))?[2]:(s(),[3,3]);case 2:return r=o.sent(),console.error(r),[3,3];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,o.useDeepCompareEffect)((function(){a().isEmpty(n)?r():y()}),[n]),{overlayElement:E,disableAiAgent:v}}},99854:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var r=n(292554),a=n.n(r),o=n(827378),i=n(629133),u=n.n(i),s=n(529062),l=n(916569),c=n(701106),f=n(926168),d=n(445368),p=n(225526),m=n(292562),E=n(635365),v=n(954480),y=n(304483),h=n(604733),b=n(862040),A=n(827378);function S(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}var g,w=a().bind(b.default),T=(0,f.isTrial)(),R=(0,f.isExpired)(),_=T||R,C=!0;const I=function(e){var t,n,r=e.onCloseRequest,a=void 0===r?u().noop:r,i=e.error,f=(0,E.useModalProvider)().ModalProvider,b=(0,v.useSupportChatMessage)(),T=b.sendMessageAndGoToSupportChat,R=b.isLoading,I=function(){a()},O=function(){C=!1,g=setTimeout((function(){C=!0}),1e4)},k=(t=function(){return function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}(this,(function(e){return _?(APP.router.navigate("/settings/pay/",{trigger:!0}),a(),[2]):(a(),(new y.default).showSuccess((0,d.i18n)("Feedback received!"),null,500),setTimeout((function(){return T((0,d.i18n)("Hi! I have reached the limit for AI requests. Could you please increase my limit?"),{isNeedToSendMessage:C,onSuccess:O})}),500),[2])}))},n=function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){S(o,r,a,i,u,"next",e)}function u(e){S(o,r,a,i,u,"throw",e)}i(void 0)}))},function(){return n.apply(this,arguments)});if((0,o.useEffect)((function(){return function(){clearTimeout(g)}}),[]),!i)return null;var N=i.code,x=void 0===N?"":N,P=i.detail,U=void 0===P?"":P,L=x===m.RewriterErrorCodes.PAYMENT_REQUIRED;return A.createElement(f,{onCloseRequest:I,bodyClassName:w("body"),bodyInnerClassName:w("wrapper")},L?_?A.createElement("div",{className:w("trial-modal")},A.createElement(c.default,{type:"h2",size:"xl",weight:"normal",className:w("title")},(0,d.i18n)("You’ve reached your AI limit for the Kommo trial.")),A.createElement(p.CloseModalButton,{onClick:I,className:w("close-button")}),A.createElement(l.Text,{size:"l",theme:l.TextPrimaryTheme,className:w("trial-text")},(0,d.i18n)("To continue using Kommo AI, please subscribe to a paid plan.")),A.createElement(s.Button,{theme:s.ButtonPrimaryTheme,onClick:k,className:w("trial-button")},(0,d.i18n)("Go to Billing"))):A.createElement(h.AiUsageSurvey,{onCloseRequest:I,onSubmit:k,isLoading:R}):A.createElement("div",{className:"modal-body__caption head_2 modal-body__caption-error"},U))}},912077:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var r=n(267651),a=n.n(r),o=n(827378),i=n(629133),u=n.n(i),s=n(770086),l=n(564638),c=n(500034),f=n(614759),d=n(436132),p=n(117464),m=n(174246),E=n(355582),v=n(30893),y=n(827378);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var g=[d.AiHelperType.TASK,d.AiHelperType.ANSWER],w=function(e){return u().indexOf(g,e)},T=(0,c.isFeatureAvailable)("ai_agent_viewable")||(0,c.isFeatureAvailable)("kommo_ai_trial_started")&&!(0,c.isFeatureAvailable)("kommo_ai_trial_ended"),R=(0,c.isFeatureAvailable)("is_ai_task_suggestion_enabled");const _=(0,f.withQueryProvider)((function(e){var t=e.getText,n=e.onLoad,r=e.setText,i=e.shouldAiAnswerShow,f=e.shouldAiTaskShow,h=e.messageId,g=void 0===h?"":h,_=e.talkId,C=e.text,I=e.answerType,O=void 0===I?d.AnswerType.DEFAULT:I,k=e.elementType,N=e.elementId,x=e.setHelperHeight,P=e.el,U=e.onAnswerReply,L=e.onHelperVisibilityChange,D=e.checkIsTaskExists,M=e.shouldCheckGrammar,F=S((0,o.useState)(g),2),H=F[0],G=F[1],q=S((0,o.useState)(_),2),B=q[0],j=q[1],W=S((0,o.useState)(i),2),Y=W[0],z=W[1],K=S((0,o.useState)(f),2),V=K[0],Q=K[1],$=S((0,o.useState)({isOpened:!1,text:""}),2),X=$[0],Z=$[1],J=(0,o.useRef)(!1),ee=(0,o.useRef)(!1),te=(0,o.useRef)(null),ne=(0,o.useRef)(null),re=(0,o.useRef)(null),ae=(0,o.useRef)(null),oe=function(e,t){var n=t.talkId,r=t.messageId;n!==_||ae.current||ee.current||(z(!0),!D()&&T&&R&&Q(!0),G(r),j(n))},ie=function(e,t){t.style.visibility=e?"hidden":"visible"},ue=function(){var e=P.getBoundingClientRect().width;if(ne.current){var t=ne.current,n=t.hiddenAnswerElRef,r=t.openedAnswerElRef,a=n.current?n.current:r.current;if(a&&te.current){var o=a.getBoundingClientRect().width,i=te.current.getBoundingClientRect().width;ie(e<o+i,te.current)}}},se=u().throttle((function(){ue()}),l.WINDOW_RESIZE_THROTTLE_DELAY);(0,o.useEffect)((function(){var e=a().subscribe(d.AI_ANSWER_MESSAGE_ADD,oe),t=a().subscribe(d.AI_HELPER_RESIZE,se);return window.addEventListener("resize",se),function(){a().unsubscribe(e),a().unsubscribe(t),window.removeEventListener("resize",se),x(d.NULL_HELPER_HEIGHT)}}),[]);var le,ce,fe=function(e){ee.current=e,J.current=e},de=(le=function(e){return function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}(this,(function(t){return ae.current=null,[2,new Promise((function(t){setTimeout((function(){L(!1),t(!0)}),d.SHOW_HIDE_ANIMATION_DURATION_MS),e===d.AiHelperType.ANSWER&&fe(!1)}))]}))},ce=function(){var e=this,t=arguments;return new Promise((function(n,r){var a=le.apply(e,t);function o(e){b(a,n,r,o,i,"next",e)}function i(e){b(a,n,r,o,i,"throw",e)}o(void 0)}))},function(e){return ce.apply(this,arguments)}),pe=function(e){var t=e.helperType,n=e.cb,r=e.isLoading,a=function(){ae.current=t,L(!0),n()};ae.current?w(t)>w(ae.current)&&!r&&(ae.current===d.AiHelperType.TASK&&re.current&&ie(!0,re.current),ae.current=null,a()):a()},me=function(e){var t=e.helperType,n=e.errorMessage;ae.current&&ae.current!==t||x(d.NULL_HELPER_HEIGHT),n&&Z({isOpened:!0,text:n})};return y.createElement(y.Fragment,null,y.createElement(s.default,{isOpened:X.isOpened,onCloseRequest:function(){return Z((function(e){return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){A(e,t,n[t])}))}return e}({},e),n=null!=(n={isOpened:!1})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t;var t,n})),!0},isTryAgainAvailable:!1},X.text),Y&&y.createElement(m.default,{elementId:N,elementType:k,type:(0,p.getUpdatedAnswerType)(O),onAnswerReply:U,onLoad:n,onShow:function(){ue(),fe(!0),ee.current=!1},onHide:de,onError:me,onProcess:function(e){ee.current=e},setText:r,getText:t,setHelperHeight:x,messageId:H,talkId:B,text:C,ref:ne,shouldSuggestionShow:!(0,c.isFeatureAvailable)("ai_answer"),onTryToShow:pe}),V&&y.createElement(v.default,{ref:re,messageId:H,talkId:B,onHide:de,elementId:N,elementType:k,setHelperHeight:x,onTryToShow:pe,onError:me}),y.createElement(E.default,{onAnswerReply:U,onLoad:n,onShow:function(){ue()},getText:t,setText:r,setHelperHeight:x,shouldCheckGrammar:M,ref:te}))}))},174246:(e,t,n)=>{n.r(t),n.d(t,{default:()=>B});var r=n(827378),a=n.n(r),o=n(629133),i=n.n(o),u=n(292554),s=n.n(u),l=n(267651),c=n.n(l),f=n(161320),d=n.n(f),p=n(672034),m=n(445368),E=n(859200),v=n(500034),y=n(960190),h=n(292562),b=n(321561),A=n(117464),S=n(195601),g=n(587776),w=n(436132),T=n(874559),R=n(805556),_=n(719929),C=n(336015);function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){O(o,r,a,i,u,"next",e)}function u(e){O(o,r,a,i,u,"throw",e)}i(void 0)}))}}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var P=s().bind(C.default),U={answer:"",answerId:null,usedReferences:[]},L=["isAiUserOnboardingCompleted","isAiAccountOnboardingCompleted"],D="startAnswerTimeMetric",M="showAnswerTimeMetric",F=(0,v.isFeatureAvailable)("ai_rewriter_fast_reply"),H=(0,v.isFeatureAvailable)("is_customization_for_global"),G=(0,E.isAdmin)(),q=(0,r.forwardRef)((function(e,t){var n=e.messageId,o=e.elementId,u=e.elementType,s=e.talkId,l=e.text,f=e.type,v=e.setHelperHeight,C=e.setText,I=e.getText,O=e.onShow,q=e.onHide,B=e.onProcess,j=e.shouldSuggestionShow,W=e.onTryToShow,Y=e.onError,z=N((0,r.useState)(!1),2),K=z[0],V=z[1],Q=N((0,r.useState)(!1),2),$=Q[0],X=Q[1],Z=N((0,r.useState)(!1),2),J=Z[0],ee=Z[1],te="",ne=(0,r.useRef)(U),re=(0,r.useRef)(U),ae=(0,r.useRef)([]),oe=(0,r.useRef)(null),ie=(0,r.useRef)(null),ue=(0,r.useRef)(!1),se=(0,r.useRef)({show:i().noop,hide:i().noop}),le=(0,r.useRef)(f),ce=function(){ne.current=U,re.current=U,ae.current=[],ue.current=!1};(0,r.useImperativeHandle)(t,(function(){return{openedAnswerElRef:oe,hiddenAnswerElRef:ie}}));var fe,de=function(){V(!1),v(w.BASE_HELPER_HEIGHT)},pe=function(){V(!0);var e=ne.current.answerId;e&&!ue.current&&(ue.current=!0,F||(0,y.markAnswer)({answerId:e,data:{status:h.AnswerUsingStatuses.OPEN_ANSWER}}))},me=(0,b.default)({acceptText:G?(0,m.i18n)("Go to settings (AI)"):(0,m.i18n)("Close"),declineText:(0,m.i18n)("Cancel"),title:(0,m.i18n)("Unable to find relevant source to respond"),description:[{text:G?(0,m.i18n)("We couldn't find a relevant source to respond to this message. Please add a new source or update the existing ones to proceed."):(0,m.i18n)("Please ask your admin to add a new source or update the existing ones.")}],onAccept:function(){G&&APP.router.navigate("/settings/ai-knowledge-sources/".concat(w.SHOW_SOURCES_MODAL_URL_HASH),{trigger:!0})},shouldPreventPageChange:!1,isNoCancel:!G}).openConfirmModal,Ee=(0,T.default)({type:le.current,onSuccess:function(e){var t=e.answer,n=e.answerId,r=e.usedReferences;ne.current={answer:t,answerId:n,usedReferences:r.slice(0,2)},W({helperType:w.AiHelperType.ANSWER,cb:se.current.show}),performance.measure(M,D);var a=d().duration(performance.getEntriesByName(M)[0].duration).asSeconds();(0,y.markAnswer)({answerId:n,data:{status:h.AnswerUsingStatuses.SHOW_ANSWER,showAnswerTime:a}}),(F||le.current===w.AnswerType.GENERATE||le.current===w.AnswerType.GENERATE_BY_HELPER)&&pe()},onError:(fe=k((function(e){var t,n,r;return x(this,(function(a){switch(a.label){case 0:if(t=e.answer_id,n=e.error_reason,ne.current={answer:"",answerId:t,usedReferences:[]},B(!1),r={helperType:w.AiHelperType.ANSWER},le.current===w.AnswerType.GENERATE){if(n===R.AnswerErrorReasons.EMPTY_ARTICLES)return me(),[2];r.errorMessage=(0,m.i18n)("Unable to generate your response. Please try again.")}return[4,se.current.hide()];case 1:return a.sent(),Y(r),[2]}}))})),function(e){return fe.apply(this,arguments)}),onMutate:function(){B(!0)}}),ve=Ee.postAnswer,ye=Ee.toggleRefetching,he=Ee.isLoading,be=function(){X(!0),v(w.BASE_HELPER_HEIGHT),O()},Ae=function(){var e=k((function(){return x(this,(function(e){switch(e.label){case 0:return X(!1),V(!1),v(w.BASE_HELPER_HEIGHT),ye(!1),$?[4,q(w.AiHelperType.ANSWER)]:[3,2];case 1:e.sent(),le.current===w.AnswerType.GENERATE&&(le.current=(0,A.getUpdatedAnswerType)(w.AnswerType.DEFAULT)),e.label=2;case 2:return[2]}}))}));return function(){return e.apply(this,arguments)}}();se.current={show:be,hide:Ae};var Se=function(e,t){if(t){var n=t.event,r=t.talkId;switch(n){case R.AiAnswerCloseEvents.CLOSE:case R.AiAnswerCloseEvents.READ:r!==s||F||Ae();break;case R.AiAnswerCloseEvents.SOCKET_EXTERNAL:break;default:Ae()}}},ge=function(){var e,t=I(),n=ne.current.answerId,r=re.current,a=r.answer,o=r.answerId;switch(!0){case a&&t===a:e={status:h.AnswerUsingStatuses.SEND_ANSWER};break;case a&&t!==a:e={status:h.AnswerUsingStatuses.EDIT_ANSWER,userText:t};break;case Boolean(n):e={status:h.AnswerUsingStatuses.SKIP_ANSWER,userText:t}}var i=o||n;ae.current.length&&(e.checkedReferences=ae.current),e&&i&&((0,y.markAnswer)({answerId:i,data:e}),a&&ce())};(0,r.useEffect)((function(){var e=c().subscribe(w.FEED_COMPOSE_SUBMIT,ge),t=c().subscribe(w.AI_ANSWER_CLOSE,Se);return function(){c().unsubscribe(t),c().unsubscribe(e),performance.clearMeasures(M),performance.clearMarks(D)}}),[]);var we=function(){var e=k((function(){var e,t,n,r;return x(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,(0,p.getFeaturesByQuery)({queries:L,shouldCamelCase:!0})];case 1:return e=a.sent().features,t=e.isAiUserOnboardingCompleted,n=e.isAiAccountOnboardingCompleted,t||n||!(0,E.isAdmin)()||(ee(!0),W({helperType:w.AiHelperType.ANSWER,cb:be})),[3,3];case 2:return r=a.sent(),console.error(r),[3,3];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}();(0,r.useEffect)((function(){if(le.current===w.AnswerType.DEFAULT)switch(!0){case H&&j:we();break;case!H&&j:break;default:performance.mark(D),ve({lastMessageId:n,talkId:s,entityId:o,entityType:u})}le.current!==w.AnswerType.GENERATE_BY_HELPER||ne.current.answer||W({helperType:w.AiHelperType.ANSWER,cb:be})}),[n]),(0,r.useEffect)((function(){f===w.AnswerType.GENERATE&&l&&(performance.mark(D),ve({text:l,talkId:s,entityId:o,entityType:u})),f===w.AnswerType.GENERATE_BY_HELPER&&(performance.mark(D),W({helperType:w.AiHelperType.ANSWER,cb:be}))}),[f]),(0,r.useEffect)((function(){K&&oe.current&&v("".concat(w.MAX_OPENED_ANSWER_HEIGHT+w.BASE_BOTTOM_HELPERS_OFFSET,"px"))}),[K]);var Te=function(){var e=k((function(e){return x(this,(function(t){switch(t.label){case 0:return C({text:e,isAnswer:!0}),re.current=ne.current,ne.current=U,[4,Ae()];case 1:return t.sent(),ae.current=[],ue.current=!1,[2]}}))}));return function(t){return e.apply(this,arguments)}}(),Re=function(){var e=k((function(){var e;return x(this,(function(t){switch(t.label){case 0:return J&&(0,y.setAnswerOnboarding)(),(e=ne.current.answerId)&&(0,y.markAnswer)({answerId:e,data:{status:h.AnswerUsingStatuses.CLOSE_ANSWER}}),[4,Ae()];case 1:return t.sent(),ce(),[2]}}))}));return function(){return e.apply(this,arguments)}}();switch((0,r.useEffect)((function(){he?W({helperType:w.AiHelperType.ANSWER,cb:be,isLoading:he}):ne.current.answer||le.current===w.AnswerType.GENERATE_BY_HELPER||Ae()}),[he]),!0){case j&&H:te=(0,m.i18n)("Reply faster by training the AI assistant using data from your information sources");break;case he&&!ne.current.answer:te=a().createElement(S.default,null);break;case le.current===w.AnswerType.GENERATE_BY_HELPER&&!ne.current.answer:te=(0,m.i18n)("Generate response");break;default:te=ne.current.answer}return K?a().createElement(_.default,{isOpen:K,answerRef:ne,ref:oe,onLinkMouseDown:function(e){if(!i().contains(ae.current,e)){var t=ne.current.answerId;ae.current.push(e),(0,y.markAnswer)({answerId:t,data:{status:h.AnswerUsingStatuses.SHOW_ANSWER,checkedReferences:ae.current}})}},onApplyClick:Te,onCloseClick:function(e){e.stopPropagation(),de()},onOutsideClick:function(){F||de()}}):a().createElement(g.default,{ref:ie,className:P("button",{active:$,disable:he}),onClick:function(e){if(e.stopPropagation(),le.current===w.AnswerType.GENERATE_BY_HELPER)ve({lastMessageId:n,talkId:s,entityId:o,entityType:u});else{if(J)return(0,y.setAnswerOnboarding)(),APP.router.navigate("/settings/ai/",{trigger:!0}),void Ae();pe()}},isClosable:!0,onCloseClick:Re},a().createElement("div",{className:P("preview",{loading:he})},te))}));q.displayName="AiAnswer";const B=q},719929:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var r=n(827378),a=n.n(r),o=n(629133),i=n.n(o),u=n(292554),s=n.n(u),l=n(916569),c=n(352467),f=n(529062),d=n(724329),p=n(500034),m=n(445368),E=n(436132),v=n(706898),y=n(740098),h=n(687083),b=(0,p.isFeatureAvailable)("ai_rewriter_fast_reply"),A=s().bind(h.default),S=(0,r.forwardRef)((function(e,t){var n=e.isOpen,o=e.answerRef,u=e.onApplyClick,s=e.onLinkMouseDown,p=e.onCloseClick,h=e.onOutsideClick,S=(0,r.useRef)(null),g=(0,r.useRef)([]),w=(0,r.useRef)(null),T=(0,r.useRef)(null);return(0,r.useLayoutEffect)((function(){if(n&&g.current.length>1){var e,t=null===(e=S.current)||void 0===e?void 0:e.offsetWidth,r=g.current[0];t&&r&&r.offsetWidth>t/2&&(r.style.maxWidth="50%")}}),[n]),(0,r.useLayoutEffect)((function(){if(n){var e=w.current,t=T.current;e&&t&&(e.style.width="calc(100% - ".concat(t.offsetWidth+24,"px)"))}}),[n]),(0,r.useLayoutEffect)((function(){var e=t.current;if(n&&e&&w.current){var r=w.current,a=new ResizeObserver((function(e){e.forEach((function(e){r.style.display=e.contentRect.width<350?"none":"flex"}))}));return a.observe(e),function(){e&&a.unobserve(e)}}}),[n]),(0,d.useOnOutsideClick)({ref:t,handler:h}),a().createElement("div",{className:A("answer"),ref:t,onClick:function(e){var t,n=e.target;n===T.current||(null===(t=T.current)||void 0===t?void 0:t.contains(n))||e.stopPropagation()}},a().createElement("div",{className:A("header")},a().createElement(v.default,{className:A("icon")}),a().createElement("p",{className:A("heading")},(0,m.i18n)("Suggested reply"))),a().createElement("div",{className:A("main")},a().createElement("div",{className:A("text",{"customersus-text":b})},a().createElement("div",{dangerouslySetInnerHTML:{__html:o.current.answer.replace(/\n/g,"<br />")}})),a().createElement("div",{className:A("buttons")},a().createElement(f.Button,{theme:f.ButtonNeutralTheme,onClick:function(){var e=o.current.answer;PubSub.publish(E.AI_COMPOSE_ANSWER_PASTED,e),u(e)},ref:T},(0,m.i18n)("Add as a draft")),o.current.usedReferences.length>0&&a().createElement("div",{className:A("resources"),ref:w},a().createElement(l.Text,{theme:l.TextSecondaryLightTheme,className:A("links-text"),size:"m"},(0,m.i18n)("Based on:")," "),a().createElement("div",{className:A("links"),ref:S},i().map(o.current.usedReferences,(function(e,t){return a().createElement(r.Fragment,{key:t},a().createElement(c.Link,{theme:c.LinkPrimaryTheme,className:A("link"),href:e,target:"_blank",rel:"noreferrer",onMouseDown:function(){s(e)},ref:function(e){g.current[t]=e},title:e},e),o.current.usedReferences.length>1&&t<o.current.usedReferences.length-1&&a().createElement(a().Fragment,null,", "))})))))),a().createElement("div",{onClick:p,className:A("close")},a().createElement(y.default,null)))}));S.displayName="Content";const g=S},874559:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var r=n(456552),a=n(827378),o=n(292562),i=n(960190),u=n(604874),s=n(746716),l=n(942407),c=n(436132);function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const p=function(e){var t=e.type,n=void 0===t?c.AnswerType.DEFAULT:t,f=e.onSuccess,p=e.onError,m=e.onMutate,E=d((0,a.useState)(null),2),v=E[0],y=E[1],h=d((0,a.useState)(!1),2),b=h[0],A=h[1],S=d((0,a.useState)(!1),2),g=S[0],w=S[1],T=(0,l.default)(),R=T.requestCount,_=T.incrementRequestCount,C=T.clearRequestCount,I=function(e){var t=e.detail,n=e.code;p(e),y({detail:t,code:n})},O=function(e){f(e),y(null),w(!1)},k=(0,r.useMutation)({mutationFn:function(e){switch(m(),n){case c.AnswerType.GENERATE:return(0,s.postGenerateAnswerRequest)(e);case c.AnswerType.DEFAULT:default:return(0,i.postAnswerRequest)(e)}},onSuccess:function(e){var t=e.answer,r=e.status,a=e.answerId,i=e.usedReferences;r!==o.RewriteStatusRequest.LOADING&&n!==c.AnswerType.GENERATE||w(!0),t&&r===o.RewriteStatusRequest.SUCCESS&&a?O({answer:t,answerId:a,usedReferences:i}):A(!0)},onError:I,onMutate:function(){n===c.AnswerType.GENERATE_BY_HELPER&&w(!0)}}),N=k.mutate,x=k.data,P=k.isLoading;return(0,r.useQuery)({queryKey:["answer",null==x?void 0:x.jobUuid],queryFn:function(){return(0,i.getRewriterRequest)({jobUuid:null==x?void 0:x.jobUuid,maxRequestCount:20,url:u.ANSWER_URL,incrementRequestCount:_,clearRequestCount:C,requestCount:R.current})},enabled:b,refetchInterval:c.REFETCH_ANSWER_INTERVAL,onSuccess:function(e){var t=e.answer,r=e.status,a=e.answerId,i=e.usedReferences;r!==o.RewriteStatusRequest.LOADING&&n!==c.AnswerType.GENERATE&&n!==c.AnswerType.GENERATE_BY_HELPER||w(!0),t&&r===o.RewriteStatusRequest.SUCCESS&&a&&(O({answer:t,answerId:a,usedReferences:i}),A(!1))},onError:function(e){A(!1),w(!1),I(e)}}),{error:v,toggleRefetching:function(e){A(e)},isLoading:g||(n===c.AnswerType.GENERATE||n===c.AnswerType.GENERATE_BY_HELPER)&&P,postAnswer:N}}},805556:(e,t,n)=>{var r,a;n.r(t),n.d(t,{AiAnswerCloseEvents:()=>r,AnswerErrorReasons:()=>a}),function(e){e.CLOSE="close",e.READ="read",e.USER_CHANGE="user_change",e.SOCKET_EXTERNAL="socket-external",e.SOCKET_INCOMING="socket-incoming"}(r||(r={})),function(e){e.EMPTY_ARTICLES="Articles or answers not found"}(a||(a={}))},355582:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var r=n(827378),a=n(629133),o=n.n(a),i=n(267651),u=n.n(i),s=n(292554),l=n.n(s),c=n(500034),f=n(292562),d=n(960190),p=n(438089),m=n(587776),E=n(99854),v=n(399206),y=n(436132),h=n(233678),b=n(728822),A=n(827378),S=l().bind(b.default),g=(0,r.forwardRef)((function(e,t){var n=e.getText,a=e.onLoad,i=e.setText,s=e.setHelperHeight,l=e.onShow,b=e.shouldCheckGrammar,g=void 0===b||b,w=(0,r.useRef)(null),T=(0,h.default)({shouldCheckGrammar:g}),R=T.suggestion,_=T.isShow,C=T.hide,I=T.checker,O=T.clear;(0,r.useEffect)((function(){_&&(s(y.BASE_HELPER_HEIGHT,!1),l())}),[_]);var k=(0,r.useRef)(null),N=(0,r.useRef)(""),x=(0,r.useRef)(""),P=function(e,t){var n=t?t.trim():"";if(!t||x.current.trim()===n||(0,c.isFeatureAvailable)("ai_limited"))return O(),void C();N.current.trim()!==n&&(I(t),x.current="",N.current="")},U=function(){C()},L=function(e,t){var n=t.answer;N.current=n},D=function(){var e,t=n();(null===(e=k.current)||void 0===e?void 0:e.answerId)&&(0,d.markRewriter)({currentText:t,rewriterAnswer:k.current})},M=function(e,t){x.current=t};(0,r.useEffect)((function(){var e=n(),t=u().subscribe(y.FEED_COMPOSE_INPUT_CHANGE,P),r=u().subscribe(y.AI_REWRITER_USE_START,U),a=u().subscribe(y.AI_REWRITER_USE_END,L),o=u().subscribe(y.FEED_COMPOSE_SUBMIT,D),i=u().subscribe(y.AI_COMPOSE_ANSWER_PASTED,M);return e?I(e):C(),function(){u().unsubscribe(t),u().unsubscribe(o),u().unsubscribe(r),u().unsubscribe(a),u().unsubscribe(i)}}),[]);var F=(0,v.default)({onMutate:function(){a(!0)},onError:function(){a(!1),O()},onSuccess:function(e){var t=e.answer,r=n();k.current=e,N.current=t,a(!1),i({text:t}),O(),u().publish(y.AI_REWRITER_USAGE,{data:e,originalText:r})}}),H=F.postRewriterAnswer,G=F.error,q=(0,p.default)(E.default,{onCloseRequest:function(){return!0},error:G}),B=q.modalElement,j=q.showModal;return(0,r.useEffect)((function(){G&&j(),(null==G?void 0:G.code)===f.RewriterErrorCodes.PAYMENT_REQUIRED?(0,c.updateFeature)("ai_limited",!0):(0,c.updateFeature)("ai_limited",!1)}),[G]),A.createElement(A.Fragment,null,G&&B,A.createElement(m.default,{ref:function(e){w.current=e,o().isFunction(t)?t(e):t&&(t.current=e)},onClick:function(){var e=n();R.optionId&&(C(),H({text:e,id:R.optionId}))},className:S({active:_&&n(),button:!0})},R.text))}));g.displayName="AiSuggestion";const w=g},233678:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var r=n(827378),a=n(629133),o=n.n(a),i=n(445368),u=n(500034),s=n(915177),l=n(960190),c=n(439590),f=n(915634);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){p(o,r,a,i,u,"next",e)}function u(e){p(o,r,a,i,u,"throw",e)}i(void 0)}))}}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var y=APP.lang_id,h=[s.LANGUAGE_CODE.ID],b=/[^\w\s\u0400-\u04FF_]| $/;const A=function(e){var t,n=e.shouldCheckGrammar,a=E((0,r.useState)(!1),2),s=a[0],d=a[1],p=E((0,r.useState)({optionId:null,text:""}),2),A=p[0],S=p[1],g=(0,r.useRef)({shorter:!1,tone:!1,profanity:!1,grammar:!1}),w=function(e){return o().chain(g.current).omit(e).values().some().value()},T=function(){d(!1)},R=function(e){S(e),d(!0)},_=function(){g.current={shorter:!1,tone:!1,profanity:!1,grammar:!1},T()},C=(t=m((function(e){var t,n,r,a,o;return v(this,(function(i){switch(i.label){case 0:if(t=e.type,n=e.request,r=e.text,a=e.suggestionOptions,w(t))return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n(r)];case 2:return o=i.sent(),w(t)?[2]:(g.current[t]=Boolean(o),o?R(a):d(!1),[3,4]);case 3:return i.sent(),g.current[t]=!1,w(t)?[2]:(d(!1),[3,4]);case 4:return[2]}}))})),function(e){return t.apply(this,arguments)}),I=function(){var e=m((function(e){return v(this,(function(t){switch(t.label){case 0:return[4,C({type:f.SuggestionType.PPOFANITY,text:e,request:l.profanity,suggestionOptions:{text:(0,i.i18n)("Make it professional"),optionId:c.OptionsRewriter.FORMAL}})];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=m((function(e){return v(this,(function(t){switch(t.label){case 0:return[4,C({type:f.SuggestionType.GRAMMAR,text:e,request:l.grammar,suggestionOptions:{text:(0,i.i18n)("Correct grammar & spelling"),optionId:c.OptionsRewriter.GRAMMAR}})];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=m((function(e){return v(this,(function(t){switch(t.label){case 0:return e.length>=1800?[2]:[4,C({type:f.SuggestionType.TONE,text:e,request:l.tone,suggestionOptions:{text:(0,i.i18n)("Make it friendly"),optionId:c.OptionsRewriter.FRIENDLY}})];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),N=o().debounce((function(e){var t=e.length;if(!(t<15)){var r=e[t-1];b.test(r)&&(I(e),!h.includes(y)&&n&&O(e),(0,u.isFeatureAvailable)(u.Features.IS_CUSTOMIZATION_FOR_GLOBAL)&&k(e))}}),2e3);return{suggestion:A,isShow:s,hide:T,checker:function(e){var t;e.length>=1e4?_():(t=e,w(f.SuggestionType.SHORTER)||(t.length>=2500?(g.current[f.SuggestionType.SHORTER]=!0,R({optionId:c.OptionsRewriter.SHORTER,text:(0,i.i18n)("Make it shorter")})):(g.current[f.SuggestionType.SHORTER]=!1,d(!1))),N(e))},clear:_}}},915634:(e,t,n)=>{var r;n.r(t),n.d(t,{SuggestionType:()=>r}),function(e){e.SHORTER="shorter",e.TONE="tone",e.PPOFANITY="profanity",e.GRAMMAR="grammar"}(r||(r={}))},30893:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var r=n(629133),a=n.n(r),o=n(827378),i=n.n(o),u=n(292554),s=n.n(u),l=n(267651),c=n.n(l),f=n(445368),d=n(769734),p=n(292562),m=n(195601),E=n(436132),v=n(587776),y=n(805556),h=n(378902),b=n(604789),A=n(661533);function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var T=s().bind(b.default),R={taskId:null,taskText:"",taskType:null,taskDeadline:null},_=(0,o.forwardRef)((function(e,t){var n,r,u=e.messageId,s=e.talkId,l=e.elementId,b=e.elementType,S=e.setHelperHeight,_=e.onTryToShow,C=e.onHide,I=e.onError,O=w((0,o.useState)(!1),2),k=O[0],N=O[1],x=(0,o.useRef)(R),P=(0,o.useRef)({show:a().noop,hide:a().noop}),U=(0,h.default)({onSuccess:function(e){var t=e.taskId,n=e.taskText,r=e.taskType,o=e.taskDeadline;x.current={taskId:t,taskText:n,taskType:a().contains([p.TaskTypes.FOLLOW_UP,p.TaskTypes.MEET],r)?r:p.TaskTypes.FOLLOW_UP,taskDeadline:o},_({helperType:E.AiHelperType.TASK,cb:P.current.show,isLoading:D})},onError:function(){x.current=R,k&&P.current.hide(),I({helperType:E.AiHelperType.TASK})}}),L=U.postTask,D=U.isLoading,M=U.toggleRefetching,F=(n=function(){return function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}(this,(function(e){switch(e.label){case 0:return M(!1),N(!1),[4,C(E.AiHelperType.TASK)];case 1:return e.sent(),k&&S(E.NULL_HELPER_HEIGHT),[2]}}))},r=function(){var e=this,t=arguments;return new Promise((function(r,a){var o=n.apply(e,t);function i(e){g(o,r,a,i,u,"next",e)}function u(e){g(o,r,a,i,u,"throw",e)}i(void 0)}))},function(){return r.apply(this,arguments)});P.current={show:function(){S(E.BASE_HELPER_HEIGHT),N(!0)},hide:F};var H=function(e,t){if(t){var n=t.event,r=t.talkId;switch(n){case y.AiAnswerCloseEvents.CLOSE:case y.AiAnswerCloseEvents.READ:r===s&&F();break;case y.AiAnswerCloseEvents.SOCKET_EXTERNAL:break;default:F()}}};(0,o.useEffect)((function(){L({messageId:u,talkId:s,elementId:l,elementType:b})}),[u]),(0,o.useEffect)((function(){D&&_({helperType:E.AiHelperType.TASK,cb:P.current.show,isLoading:D})}),[D]),(0,o.useEffect)((function(){var e=c().subscribe(E.AI_ANSWER_CLOSE,H);return function(){c().unsubscribe(e)}}),[]);var G="";if(!0===D)G=i().createElement(m.default,null);else{var q=x.current,B=q.taskDeadline,j=q.taskText;G="".concat((0,f.i18n)("Add task")," ").concat(B?(0,f.i18n)("for (time)")+" "+(0,d.getDateByTimestamp)({timestamp:B}):""," ").concat(j?" — "+j:"")}return i().createElement(v.default,{ref:t,className:"".concat(T("button",{active:k,disable:D})," js-ai-task"),onClick:function(){var e=x.current,t=e.taskId,n=e.taskDeadline,r=e.taskType,a=e.taskText;P.current.hide();var o=w(n?(0,d.getDateByTimestamp)({timestamp:n}).split(" "):[null,null],2),i=o[0],u=o[1];A(document).trigger("notes:compose:switch",["task",{date:i,time:u,type:r,body:a,generalOptions:{isFromAiHelpers:!0,taskId:t,shouldPreventAiHelpers:!0}}])},isClosable:!0,onCloseClick:function(){F()}},i().createElement("div",{className:T("preview",{loading:D})},G))}));_.displayName="AiTask";const C=_},378902:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var r=n(629133),a=n.n(r),o=n(456552),i=n(827378),u=n(292562),s=n(604874),l=n(58256),c=n(555424),f=n(942407),d=n(436132);function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const E=function(e){var t=e.onSuccess,n=void 0===t?a().noop:t,r=e.onError,p=void 0===r?a().noop:r,E=e.onMutate,v=void 0===E?a().noop:E,y=m((0,i.useState)(null),2),h=y[0],b=y[1],A=m((0,i.useState)(!1),2),S=A[0],g=A[1],w=m((0,i.useState)(!1),2),T=w[0],R=w[1],_=(0,f.default)(),C=_.requestCount,I=_.incrementRequestCount,O=_.clearRequestCount,k=function(e){var t=e.detail,n=e.code;p(e),b({detail:t,code:n})},N=function(e){n(e),b(null),R(!1)},x=(0,o.useMutation)({mutationFn:function(e){return v(),(0,l.default)(e)},onSuccess:function(e){var t=e.taskId,n=e.taskText,r=e.taskType,a=e.taskDeadline,o=e.status;o===u.RewriteStatusRequest.LOADING&&R(!0),o!==u.RewriteStatusRequest.SUCCESS?g(!0):N({taskId:t,taskType:r,taskText:n,taskDeadline:a})},onError:k}),P=x.mutate,U=x.data;return(0,o.useQuery)({queryKey:["task",null==U?void 0:U.jobUuid],queryFn:function(){return(0,c.getTaskRequest)({jobUuid:null==U?void 0:U.jobUuid,maxRequestCount:10,url:s.TASK_URL,incrementRequestCount:I,clearRequestCount:O,requestCount:C.current})},enabled:S&&Boolean(U),refetchInterval:d.REFETCH_ANSWER_INTERVAL,onSuccess:function(e){var t=e.taskId,n=e.taskText,r=e.taskType,a=e.taskDeadline,o=e.status;o===u.RewriteStatusRequest.LOADING&&R(!0),o===u.RewriteStatusRequest.SUCCESS&&n&&(N({taskId:t,taskType:r,taskText:n,taskDeadline:a}),g(!1))},onError:function(e){g(!1),R(!1),k(e)}}),{error:h,toggleRefetching:function(e){g(e)},isLoading:T,postTask:P}}},4190:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var r=n(827378),a=n(292554),o=n.n(a),i=n(267651),u=n.n(i),s=n(629133),l=n.n(s),c=n(491967),f=n(241811),d=n(445368),p=n(500034),m=n(317954),E=n(614759),v=n(960190),y=n(292562),h=n(438089),b=n(387725),A=n(99854),S=n(436132),g=n(399206),w=n(238332),T=n(830221),R=n(967482),_=n(758918),C=n(827378);function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var k=o().bind(_.default),N=(0,p.isFeatureAvailable)(p.Features.IS_CUSTOMIZATION_FOR_GLOBAL);const x=(0,E.withQueryProvider)((function(e){var t=e.offset,n=t.right,a=t.bottom,o=e.getText,i=e.setText,s=e.onLoad,E=(0,r.useRef)(null),_=(0,r.useRef)(null),I=(0,r.useRef)(null),x=O((0,r.useState)(null),2),P=x[0],U=x[1],L=O((0,r.useState)(!1),2),D=L[0],M=L[1],F=O((0,r.useState)(!0),2),H=F[0],G=F[1],q=O((0,r.useState)(0),2),B=q[0],j=q[1],W=(0,r.useRef)([]),Y=(0,g.default)({onSuccess:function(e){var t=o(),n=e.answer;l().first(W.current)!==t&&W.current.unshift(t),s(!1),_.current=e,u().publish(S.AI_REWRITER_USE_END,{answer:n}),i(n)},onError:function(e){var t=e.isInternalError;s(!1),t&&(M(!0),W.current.length&&j((function(e){return++e})))},onMutate:function(){s(!0)}}),z=Y.postRewriterAnswer,K=Y.error,V=Y.hideError,Q=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n.length>3e3?G(!1):G(!0),V(),I.current&&I.current!==n&&(null===(t=_.current)||void 0===t?void 0:t.answer)!==n&&(W.current=[],I.current=null),M(!1)},$=function(e,t){var n=t.data,r=t.originalText;W.current.unshift(r),_.current=n},X=function(){var e;if(null===(e=_.current)||void 0===e?void 0:e.answerId){var t=o();(0,v.markRewriter)({currentText:t,rewriterAnswer:_.current})}},Z=(0,h.default)(A.default,{onCloseRequest:function(){return V(),!0},error:K}),J=Z.modalElement,ee=Z.showModal;(0,r.useEffect)((function(){var e=u().subscribe(S.FEED_COMPOSE_INPUT_CHANGE,Q),t=u().subscribe(S.FEED_COMPOSE_SUBMIT,X),n=u().subscribe(S.AI_REWRITER_USAGE,$);return function(){u().unsubscribe(e),u().unsubscribe(t),u().unsubscribe(n)}}),[]),(0,r.useEffect)((function(){K&&(K.code===y.RewriterErrorCodes.PAYMENT_REQUIRED?(ee(),(0,p.updateFeature)("ai_limited",!0)):(0,p.updateFeature)("ai_limited",!1))}),[K]);var te=function(){var e=W.current.shift()||"";j((function(e){return--e})),I.current=e,u().publish(S.AI_COMPOSE_ANSWER_PASTED,e),i(e),M(!1)};return C.createElement("div",{onMouseEnter:function(){M(!0),E.current&&clearTimeout(E.current)},onMouseLeave:function(){E.current=setTimeout((function(){M(!1)}),250)},className:k("control",{active:D})},C.createElement(b.default,{dataSrc:R.default}),J,C.createElement(c.default,{type:"svg",className:k("sticker"),name:"ai_rewrite--ai"}),C.createElement("div",{className:k("wrapper",{opened:D}),style:{bottom:a,right:n},onMouseEnter:function(){M(!0),E.current&&clearTimeout(E.current)}},K&&K.code!==y.RewriterErrorCodes.PAYMENT_REQUIRED?C.createElement(T.default,{onUndoClick:te,onTryClick:function(){var e=o();P&&(z({text:e,id:P}),M(!1))},isUndoAvailable:Boolean(B),error:K}):C.createElement(C.Fragment,null,C.createElement("div",{className:k("header")},C.createElement("div",{className:k("brand")},(0,d.i18n)("{{brand_name.ai}}")),N&&C.createElement(m.MetaBadge,{title:(0,d.i18n)("Beta"),theme:"purple"})),C.createElement(w.default,{shouldLongerOptionsShow:H,onOptionClick:function(e){if(1!=!(0,p.isFeatureAvailable)(p.Features.AIREWRITER)){var t=o();U(e),z({text:t,id:e}),u().publish(S.AI_REWRITER_USE_START,{}),M(!1)}else u().publish(f.default,!0)},isUndoOptionVisible:Boolean(W.current.length),onUndoOptionClick:te}))))}))},830221:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var r=n(629133),a=n.n(r),o=n(827378),i=n.n(o),u=n(292554),s=n.n(u),l=n(352467),c=n(671837),f=n(445368),d=n(292562),p=n(275814),m=s().bind(p.default),E=[d.RewriterErrorCodes.PAYMENT_REQUIRED,d.RewriterErrorCodes.VALIDATION_ERROR];const v=function(e){var t=e.onTryClick,n=e.error,r=e.onUndoClick,o=e.isUndoAvailable,u=n.detail,s=n.code,d=!a().include(E,s);return i().createElement("div",{className:m("wrapper")},i().createElement("p",{className:m("text")},u),d&&i().createElement("p",null,i().createElement(c.default,{theme:l.LinkPrimaryTheme,className:"button",onClick:function(){t()}},(0,f.i18n)("Try again"))),o&&i().createElement(c.default,{theme:l.LinkPrimaryTheme,className:"button",onClick:r},(0,f.i18n)("Undo changes")))}},238332:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var r=n(827378),a=n.n(r),o=n(629133),i=n.n(o),u=n(292554),s=n.n(u),l=n(724329),c=n(491967),f=n(445368),d=n(439590),p=n(84290),m=s().bind(p.default);const E=function(e){var t=e.onOptionClick,n=e.onUndoOptionClick,r=e.isUndoOptionVisible,o=e.shouldLongerOptionsShow,u=(0,l.useConst)((function(){return[{id:d.OptionsRewriter.GRAMMAR,option:(0,f.i18n)("Correct grammar & spelling"),icon:"grammar-check"},{id:d.OptionsRewriter.FORMAL,option:(0,f.i18n)("Make it professional"),icon:"formal"},{id:d.OptionsRewriter.FRIENDLY,option:(0,f.i18n)("Make it friendly"),icon:"friendly"},{id:d.OptionsRewriter.HUMOROUS,option:(0,f.i18n)("Make it witty"),icon:"humorous"},{id:d.OptionsRewriter.LONGER,option:(0,f.i18n)("Make it longer"),icon:"longer"},{id:d.OptionsRewriter.SHORTER,option:(0,f.i18n)("Make it shorter"),icon:"shorter"},{id:d.OptionsRewriter.SIMPLIFY,option:(0,f.i18n)("Make it simpler"),icon:"simplify"}]}));return a().createElement("div",{className:m("select")},i().map(u,(function(e){var n=e.icon,r=e.id,i=e.option;if(o||r!==d.OptionsRewriter.LONGER)return a().createElement("div",{className:m("option"),onClick:function(){t(r)},key:r},a().createElement("div",{className:m("option-icon")},a().createElement(c.default,{type:"svg",className:m("icon"),name:"ai_rewrite--".concat(n)})),a().createElement("div",null,i))})),r&&a().createElement("div",{className:m("option","option-revert"),onClick:function(){n()}},a().createElement("div",{className:m("option-icon")},a().createElement(c.default,{type:"svg",className:m("icon"),name:"ai_rewrite--back"})),a().createElement("div",null,(0,f.i18n)("Undo changes"))))}},585402:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var r=n(827378),a=n.n(r),o=n(292554),i=n.n(o),u=n(588039),s=n(534139),l=n(916569),c=n(529062),f=n(701106),d=n(445368),p=n(464702),m=n(613092),E=n(970948),v=n(447399),y=n(248813),h=i().bind(y.default),b=(0,p.getCDNPath)("/frontend/images/interface/ai_onboarding/"),A=APP.lang_id.toUpperCase(),S={"1x":"".concat(b,"survey-success_").concat(A,".png"),"2x":"".concat(b,"survey-success_").concat(A,"@2x.png")};const g=function(e){var t=e.onSuccess,n=(0,m.useSteps)().changeStep,r=(0,u.useFormContext)().control;return a().createElement(E.default,{images:S},a().createElement("div",{className:h("wrapper")},a().createElement(f.default,{className:h("title"),type:"h2",size:"xxl"},(0,d.i18n)("Thanks for your input")),a().createElement(l.Text,{theme:l.TextPrimaryTheme,className:h("text"),size:"l"},(0,d.i18n)("Feel free to provide any additional feedback or suggestions.")),a().createElement(u.Controller,{control:r,name:"fields.comment",render:function(e){var t=e.field,n=t.onChange,r=t.value;return a().createElement(s.TextArea,{theme:s.TextareaDarkTheme,className:h("mb-16"),value:r,onChange:function(e){n(e.target.value)},placeholder:(0,d.i18n)("What did you think of Kommo AI?")})}}),a().createElement(c.Button,{theme:c.ButtonPrimaryTheme,onClick:function(){t(),n(v.AiTrialExpiredSurveyFlowSteps.SUCCESS_STEP)}},(0,d.i18n)("Finish"))))}},331416:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var r=n(827378),a=n.n(r),o=n(292554),i=n.n(o),u=n(629133),s=n.n(u),l=n(588039),c=n(916569),f=n(529062),d=n(596004),p=n(724329),m=n(701106),E=n(445368),v=n(464702),y=n(613092),h=n(417438),b=n(970948),A=n(447399),S=n(450518);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=i().bind(S.default),T=(0,v.getCDNPath)("/frontend/images/interface/ai_onboarding/"),R=APP.lang_id.toUpperCase(),_={"1x":"".concat(T,"survey_").concat(R,".png"),"2x":"".concat(T,"survey_").concat(R,"@2x.png")};const C=function(){var e=(0,y.useSteps)().changeStep,t=(0,p.useConst)((function(){return[{id:(0,E.i18n)("Don't need AI"),value:(0,E.i18n)("Don't need AI")},{id:(0,E.i18n)("Poor AI output"),value:(0,E.i18n)("Poor AI output")},{id:(0,E.i18n)("Don’t need other Enterprise features"),value:(0,E.i18n)("Don’t need other Enterprise features")},{id:(0,E.i18n)("Too expensive"),value:(0,E.i18n)("Too expensive")},{id:(0,E.i18n)("Not enough features"),value:(0,E.i18n)("Not enough features")}]})),n=(0,l.useFormContext)(),r=n.control,o=n.formState.isDirty;return a().createElement(b.default,{images:_},a().createElement("div",{className:w("wrapper")},a().createElement(m.default,{className:w("title"),type:"h2",size:"xxl"},(0,E.i18n)("Why didn't it work for you?")),a().createElement(c.Text,{theme:c.TextPrimaryTheme,className:w("text"),size:"l"},(0,E.i18n)("Select one or more reasons:")),a().createElement(l.Controller,{control:r,name:"fields.reasons",render:function(e){var n=e.field,r=n.onChange,o=n.value;return a().createElement(h.ChoosableOptions,{options:t,chosenOptions:o,onChoose:function(e){var t,n=function(e){if(Array.isArray(e))return g(e)}(t=o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();s().contains(o,e)?n=s().without(o,e):n.push(e),r(n)},className:w("options")})}}),a().createElement(l.Controller,{control:r,name:"fields.other",render:function(e){var t=e.field,n=t.onChange,r=t.value;return a().createElement(d.Input,{theme:d.InputLightTheme,className:w("input"),value:r,onChange:function(e){n(e.target.value)},placeholder:(0,E.i18n)("Other (please specify)")})}}),a().createElement(f.Button,{theme:f.ButtonPrimaryTheme,onClick:function(){e(A.AiTrialExpiredSurveyFlowSteps.FINISH_STEP)},isDisabled:!o},(0,E.i18n)("Submit"))))}},711660:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var r=n(827378),a=n.n(r),o=n(417438),i=n(970948);const u=function(e){var t=e.onCloseRequest,n=(0,o.useInvalidateSurveyRequest)().invalidateSurveyRequest;return(0,r.useEffect)((function(){setTimeout((function(){t(),n()}),3e3)}),[]),a().createElement(i.default,null,a().createElement(o.Success,null))}},205636:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var r=n(827378),a=n.n(r),o=n(292554),i=n.n(o),u=n(916569),s=n(529062),l=n(701106),c=n(445368),f=n(464702),d=n(613092),p=n(970948),m=n(447399),E=n(881323),v=i().bind(E.default),y=(0,f.getCDNPath)("/frontend/images/interface/ai_onboarding/"),h=APP.lang_id.toUpperCase(),b={"1x":"".concat(y,"kommo-ai_").concat(h,".png"),"2x":"".concat(y,"kommo-ai_").concat(h,"@2x.png")};const A=function(e){var t=e.onSuccess,n=(0,d.useSteps)().changeStep;return a().createElement(p.default,{images:b},a().createElement("div",{className:v("wrapper")},a().createElement("div",null,a().createElement(l.default,{className:v("title"),type:"h2",size:"xxl"},(0,c.i18n)("Your Kommo AI trial has ended (Survey)")),a().createElement(u.Text,{theme:u.TextPrimaryTheme,className:v("text"),size:"l"},(0,c.i18n)("To continue using Kommo AI, upgrade to our Enterprise plan."))),a().createElement("div",null,a().createElement(s.Button,{theme:s.ButtonNeutralTheme,onClick:function(){t(m.AiTrialExpiredSurveyFlowSteps.TRIAL_ENDED),APP.router.navigate("settings/pay",{trigger:!0})}},(0,c.i18n)("Upgrade now (Survey)")),a().createElement(s.Button,{theme:s.ButtonNeutralTheme,onClick:function(){n(m.AiTrialExpiredSurveyFlowSteps.REASON_OPTIONS)}},(0,c.i18n)("I'm not interested")))))}},846505:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var r=n(629133),a=n.n(r),o=n(827378),i=n.n(o),u=n(588039),s=n(613092),l=n(845174),c=n(583089),f=n(447399);const d=(0,s.withStepsProvider)((function(e){var t=e.onClose,n=void 0===t?a().noop:t,r=e.onSuccess,o=(0,c.default)(),s=o.formMethods,f=o.getValidData;return i().createElement(u.FormProvider,s,i().createElement(l.default,{onCloseRequest:function(){n()},onSuccess:function(e){var t=f(e);r(t)}}))}),f.AiTrialExpiredSurveyFlowSteps.TRIAL_ENDED)},447399:(e,t,n)=>{var r;n.r(t),n.d(t,{AiTrialExpiredSurveyFlowSteps:()=>r}),function(e){e.TRIAL_ENDED="trial-ended",e.REASON_OPTIONS="reason-options",e.FINISH_STEP="finish-step",e.SUCCESS_STEP="success-step"}(r||(r={}))},845174:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var r=n(827378),a=n.n(r),o=n(613092),i=n(447399),u=n(205636),s=n(331416),l=n(585402),c=n(711660);const f=function(e){var t=e.onCloseRequest,n=e.onSuccess;switch((0,o.useSteps)().activeStep){case i.AiTrialExpiredSurveyFlowSteps.TRIAL_ENDED:return a().createElement(u.default,{onSuccess:n});case i.AiTrialExpiredSurveyFlowSteps.REASON_OPTIONS:return a().createElement(s.default,null);case i.AiTrialExpiredSurveyFlowSteps.FINISH_STEP:return a().createElement(l.default,{onSuccess:n});case i.AiTrialExpiredSurveyFlowSteps.SUCCESS_STEP:return a().createElement(c.default,{onCloseRequest:t})}}},486037:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var r=n(827378),a=n.n(r),o=n(292554),i=n.n(o),u=n(438089),s=n(246541),l=n(846505),c=n(945948),f=i().bind(c.default);const d=function(e){var t=e.onCloseRequest,n=e.onSuccess,o=function(){t()},i=(0,u.default)((function(){return a().createElement(s.GlobalUnifiedModal,{onClose:o,size:"s",customPosition:{right:"40px",bottom:"40px"},isPopup:!0,isCloseButtonVisible:!1,slideDirection:"right",className:f("modal"),hideDistance:600},a().createElement(l.default,{onSuccess:n}))})),c=i.modalElement,d=i.showModal;return(0,r.useEffect)((function(){d()}),[]),c}},436132:(e,t,n)=>{n.r(t),n.d(t,{ACTIVATE_AGENT_URL_HASH:()=>T,AI_ANSWER_CLOSE:()=>E,AI_ANSWER_GENERATE_RESPONSE:()=>v,AI_ANSWER_MESSAGE_ADD:()=>p,AI_COMPOSE_ANSWER_PASTED:()=>m,AI_HELPER_RESIZE:()=>h,AI_REWRITER_USAGE:()=>c,AI_REWRITER_USE_END:()=>d,AI_REWRITER_USE_START:()=>f,AI_TASK_PASTE_CLICK:()=>y,AiHelperType:()=>r,AnswerType:()=>a,BASE_BOTTOM_HELPERS_OFFSET:()=>A,BASE_HELPER_HEIGHT:()=>o,FEED_COMPOSE_INPUT_CHANGE:()=>s,FEED_COMPOSE_SUBMIT:()=>l,MAX_OPENED_ANSWER_HEIGHT:()=>b,NULL_HELPER_HEIGHT:()=>i,REFETCH_ANSWER_INTERVAL:()=>g,REFETCH_INTERVAL:()=>S,REWRITER_ONBOARDING_CLOSED:()=>R,SHOW_HIDE_ANIMATION_DURATION_MS:()=>u,SHOW_SOURCES_MODAL_URL_HASH:()=>w});var r,a,o="36px",i="0px",u=400,s="feed:compose:input-change",l="feed:compose:submit",c="rewriter:usage",f="rewriter:use:start",d="rewriter:use:end",p="answer:message:add",m="answer:compose:pasted",E="answer:close",v="answer:generate:response",y="task:paste:click",h="helper:resize",b=305,A=10,S=2e3,g=1e3,w="#show_ai_sources_modal",T="#activate_agent",R="rewriter_onboarding_closed";!function(e){e.ANSWER="answer",e.TASK="task",e.SUGGESTION="suggestion"}(r||(r={})),function(e){e.DEFAULT="default",e.GENERATE="generate",e.GENERATE_BY_HELPER="generateByHelper"}(a||(a={}))},583089:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var r=n(161320),a=n.n(r),o=n(827378),i=n(588039),u=n(417438),s=n(447399);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}var c={reasons:[],other:"",comment:""};const f=function(){var e=(0,o.useRef)(a()()),t=l({},function(e){if(null==e)throw new TypeError("Cannot destructure "+e);return e}((0,i.useForm)({defaultValues:{fields:c}}))),n=t.getValues;return{isDirty:t.formState.isDirty,control:t.control,formMethods:t,getValidData:function(t){var r;if(t===s.AiTrialExpiredSurveyFlowSteps.TRIAL_ENDED)r={movedToBilling:!0};else{var o=n().fields,i=o.reasons,l=o.other,c=o.comment;l&&i.push(l),r={reasons:i,text:c}}var f=a()().diff(e.current,"seconds");return{name:u.Surveys.KOMMO_AI_TRIAL,data:r,metadata:{viewingTime:f,viewingUrl:window.location.pathname}}}}}},942407:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var r=n(827378);const a=function(){var e=(0,r.useRef)(0);return{requestCount:e,incrementRequestCount:function(){e.current+=1},clearRequestCount:function(){e.current=0}}}},399206:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var r=n(456552),a=n(827378),o=n(445368),i=n(859200),u=n(960190),s=n(292562),l=n(304483),c=n(436132),f=n(942407);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const m=function(e){var t=e.onSuccess,n=e.onError,d=e.onMutate,m=p((0,a.useState)(null),2),E=m[0],v=m[1],y=p((0,a.useState)(!1),2),h=y[0],b=y[1],A=(0,f.default)(),S=A.requestCount,g=A.incrementRequestCount,w=A.clearRequestCount,T=function(e){var t=e.detail,r=e.code,a=e.show_modal;if(n({isInternalError:!a,detail:t}),a){var u=(0,i.isAdmin)()?"".concat(t,' <a href="/settings/ai">').concat((0,o.i18n)("Go to settings (AI)"),"</a>"):t;(new l.default).showError(u,!1)}else v({detail:t,code:r})},R=function(e){t(e),v(null)},_=(0,r.useMutation)({mutationFn:function(e){return d(),(0,u.postRewriterRequest)(e)},onSuccess:function(e){var t=e.answer,n=e.status,r=e.answerId;t&&n===s.RewriteStatusRequest.SUCCESS&&r?R({answer:t,answerId:r}):b(!0)},onError:T}),C=_.mutate,I=_.data;return(0,r.useQuery)({queryKey:["rewriter",null==I?void 0:I.jobUuid],queryFn:function(){return(0,u.getRewriterRequest)({jobUuid:null==I?void 0:I.jobUuid,maxRequestCount:5,url:u.REWRITER_URL,incrementRequestCount:g,clearRequestCount:w,requestCount:S.current})},enabled:h,refetchInterval:c.REFETCH_INTERVAL,onSuccess:function(e){var t=e.answer,n=e.status,r=e.answerId;t&&n===s.RewriteStatusRequest.SUCCESS&&r&&(R({answer:t,answerId:r}),b(!1))},onError:function(e){b(!1),T(e)}}),{error:E,postRewriterAnswer:C,hideError:function(){v(null)}}}},353256:(e,t,n)=>{n.r(t),n.d(t,{AI_ANSWER_CLOSE:()=>s.AI_ANSWER_CLOSE,AI_ANSWER_GENERATE_RESPONSE:()=>s.AI_ANSWER_GENERATE_RESPONSE,AI_ANSWER_MESSAGE_ADD:()=>s.AI_ANSWER_MESSAGE_ADD,AI_HELPER_RESIZE:()=>s.AI_HELPER_RESIZE,AiAgentActivationPopup:()=>u.default,AiAgentCardControl:()=>o.default,AiAnswerCloseEvents:()=>c.AiAnswerCloseEvents,AiHelpers:()=>r.default,AiRewriter:()=>a.default,AiTrialExpiredSurveyPopup:()=>i.default,BASE_HELPER_HEIGHT:()=>s.BASE_HELPER_HEIGHT,FEED_COMPOSE_INPUT_CHANGE:()=>s.FEED_COMPOSE_INPUT_CHANGE,FEED_COMPOSE_SUBMIT:()=>s.FEED_COMPOSE_SUBMIT,OptionsRewriter:()=>l.OptionsRewriter,REWRITER_ONBOARDING_CLOSED:()=>s.REWRITER_ONBOARDING_CLOSED,replaceNewlinesWithBreaks:()=>f.replaceNewlinesWithBreaks});var r=n(912077),a=n(4190),o=n(559261),i=n(486037),u=n(201029),s=n(436132),l=n(439590),c=n(805556),f=n(117464)},439590:(e,t,n)=>{var r;n.r(t),n.d(t,{OptionsRewriter:()=>r}),function(e){e[e.FORMAL=1]="FORMAL",e[e.FRIENDLY=2]="FRIENDLY",e[e.HUMOROUS=3]="HUMOROUS",e[e.LONGER=4]="LONGER",e[e.SHORTER=5]="SHORTER",e[e.GRAMMAR=6]="GRAMMAR",e[e.SIMPLIFY=7]="SIMPLIFY"}(r||(r={}))},587776:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var r=n(827378),a=n.n(r),o=n(292554),i=n.n(o),u=n(629133),s=n.n(u),l=n(706898),c=n(740098),f=n(294238),d=i().bind(f.default),p=(0,r.forwardRef)((function(e,t){var n=e.onClick,r=e.onCloseClick,o=void 0===r?s().noop:r,i=e.className,u=void 0===i?"":i,f=e.children,p=e.isClosable,m=void 0!==p&&p;return a().createElement("div",{onClick:function(e){n(e)},className:"".concat(d("button")," ").concat(u),ref:t},a().createElement(l.default,{className:d("icon")}),f,m&&a().createElement("div",{className:d("close"),onClick:function(e){e.stopPropagation(),o()}},a().createElement(c.default,null)))}));p.displayName="AiHelperButton";const m=p},195601:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var r=n(827378),a=n.n(r),o=n(445368),i=n(797154);const u=function(){return a().createElement(a().Fragment,null,a().createElement("div",null,(0,o.i18n)("Working on it")),a().createElement(i.AnimatedDots,null))}},740098:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var r=n(629133),a=n.n(r),o=n(827378),i=n.n(o);const u=function(e){var t=e.onClick,n=void 0===t?a().noop:t,r=e.className,o=void 0===r?"":r;return i().createElement("svg",{onClick:n,className:o,width:"16",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i().createElement("path",{d:"m4 4.5 4 4m4 4-4-4m0 0 4-4m-4 4-4 4",stroke:"#6B6D72"}))}},706898:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var r=n(827378),a=n.n(r),o=n(491967);const i=function(e){var t=e.className,n=void 0===t?"":t;return a().createElement(o.default,{type:"svg",name:"ai--stars",className:n})}},499492:(e,t,n)=>{n.r(t),n.d(t,{checkIsPaymentRequired:()=>a});var r=n(500034),a=function(){switch(!0){case(0,r.isFeatureAvailable)("kommo_ai_trial_started")&&!(0,r.isFeatureAvailable)("kommo_ai_trial_ended"):return!1;case!(0,r.isFeatureAvailable)("airewriter")||(0,r.isFeatureAvailable)("kommo_ai_trial_possible")&&!(0,r.isFeatureAvailable)("kommo_ai_trial_started"):return!0;default:return!1}}},32003:(e,t,n)=>{n.r(t),n.d(t,{getUpdatedAnswerType:()=>o});var r=n(500034),a=n(436132),o=function(e){return!0===(e===a.AnswerType.DEFAULT&&(0,r.isFeatureAvailable)("ai_rewriter_answer_by_button"))?a.AnswerType.GENERATE_BY_HELPER:e}},117464:(e,t,n)=>{n.r(t),n.d(t,{checkIsPaymentRequired:()=>a.checkIsPaymentRequired,getUpdatedAnswerType:()=>r.getUpdatedAnswerType,replaceNewlinesWithBreaks:()=>o.replaceNewlinesWithBreaks});var r=n(32003),a=n(499492),o=n(17840)},17840:(e,t,n)=>{n.r(t),n.d(t,{replaceNewlinesWithBreaks:()=>u});var r=n(827378),a=n.n(r),o=n(629133),i=n.n(o),u=function(e){return i().map(e.split("\n"),(function(e,t){return a().createElement(a().Fragment,{key:t},e,a().createElement("br",null))}))}},241811:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r="kommo:ai:trial:expired:modal:show"},604733:(e,t,n)=>{n.r(t),n.d(t,{AiUsageSurvey:()=>r.AiUsageSurvey});var r=n(44295)},788953:(e,t,n)=>{n.r(t),n.d(t,{useAiUsageSurvey:()=>r.useAiUsageSurvey});var r=n(628073)},628073:(e,t,n)=>{n.r(t),n.d(t,{useAiUsageSurvey:()=>p});var r=n(161320),a=n.n(r),o=n(827378),i=n(588039),u=n(643095),s=n(320526),l=n(417438);function c(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}var d={aiUsageFeedback:""},p=function(){var e,t,n=(0,o.useRef)(a()()),r=(e=function(e){var t;return function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,s.saveSurveyResult)(e)];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),(0,u.captureException)(t),[3,3];case 3:return[2]}}))},t=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){c(o,r,a,i,u,"next",e)}function u(e){c(o,r,a,i,u,"throw",e)}i(void 0)}))},function(e){return t.apply(this,arguments)}),p=f({},function(e){if(null==e)throw new TypeError("Cannot destructure "+e);return e}((0,i.useForm)({defaultValues:{fields:d},mode:"onChange"}))),m=p.getValues;return{control:p.control,formMethods:p,getValidData:function(){var e=m().fields.aiUsageFeedback.replace(/\n/g," "),t=a()().diff(n.current,"seconds");return{data:{aiUsageFeedback:e},name:l.Surveys.AI_USAGE_FEEDBACK,metadata:{viewingTime:t,viewingUrl:window.location.pathname}}},saveSurvey:r}}},657764:(e,t,n)=>{n.r(t),n.d(t,{AiUsageSurvey:()=>u});var r=n(588039),a=n(788953),o=n(218865),i=n(827378),u=function(e){var t=e.onCloseRequest,n=e.onSubmit,u=e.isLoading,s=(0,a.useAiUsageSurvey)(),l=s.formMethods,c=s.getValidData,f=s.saveSurvey;return i.createElement(r.FormProvider,l,i.createElement(o.Feedback,{onSubmit:function(){var e=c();f(e),n()},onCloseRequest:function(){t()},isLoading:u}))}},169580:(e,t,n)=>{n.r(t),n.d(t,{Feedback:()=>v});var r=n(588039),a=n(529062),o=n(916569),i=n(701106),u=n(464702),s=n(445368),l=n(225526),c=n(417438),f=n(112167),d=n(659918),p=n(827378),m=(0,u.getCDNPath)("/frontend/images/interface/ai/"),E={"1x":"".concat(m,"ai_usage_survey.png"),"2x":"".concat(m,"ai_usage_survey@2x.png")},v=function(e){var t=e.onSubmit,n=e.onCloseRequest,u=e.isLoading,m=(0,r.useFormContext)(),v=m.control,y=m.formState,h=y.isValid,b=y.isDirty;return p.createElement(c.BaseStep,{images:E,className:d.default.wrapper},p.createElement("div",{className:d.default.content},p.createElement(i.default,{type:"h2",size:"xxl",className:d.default.title},(0,s.i18n)("Share feedback to reset AI limits")),p.createElement(l.CloseModalButton,{onClick:function(){n()},className:d.default.closeButton}),p.createElement(o.Text,{size:"l",theme:o.TextPrimaryTheme,className:d.default.text},(0,s.i18n)("To request a limit reset, please provide feedback on your experience with Kommo AI:")),p.createElement(r.Controller,{control:v,name:"fields.aiUsageFeedback",rules:{validate:function(e){return function(e,t,n){var r=e.trim();return!(r.length<1||r.length>1e3)}(e)}},render:function(e){var t=e.field,n=t.onChange,r=t.value,a=e.fieldState.invalid;return p.createElement(f.SurveyTextArea,{value:r,isInvalid:a,onChange:function(e){n(e.target.value)},maxLength:1e3})}}),p.createElement(a.Button,{theme:a.ButtonPrimaryTheme,isDisabled:!h||!b||u,isLoading:u,onClick:function(){t()},className:d.default.button},(0,s.i18n)("Submit"))))}},218865:(e,t,n)=>{n.r(t),n.d(t,{Feedback:()=>r.Feedback});var r=n(169580)},19607:(e,t,n)=>{n.r(t),n.d(t,{AI_USAGE_FEEDBACK_TEXTAREA_THEME:()=>u});var r=n(534139);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o,i,u=(o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){a(e,t,n[t])}))}return e}({},r.TextareaLightTheme),i=null!=(i={"--crm-ui-kit-textarea-width":"412px","--crm-ui-kit-textarea-min-height":"60px","--crm-ui-kit-textarea-border-width":"0","--crm-ui-kit-textarea-padding-top":"0","--crm-ui-kit-textarea-padding-bottom":"0","--crm-ui-kit-textarea-padding-horizontal":"0"})?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(i)).forEach((function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(i,e))})),o)},112167:(e,t,n)=>{n.r(t),n.d(t,{SurveyTextArea:()=>d});var r=n(60042),a=n.n(r),o=n(916569),i=n(534139),u=n(445368),s=n(19607),l=n(989715),c=n(827378);function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){var t=e.value,n=e.isInvalid,r=e.onChange,d=e.maxLength,p=t.trim(),m=p.length>d;return c.createElement("div",null,c.createElement("div",{className:a()(l.default.textAreaWrapper,f({},l.default.textAreaWrapperError,n))},c.createElement(i.TextArea,{placeholder:(0,u.i18n)("What features do you like and why? What could be improved?"),className:l.default.textArea,value:t,onChange:function(e){r(e)},isPlaceholderVisibleOnFocus:!0,theme:s.AI_USAGE_FEEDBACK_TEXTAREA_THEME}),c.createElement(o.Text,{size:"ms",theme:n?o.TextErrorTheme:o.TextSecondaryLightTheme,className:l.default.counter},p.length,"/",d)),n&&c.createElement(o.Text,{size:"ms",theme:o.TextErrorTheme},m?(0,u.sprintf)((0,u.i18n)("Please enter no more than %s characters."),d):(0,u.i18n)("Please enter at least 1 character.")))}},44295:(e,t,n)=>{n.r(t),n.d(t,{AiUsageSurvey:()=>r.AiUsageSurvey});var r=n(657764)},766842:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var r=n(292554),a=n.n(r),o=n(827378),i=n.n(o),u=n(730860),s=n(642455),l=a().bind(s.default);const c=function(e){var t=e.onClick,n=e.className,r=void 0===n?"":n;return i().createElement("div",{className:"".concat(l("overlay")," ").concat(r),onClick:t},i().createElement(u.Spinner,{isCentered:!0,theme:u.SpinnerPrimaryTheme}))}},393914:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var r=n(827378),a=n.n(r),o=n(267651),i=n.n(o),u=n(766842);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isShownByDefault,n=void 0!==t&&t,o=c((0,r.useState)(n),2),s=o[0],f=o[1],d=c((0,r.useState)(!1),2),p=d[0],m=d[1],E=c((0,r.useState)(!1),2),v=E[0],y=E[1],h=function(){f(!1),m(!1),v&&(i().publish("overlay:unfix",!0),y(!1))},b=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){l(e,t,n[t])}))}return e}({onClick:function(){p&&h()},isFixed:v},e),A=s?a().createElement(u.default,b):null;return{showOverlay:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isClosable,n=void 0!==t&&t,r=e.isFixed,a=void 0!==r&&r;n&&m(n),a&&(i().publish("overlay:fix",!0),y(a)),f(!0)},hideOverlay:h,overlayElement:A}}},954480:(e,t,n)=>{n.r(t),n.d(t,{useSupportChatMessage:()=>r.useSupportChatMessage});var r=n(69773)},680431:(e,t,n)=>{n.r(t),n.d(t,{getContentByCurrentLang:()=>r});var r=function(e){return e[APP.lang_id]||e.en}},13086:(e,t,n)=>{n.r(t),n.d(t,{getContentByCurrentLang:()=>r.getContentByCurrentLang});var r=n(680431)},915177:(e,t,n)=>{n.r(t),n.d(t,{LANGUAGE_CODE:()=>a.LANGUAGE_CODE,getContentByCurrentLang:()=>r.getContentByCurrentLang});var r=n(13086),a=n(779209)},779209:(e,t,n)=>{var r;n.r(t),n.d(t,{LANGUAGE_CODE:()=>r}),function(e){e.RU="ru",e.EN="en",e.ES="es",e.PT="pt",e.ID="id",e.TR="tr"}(r||(r={}))},770086:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var r=n(827378),a=n(629133),o=n.n(a),i=n(438089),u=n(617861),s=n(827378),l=function(e){var t=e.children,n=e.isTryAgainAvailable,a=e.onTryAgainClick,i=e.onCloseRequest,l=void 0===i?o().noop:i,c=(0,u.default)(),f=c.ModalProvider,d=c.showError;return(0,r.useEffect)((function(){d(t,n)}),[]),s.createElement(f,{onTryAgainClick:function(){a()},onCloseRequest:function(){l()}},s.createElement(s.Fragment,null))};const c=function(e){var t=e.isOpened,n=e.children,a=e.onCloseRequest,u=e.isTryAgainAvailable,s=void 0===u||u,c=e.onTryAgainClick,f=void 0===c?o().noop:c,d=(0,i.default)(l,{children:n,isTryAgainAvailable:s,onTryAgainClick:f,onCloseRequest:a}),p=d.showModal,m=d.hideModal,E=d.modalElement;return(0,r.useEffect)((function(){t?p():m()}),[t]),E}},769734:(e,t,n)=>{n.r(t),n.d(t,{getDateByTimestamp:()=>o});var r=n(161320),a=n.n(r),o=function(e){var t=e.timestamp,n=e.format,r=void 0===n?"".concat(APP.system.format.date.date," ").concat(APP.system.format.date.time):n,o=e.isUtc;return(void 0===o||o?a().unix(t).utc():a().unix(t)).format(r)}}}]);var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"build_2025_11_28_18_50_52"},function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="4c87b3b9-c4de-4f83-90df-c2bd597a390d",e._sentryDebugIdIdentifier="sentry-dbid-4c87b3b9-c4de-4f83-90df-c2bd597a390d")}catch(e){}}();
//# sourceMappingURL=53256.528a528dbe83047ecf88.js.map